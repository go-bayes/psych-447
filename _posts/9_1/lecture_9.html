<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Ordinal responses, monotonic predictors, mediation, and group-level intercepts</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-05-04"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-05-04"/>
  <meta name="article:author" content="Joseph Bulbulia"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Ordinal responses, monotonic predictors, mediation, and group-level intercepts"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Ordinal responses, monotonic predictors, mediation, and group-level intercepts"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Regression and other stories;citation_publication_date=2020;citation_publisher=Cambridge University Press;citation_author=Andrew Gelman;citation_author=Jennifer Hill;citation_author=Aki Vehtari"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Ordinal responses, monotonic predictors, mediation, and group-level intercepts"]},{"type":"NULL"},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Joseph Bulbulia"]},{"type":"character","attributes":{},"value":["https://josephbulbulia.netlify.app"]},{"type":"character","attributes":{},"value":["Victoria University of Wellington"]},{"type":"character","attributes":{},"value":["https://www.wgtn.ac.nz"]},{"type":"character","attributes":{},"value":["0000-0002-5861-2056"]}]}]},{"type":"character","attributes":{},"value":["2021-MAY-04"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","code_folding","highlight"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["kate"]}]}]},{"type":"character","attributes":{},"value":["bib.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bib.bib","lecture_9_files/anchor-4.2.2/anchor.min.js","lecture_9_files/bowser-1.9.3/bowser.min.js","lecture_9_files/distill-2.2.21/template.v2.js","lecture_9_files/figure-html5/unnamed-chunk-10-1.png","lecture_9_files/figure-html5/unnamed-chunk-10-2.png","lecture_9_files/figure-html5/unnamed-chunk-11-1.png","lecture_9_files/figure-html5/unnamed-chunk-11-2.png","lecture_9_files/figure-html5/unnamed-chunk-12-1.png","lecture_9_files/figure-html5/unnamed-chunk-12-2.png","lecture_9_files/figure-html5/unnamed-chunk-13-1.png","lecture_9_files/figure-html5/unnamed-chunk-13-2.png","lecture_9_files/figure-html5/unnamed-chunk-13-3.png","lecture_9_files/figure-html5/unnamed-chunk-14-1.png","lecture_9_files/figure-html5/unnamed-chunk-15-1.png","lecture_9_files/figure-html5/unnamed-chunk-16-1.png","lecture_9_files/figure-html5/unnamed-chunk-17-1.png","lecture_9_files/figure-html5/unnamed-chunk-18-1.png","lecture_9_files/figure-html5/unnamed-chunk-18-2.png","lecture_9_files/figure-html5/unnamed-chunk-19-1.png","lecture_9_files/figure-html5/unnamed-chunk-19-2.png","lecture_9_files/figure-html5/unnamed-chunk-2-1.png","lecture_9_files/figure-html5/unnamed-chunk-20-1.png","lecture_9_files/figure-html5/unnamed-chunk-21-1.png","lecture_9_files/figure-html5/unnamed-chunk-22-1.png","lecture_9_files/figure-html5/unnamed-chunk-23-1.png","lecture_9_files/figure-html5/unnamed-chunk-23-2.png","lecture_9_files/figure-html5/unnamed-chunk-23-3.png","lecture_9_files/figure-html5/unnamed-chunk-24-1.png","lecture_9_files/figure-html5/unnamed-chunk-25-1.png","lecture_9_files/figure-html5/unnamed-chunk-25-2.png","lecture_9_files/figure-html5/unnamed-chunk-25-3.png","lecture_9_files/figure-html5/unnamed-chunk-26-1.png","lecture_9_files/figure-html5/unnamed-chunk-26-2.png","lecture_9_files/figure-html5/unnamed-chunk-26-3.png","lecture_9_files/figure-html5/unnamed-chunk-27-1.png","lecture_9_files/figure-html5/unnamed-chunk-27-2.png","lecture_9_files/figure-html5/unnamed-chunk-27-3.png","lecture_9_files/figure-html5/unnamed-chunk-28-1.png","lecture_9_files/figure-html5/unnamed-chunk-28-2.png","lecture_9_files/figure-html5/unnamed-chunk-29-1.png","lecture_9_files/figure-html5/unnamed-chunk-29-2.png","lecture_9_files/figure-html5/unnamed-chunk-3-1.png","lecture_9_files/figure-html5/unnamed-chunk-30-1.png","lecture_9_files/figure-html5/unnamed-chunk-30-2.png","lecture_9_files/figure-html5/unnamed-chunk-31-1.png","lecture_9_files/figure-html5/unnamed-chunk-32-1.png","lecture_9_files/figure-html5/unnamed-chunk-33-1.png","lecture_9_files/figure-html5/unnamed-chunk-34-1.png","lecture_9_files/figure-html5/unnamed-chunk-35-1.png","lecture_9_files/figure-html5/unnamed-chunk-36-1.png","lecture_9_files/figure-html5/unnamed-chunk-37-1.png","lecture_9_files/figure-html5/unnamed-chunk-38-1.png","lecture_9_files/figure-html5/unnamed-chunk-39-1.png","lecture_9_files/figure-html5/unnamed-chunk-4-1.png","lecture_9_files/figure-html5/unnamed-chunk-40-1.png","lecture_9_files/figure-html5/unnamed-chunk-41-1.png","lecture_9_files/figure-html5/unnamed-chunk-42-1.png","lecture_9_files/figure-html5/unnamed-chunk-43-1.png","lecture_9_files/figure-html5/unnamed-chunk-5-1.png","lecture_9_files/figure-html5/unnamed-chunk-6-1.png","lecture_9_files/figure-html5/unnamed-chunk-7-1.png","lecture_9_files/figure-html5/unnamed-chunk-7-2.png","lecture_9_files/figure-html5/unnamed-chunk-8-1.png","lecture_9_files/figure-html5/unnamed-chunk-9-1.png","lecture_9_files/figure-html5/unnamed-chunk-9-2.png","lecture_9_files/header-attrs-2.7.1/header-attrs.js","lecture_9_files/header-attrs-2.7.8/header-attrs.js","lecture_9_files/jquery-1.11.3/jquery.min.js","lecture_9_files/popper-2.6.0/popper.min.js","lecture_9_files/tippy-6.2.7/tippy-bundle.umd.min.js","lecture_9_files/tippy-6.2.7/tippy-light-border.css","lecture_9_files/tippy-6.2.7/tippy.css","lecture_9_files/tippy-6.2.7/tippy.umd.min.js","lecture_9_files/webcomponents-2.0.0/webcomponents.js","op2.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="lecture_9_files/header-attrs-2.8.1/header-attrs.js"></script>
  <script src="lecture_9_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="lecture_9_files/popper-2.6.0/popper.min.js"></script>
  <link href="lecture_9_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="lecture_9_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="lecture_9_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="lecture_9_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="lecture_9_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="lecture_9_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="lecture_9_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Ordinal responses, monotonic predictors, mediation, and group-level intercepts","authors":[{"author":"Joseph Bulbulia","authorURL":"https://josephbulbulia.netlify.app","affiliation":"Victoria University of Wellington","affiliationURL":"https://www.wgtn.ac.nz","orcidID":"0000-0002-5861-2056"}],"publishedDate":"2021-05-04T00:00:00.000+00:00","citationText":"Bulbulia, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Ordinal responses, monotonic predictors, mediation, and group-level intercepts</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  Joseph Bulbulia <a href="https://josephbulbulia.netlify.app" class="uri">https://josephbulbulia.netlify.app</a> (Victoria University of Wellington)<a href="https://www.wgtn.ac.nz" class="uri">https://www.wgtn.ac.nz</a>
  
<br/>2021-MAY-04
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#objectives">Objectives</a></li>
<li><a href="#ordinal-responses">Ordinal responses</a>
<ul>
<li><a href="#model-equation-for-an-ordinal-response-model">Model equation for an ordinal response model</a></li>
<li><a href="#interpreting-results-of-an-ordinal-model-using-graphical-methods">Interpreting results of an ordinal model using graphical methods</a></li>
</ul></li>
<li><a href="#ordinal-or-monotonic-predictors">Ordinal (or monotonic) predictors</a>
<ul>
<li><a href="#model-equation-for-a-monotonic-predictor-model">Model equation for a monotonic predictor model:</a></li>
</ul></li>
<li><a href="#distributional-model">Distributional model</a></li>
<li><a href="#random-intercept-model-clustering">Random intercept model (clustering)</a>
<ul>
<li><a href="#model-equation-for-a-random-intercept-model">Model equation for a random intercept model</a></li>
</ul></li>
<li><a href="#random-intercept-fatigue">Random intercept: Fatigue</a></li>
<li><a href="#multiple-response-models">Multiple response models</a>
<ul>
<li><a href="#model-equation-imagining-a-random-intercept-multiple-response-model">Model equation (imagining a random intercept multiple response model)</a></li>
</ul></li>
<li><a href="#mediation">Mediation</a></li>
<li><a href="#assumptions">Assumptions</a></li>
<li><a href="#set-up">Set up</a></li>
<li><a href="#model-form">Model form</a></li>
<li><a href="#hypothesis">Hypothesis</a></li>
<li><a href="#bonus-latent-profile-analysis">Bonus: Latent Profile Analysis</a></li>
<li><a href="#latent-profile-analysis">Latent Profile Analysis</a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>### Libraries</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='http://tidyverse.tidyverse.org'>"tidyverse"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://ggplot2.tidyverse.org'>"ggplot2"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://patchwork.data-imaginist.com'>"patchwork"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://lubridate.tidyverse.org'>"lubridate"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='http://haozhu233.github.io/kableExtra/'>"kableExtra"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/ddsjoberg/gtsummary'>"gtsummary"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://lubridate.tidyverse.org'>"lubridate"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/datalorax/equatiomatic'>"equatiomatic"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/malcolmbarrett/ggdag'>"ggdag"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/paul-buerkner/brms'>"brms"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://mc-stan.org/rstan'>"rstan"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://mc-stan.org/rstanarm/'>"rstanarm"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://mc-stan.org/bayesplot/'>"bayesplot"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/easystats/easystats'>"easystats"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='http://haozhu233.github.io/kableExtra/'>"kableExtra"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://broom.tidymodels.org/'>"broom"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://mjskay.github.io/tidybayes/'>"tidybayes"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/mvuorre/bmlm/'>"bmlm"</a></span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://data-edu.github.io/tidyLPA/'>tidyLPA</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"tidyLPA"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># rstan options</span>
<span class='fu'><a href='https://mc-stan.org/rstan/reference/rstan_options.html'>rstan_options</a></span><span class='op'>(</span>auto_write <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>mc.cores <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span> <span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_set</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_classic</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="objectives">Objectives</h2>
<p>To develop the following skills:</p>
<ul>
<li>modelling ordinal (cumulative logit) responses</li>
<li>modelling ordinal (monotonic) predictors</li>
<li>distributional models in which we estimate predictors for the variance as well as for the mean response.</li>
<li>group-level intercept models (aka random intercept models).</li>
<li>multiple response models estimating multivariate outcomes (i.e.two or more)</li>
<li>mediation models</li>
<li>interpret and report the results for these models using graphical methods.</li>
</ul>
<h2 id="ordinal-responses">Ordinal responses</h2>
<p>An ordinal model is a cumulative logistic model. Instead of binary outcomes, we assume there are n &gt; 2 outcomes .</p>
<!-- In our NZ-jitter dataset, the Kessler-6 has five ordinal response options for indicating frequency of feeling distress during the past 30 days: "None Of The Time", "A Little Of The Time", "Some Of The Time", "Most Of The Time", "All Of The Time" hence six thresholds.  -->
<!-- The Kessler-6 distress indicators are: "Feeling Hopelessness;" "Feeling so Depressed Nothing Could Cheer You Up;" "Feeling Nervous or Fidgety;" "Feeling Everything is an Effort;" "Feeling Worthless;" "Feeling Nervous." We simultaneously modelled each of these six outcomes within a single model.  -->
<p>Consider the <code>HLTH.Fatigue</code> indicator from the NZAVS jitter dataset. The item reads:</p>
<blockquote>
<p>During the past 30 days have you felt fatigue</p>
</blockquote>
<p>and the responses are:</p>
<blockquote>
<p>None Of The Time,</p>
</blockquote>
<blockquote>
<p>A Little Of The Time,</p>
</blockquote>
<blockquote>
<p>Some Of The Time,</p>
</blockquote>
<blockquote>
<p>Most Of The Time,</p>
</blockquote>
<blockquote>
<p>All Of The Time.</p>
</blockquote>
<p>A priori, we might think that Fatigue is better approached as an ordered categorical indicator rather than as a continuous indicator:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>nzl</span><span class='op'>$</span><span class='va'>HLTH.Fatigue</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-2-1.png" width="1152" /></p>
</div>
<h3 id="model-equation-for-an-ordinal-response-model">Model equation for an ordinal response model</h3>
<p>We can write the model equation for an ordinal (or cumulative logistic) model of Fatigue s follows</p>
<p><span class="math display">\[\begin{align}
y_{i}\sim \text{Ordered}(p_i) \\
\text{CumLogit}(\boldsymbol{p_i}) = \alpha^c +\beta x_i \\
\alpha^c \sim Normal(0,10)\\
\boldsymbol{\beta}\sim \text{Normal}(0,1) 
\end{align}\]</span></p>
<p>For an ordinal response model, where there are <span class="math inline">\(R\)</span> responses for our outcome indicator, there are <span class="math inline">\(C = R-1, c = 1\dots C\)</span> thresholds or cutpoints.</p>
<p>As with binary logistic regression, residuals for cumulative logistic models are not identified, so are fixed to 1. <span class="math inline">\(\alpha^c\)</span> denotes the <span class="math inline">\(c^{th}\)</span> intercept estimated in the model. Where the lowest response level is modeled as zero, hence four intercepts are estimated. <span class="math inline">\(\mathbf{\beta}\)</span> is the esitmate for the<span class="math inline">\(X\)</span> parameter measured on <span class="math inline">\(i...N\)</span> individuals. In this case the time categories of the <code>Covid_Timeline</code> indicator.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>HLTH.Fatigue_int</span>  <span class='op'>~</span>
       <span class='va'>Covid_Timeline_cr</span><span class='op'>)</span>,
  family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsfamily.html'>cumulative</a></span><span class='op'>(</span>link <span class='op'>=</span> <span class='st'>"logit"</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>nz</span>,
  file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"ordinal_fatigue"</span><span class='op'>)</span>,
  silent <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='va'>par_m1</span> <span class='op'>&lt;-</span> <span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
<span class='va'>par_m1</span>
</code></pre>
</div>
</details>
<pre><code># Fixed effects

Parameter                     | Median |         89% CI |     pd | % in ROPE |  Rhat |     ESS
----------------------------------------------------------------------------------------------
Intercept[1]                  |  -1.87 | [-1.94, -1.80] |   100% |        0% | 1.000 | 3136.00
Intercept[2]                  |  -0.07 | [-0.12, -0.02] | 99.00% |    99.98% | 1.000 | 4351.00
Intercept[3]                  |   1.33 | [ 1.27,  1.39] |   100% |        0% | 1.000 | 4529.00
Intercept[4]                  |   3.02 | [ 2.91,  3.12] |   100% |        0% | 0.999 | 4437.00
Covid_Timeline_crJanFeb       |   0.08 | [-0.06,  0.22] | 81.92% |    86.88% | 0.999 | 5554.00
Covid_Timeline_crEarlyMarch   |   0.04 | [-0.10,  0.19] | 67.50% |    93.50% | 1.000 | 5763.00
Covid_Timeline_crLockdown     |  -0.26 | [-0.43, -0.08] | 99.12% |    22.82% | 0.999 | 4896.00
Covid_Timeline_crPostLockdown |  -0.10 | [-0.22,  0.01] | 92.50% |    84.38% | 1.000 | 4559.00</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>par_m1</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-3-1.png" width="1152" /></p>
</div>
<p>Hre we can see that the log-odds of Fatigue dropped during Lockdown. But how exactly did Fatigue drop?</p>
<p>As with logistic regression, the coefficients here are not obvious. To interpret results, we should graph the predicted outcomes at specific values.</p>
<h3 id="interpreting-results-of-an-ordinal-model-using-graphical-methods">Interpreting results of an ordinal model using graphical methods</h3>
<p>To understand what is happening, we plot all the individual intercepts by setting <code>categorical = TRUE</code>. Following McElreaths Statistical Rethinking, we will predict outcomes using the .89 probability credible interval:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span>
    <span class='va'>m1</span>,
    categorical <span class='op'>=</span> <span class='cn'>TRUE</span>,
    prob <span class='op'>=</span> <span class='fl'>0.89</span>,
    re_formula <span class='op'>=</span> <span class='cn'>NA</span>,
  <span class='op'>)</span>,   <span class='co'># WE cannot graph points when the points arg = TRUE</span>
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
    width <span class='op'>=</span> <span class='fl'>.1</span>,
    size <span class='op'>=</span> <span class='fl'>.2</span>
  <span class='op'>)</span>
<span class='op'>)</span> 
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-4-1.png" width="1152" /></p>
</div>
<p>Here we see the separation occurring during <code>Lockdown</code> as compared with the baseline <code>PreCOVID</code></p>
<p>This is another method for graphing, where the individual facets denote our expected response thresholds:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span>
  <span class='va'>m1</span>, 
  effects <span class='op'>=</span> <span class='st'>"Covid_Timeline_cr"</span><span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>$Covid_Timeline_cr</code></pre>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-5-1.png" width="1152" /></p>
</div>
<p>Finally, for the purposes of exploration, we can obtain an average response using the BRMS <code>conditional_effects</code> function, with the setting <code>categorical = FALSE</code></p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span>
    <span class='va'>m1</span>,
    categorical <span class='op'>=</span> <span class='cn'>FALSE</span>,
    prob <span class='op'>=</span> <span class='fl'>0.89</span>,
    re_formula <span class='op'>=</span> <span class='cn'>NA</span>,
  <span class='op'>)</span>,
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
    width <span class='op'>=</span> <span class='fl'>.1</span>,
    size <span class='op'>=</span> <span class='fl'>.2</span>
  <span class='op'>)</span>
<span class='op'>)</span> 
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-6-1.png" width="1152" /></p>
</div>
<h2 id="ordinal-or-monotonic-predictors">Ordinal (or monotonic) predictors</h2>
<p>Reference, here (<a href="https://psyarxiv.com/9qkhj/" class="uri">https://psyarxiv.com/9qkhj/</a>) also the BRMS documentation <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_monotonic.html">here</a></p>
<blockquote>
<p>A predictor, which we want to model as monotonic (i.e., having a monotonically increasing or decreasing relationship with the response), must either be integer valued or an ordered factor. As opposed to a continuous predictor, predictor categories (or integers) are not assumed to be equidistant with respect to their effect on the response variable. Instead, the distance between adjacent predictor categories (or integers) is estimated from the data and may vary across categories.</p>
</blockquote>
<h3 id="model-equation-for-a-monotonic-predictor-model">Model equation for a monotonic predictor model:</h3>
<p>For an ordinal predictor model, where there are <span class="math inline">\(R\)</span> indicator responses, there are <span class="math inline">\(C = R-1, c = 1\dots C\)</span> thresholds to estimate for the the ordered reponses predictors</p>
<ul>
<li><span class="math inline">\(b^c\)</span> locates the direction and size of effect, as with an ordinary regression solution. We consider <span class="math inline">\(b^c\)</span> as the expected average difference between two adjacent categories of the ordinal predictor.</li>
<li><span class="math inline">\(\zeta^c\)</span> locates the normalized distances between consecutive predictor categories, producing the shape of the monotonic effect</li>
</ul>
<p><span class="math display">\[g(y_i) = \alpha + b^c \zeta^c x_i\]</span></p>
<p>Suppose we wanted to assess whether fatigue predicts psychological distress. Well use a smaller sub-sample of the NZAVS jitter dataset to speed up computing time:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Create small sample to improve computing time</span>
<span class='va'>snzl</span> <span class='op'>&lt;-</span> <span class='va'>nzl</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Wave</span> <span class='op'>==</span> <span class='fl'>2019</span><span class='op'>)</span> <span class='co'># Only one wave</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>nm</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>snzl</span><span class='op'>$</span><span class='va'>Id</span>, size <span class='op'>=</span> <span class='fl'>300</span><span class='op'>)</span> <span class='co'># randomly select a smaller sample of individuals.</span>
<span class='va'>sub_nzl</span> <span class='op'>&lt;-</span> <span class='va'>snzl</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Id</span> <span class='op'>%in%</span> <span class='va'>nm</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>First we estimate a model without a monotonic effect:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># ordinary predictor</span>
<span class='va'>mo_0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>KESSLER6sum</span>  <span class='op'>~</span> <span class='va'>HLTH.Fatigue</span>,
     family <span class='op'>=</span> <span class='st'>"poisson"</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>sub_nzl</span>,
  file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"monotonic_0"</span><span class='op'>)</span>,
  silent <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='co'># table</span>
<span class='va'>par_mo_0</span> <span class='op'>&lt;-</span><span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>mo_0</span><span class='op'>)</span>
<span class='va'>par_mo_0</span>
</code></pre>
</div>
<pre><code># Fixed effects

Parameter    | Median |       89% CI |   pd | % in ROPE |  Rhat |     ESS
-------------------------------------------------------------------------
(Intercept)  |   0.76 | [0.67, 0.86] | 100% |        0% | 1.001 | 1640.00
HLTH.Fatigue |   0.45 | [0.42, 0.49] | 100% |        0% | 1.000 | 1895.00</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='co'># coefficient plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>par_mo_0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Distress on Fatigue, no monotonic effects"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-8-1.png" width="1152" /></p>
</div>
<p>The expected increase in distress from a one unit increase in Fatigue is .45 units of Kessler 6 distress on the log scale.</p>
<p>To translate this expectation to the data scale recall that we must exponentiate our result.</p>
<p>A one unit change in fatigue at the intercept leads to an expected change in distress of:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fl'>.75</span> <span class='op'>+</span> <span class='fl'>.45</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 3.320117</code></pre>
</div>
<p>We plot the entire range of the response scale:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p_mo_0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span><span class='va'>mo_0</span><span class='op'>)</span>,
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
                    width <span class='op'>=</span> <span class='fl'>.2</span><span class='op'>)</span>, 
  ask <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-10-1.png" width="1152" /></p>
</div>
<p>We next model the relationship of Fatigue on Distress by thinking of Fatigue as as a monotonic predictor, using the <code>mo</code> command, as follows:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mo_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>KESSLER6sum</span>  <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mo.html'>mo</a></span><span class='op'>(</span><span class='va'>HLTH.Fatigue</span><span class='op'>)</span>,
     family <span class='op'>=</span> <span class='st'>"poisson"</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>sub_nzl</span>,
  file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"monotonic_1"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># table</span>
<span class='va'>par_mo_1</span> <span class='op'>&lt;-</span><span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>mo_1</span><span class='op'>)</span>
<span class='va'>par_mo_1</span>
</code></pre>
</div>
<pre><code># Fixed effects

Parameter      | Median |       89% CI |   pd | % in ROPE |  Rhat |     ESS
---------------------------------------------------------------------------
(Intercept)    |   0.84 | [0.67, 1.01] | 100% |        0% | 1.004 | 1179.00
moHLTH.Fatigue |   0.44 | [0.38, 0.49] | 100% |        0% | 1.004 | 1253.00

# Fixed effects (monotonic effects)

Parameter        | Median |       89% CI |   pd | % in ROPE |  Rhat |     ESS
-----------------------------------------------------------------------------
HLTH.Fatigue1[1] |   0.19 | [0.09, 0.28] | 100% |     7.90% | 1.003 | 1248.00
HLTH.Fatigue1[2] |   0.29 | [0.21, 0.36] | 100% |        0% | 1.002 | 1691.00
HLTH.Fatigue1[3] |   0.24 | [0.17, 0.31] | 100% |     0.03% | 1.000 | 2338.00
HLTH.Fatigue1[4] |   0.28 | [0.20, 0.35] | 100% |        0% | 1.001 | 2441.00</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='co'># coefficient plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>par_mo_1</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Distress on Fatigue, monotonic effects"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-11-1.png" width="1152" /></p>
</div>
<p>Note that we have 4 x betas for Fatigue. What do these mean?</p>
<p>Graphing the results:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p_mo_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span><span class='va'>mo_1</span><span class='op'>)</span>,
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
                    width <span class='op'>=</span> <span class='fl'>.2</span><span class='op'>)</span>
<span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> 
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-12-1.png" width="1152" /></p>
</div>
<p>The monotonic predictor, here, doesnt look to make all that much a difference.</p>
<p>We can formally compare the two models:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>compare_mo_0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/add_criterion.html'>add_criterion</a></span><span class='op'>(</span><span class='va'>mo_0</span>, <span class='st'>"loo"</span><span class='op'>)</span>
<span class='va'>compare_mo_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/add_criterion.html'>add_criterion</a></span><span class='op'>(</span><span class='va'>mo_1</span>, <span class='st'>"loo"</span><span class='op'>)</span>

<span class='va'>compare_mo</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/loo_compare.brmsfit.html'>loo_compare</a></span><span class='op'>(</span><span class='va'>compare_mo_0</span>, <span class='va'>compare_mo_1</span>, criterion <span class='op'>=</span> <span class='st'>"loo"</span><span class='op'>)</span>
<span class='va'>compare_mo</span>
</code></pre>
</div>
</details>
<pre><code>             elpd_diff se_diff
compare_mo_0  0.0       0.0   
compare_mo_1 -4.1       1.7   </code></pre>
</div>
<p>No real difference.</p>
<p>And can visually inspect the posterior predictions, and they not look too different:</p>
<p>Without monotonic predictors</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>mo_0</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-14-1.png" width="1152" /></p>
</div>
<p>With monotonic predictors</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>mo_1</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-15-1.png" width="1152" /></p>
</div>
<p>Again, no real difference. However, our model isnt fitting well. What would you do to improve the model fit?</p>
<p>There are no default strategies. Modelling requires a combination of reasoning and art.</p>
<h2 id="distributional-model">Distributional model</h2>
<p>A distributional model predicts the variance as well as the mean of a response.</p>
<p>Paul Bruckner, the author of the BRMS package, offers the following simulated data for a distributional model (see the explanation {here](<a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_distreg.html" class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_distreg.html</a>))</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"treat"</span>, <span class='st'>"placebo"</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span>
<span class='va'>symptom_post</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>30</span>, mean <span class='op'>=</span> <span class='fl'>1</span>, sd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>30</span>, mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>group</span>, <span class='va'>symptom_post</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  group symptom_post
1 treat    -5.621357
2 treat     2.076932
3 treat     2.784972
4 treat     1.978924
5 treat    -1.392703
6 treat     1.925476</code></pre>
</div>
<p>Fitting the model we have:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>symptom_post</span> <span class='op'>~</span> <span class='va'>group</span>,
               <span class='va'>sigma</span> <span class='op'>~</span> <span class='va'>group</span><span class='op'>)</span>,
            data <span class='op'>=</span> <span class='va'>dat1</span>,
            file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"distributional"</span><span class='op'>)</span>,
            family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>gaussian</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>par_fit1</span> <span class='op'>&lt;-</span><span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>fit1</span><span class='op'>)</span>
<span class='va'>par_fit1</span>
</code></pre>
</div>
<pre><code># Fixed effects

Parameter        | Median |         89% CI |     pd | % in ROPE |  Rhat |     ESS
---------------------------------------------------------------------------------
(Intercept)      |  -0.21 | [-0.38, -0.03] | 96.97% |    35.80% | 1.000 | 4801.00
sigma_Intercept  |  -0.51 | [-0.72, -0.31] |   100% |     0.73% | 1.000 | 2927.00
grouptreat       |   1.50 | [ 0.88,  2.12] | 99.98% |     0.07% | 1.000 | 2219.00
sigma_grouptreat |   1.21 | [ 0.91,  1.49] |   100% |        0% | 1.000 | 2844.00

# Fixed effects sigma

Parameter        | Median |         89% CI |   pd | % in ROPE |  Rhat |     ESS
-------------------------------------------------------------------------------
sigma_Intercept  |  -0.51 | [-0.72, -0.31] | 100% |     0.73% | 1.000 | 2927.00
sigma_grouptreat |   1.21 | [ 0.91,  1.49] | 100% |        0% | 1.000 | 2844.00</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='co'># coefficient plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>par_fit1</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-17-1.png" width="1152" /></p>
</div>
<p>Here we have the prediction plot</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span><span class='va'>fit1</span><span class='op'>)</span>, points <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-18-1.png" width="1152" /></p>
</div>
<p>We can see the variance in the treatment group:</p>
<!-- BRMS allows us to estemate whether both parameters (the mean) and the standard deviations of the mean, differ: -->
<!-- ```{r} -->
<!-- hyp <- c("exp(sigma_Intercept) = 0", -->
<!--          "exp(sigma_Intercept + sigma_grouptreat) = 0") -->
<!-- hypothesis(fit1, hyp) -->
<!-- ``` -->
<!-- Both the mens, and the variances, differ.  -->
<!-- We can graph these differences: -->
<!-- ```{r} -->
<!-- hyp <- "exp(sigma_Intercept + sigma_grouptreat) > exp(sigma_Intercept)" -->
<!-- (hyp <- hypothesis(fit1, hyp)) -->
<!-- plot(hyp) -->
<!-- ``` -->
<p>When might this model apply?</p>
<blockquote>
<p>Suppose we have two groups of patients: One group receives a treatment (e.g., an antidepressive drug) and another group receives placebo. Since the treatment may not work equally well for all patients, the symptom variance of the treatment group may be larger than the symptom variance of the placebo group after some weeks of treatment. (Paul Bruckner, BRMS vignette)</p>
</blockquote>
<h2 id="random-intercept-model-clustering">Random intercept model (clustering)</h2>
<p>Typically our model has clustering. Often this clustering arises from dependencies owning to unmeasured grouping factors, students within schools, or repeated measures within students.</p>
<p>However, recall a fundamental assumption of regression:</p>
<blockquote>
<p>The simple regression model assumes that the errors from the prediction line are independent, an assumption that is violated in time series, spatial, and multilevel settings <span class="citation" data-cites="gelman2020">(<a href="#ref-gelman2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020, 153</a>)</span></p>
</blockquote>
<p>Lets look at environmental concern as predicted by religious group membership:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># 506 weekss betwen 530 June 2009 and 15 March 2019</span>
<span class='va'>nzl_11</span> <span class='op'>&lt;-</span> <span class='va'>nzl</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Wave</span> <span class='op'>==</span> <span class='fl'>2019</span><span class='op'>)</span>

<span class='va'>ri_relgroups</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>Env.ClimateChgConcern</span>    <span class='op'>~</span>
       <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>Religious_Group</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>nzl_11</span>,
  file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"ri_relgroups"</span><span class='op'>)</span>,
  silent <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ri_relgroups</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Env.ClimateChgConcern ~ (1 | Religious_Group) 
   Data: nzl_11 (Number of observations: 5618) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup samples = 4000

Group-Level Effects: 
~Religious_Group (Number of levels: 71) 
              Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)     0.70      0.17     0.40     1.04 1.00
              Bulk_ESS Tail_ESS
sd(Intercept)      845     1064

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept     5.07      0.13     4.82     5.34 1.00
          Bulk_ESS Tail_ESS
Intercept      881     1404

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sigma     1.71      0.02     1.68     1.74 1.00     6911
      Tail_ESS
sigma     2903

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<h3 id="model-equation-for-a-random-intercept-model">Model equation for a random intercept model</h3>
<p><span class="math display">\[ g(y_{ig}) \sim N(\mu_{ig}, \sigma)\\
\mu_{ig} = \boldsymbol{\alpha} + \beta x_{i}\\
 \boldsymbol{\alpha} = \alpha_o + \alpha_g\\
 \alpha_o \sim N(3.5,10)\\
 \alpha_g \sim N(0,\sigma_g)\\
 \sigma_g \sim Exp(1)\\
  \sigma \sim Exp(1)
\]</span></p>
<p>We can calculate the intraclass correlation coefficient for religious groups, which is the ration of group variance devited by the total variance or in this case:</p>
<p><span class="math display">\[\frac{\sigma^2_{religious groups}}{\sigma^2_{religious groups} + \sigma^2_{indiviuals}}\]</span></p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>ri_relgroups</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.143
  Conditional ICC: 0.143</code></pre>
</div>
<p>The authors of the performance package write (performance package documentation)</p>
<blockquote>
<p>While the adjusted ICC only relates to the random effects, the conditional ICC also takes the fixed effects variances into account (see Nakagawa et al.2017). Typically, the adjusted ICC is of interest when the analysis of random effects is of interest.</p>
</blockquote>
<p>We can plot the group-level variances:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>par_ri_relgroups</span> <span class='op'>&lt;-</span><span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>ri_relgroups</span>,
                                             effects <span class='op'>=</span> <span class='st'>"random"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>par_ri_relgroups</span>,   sort <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-21-1.png" width="1152" /></p>
</div>
<p>References: See: <a href="https://m-clark.github.io/mixed-models-with-R/" class="uri">https://m-clark.github.io/mixed-models-with-R/</a></p>
<h2 id="random-intercept-fatigue">Random intercept: Fatigue</h2>
<p>With longitudinal data, we have repeated measures within individuals. This leads to clustering. We can adjust for this clustering by including group-level intercept for individuals.</p>
<p>Lets return to the Fatigue ~ Covid_Timeline model.</p>
<p><span class="math display">\[\begin{align}
y_{ij} \sim \text{Ordered}(\mu_{ij}) \\
\text{CumLogit}(\mu_{ij}) = \boldsymbol{\alpha}^c +\beta X_i \\
\boldsymbol{\alpha}^c  = \alpha_{0}^c +\alpha_j\\
\alpha_{0}^c \sim N(0,10)\\
\alpha_j \sim N(0,\sigma_j)\\
\sigma_j \sim exp(1)\\
\boldsymbol{\beta}\sim \text{Normal}(0,1) \\
\end{align}\]</span></p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">  <span class='va'>m1_l</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>HLTH.Fatigue_int</span>  <span class='op'>~</span>
      <span class='va'>Covid_Timeline</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>Id</span><span class='op'>)</span>,
    family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsfamily.html'>cumulative</a></span><span class='op'>(</span>link <span class='op'>=</span> <span class='st'>"logit"</span><span class='op'>)</span><span class='op'>)</span>,
    data <span class='op'>=</span> <span class='va'>nzl</span>,
    file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"ordinal_fatigue_longitudinal"</span><span class='op'>)</span>,
    silent <span class='op'>=</span> <span class='cn'>FALSE</span>
  <span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1_l</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Family: cumulative 
  Links: mu = logit; disc = identity 
Formula: HLTH.Fatigue_int ~ Covid_Timeline + (1 | Id) 
   Data: nzl (Number of observations: 11736) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup samples = 4000

Group-Level Effects: 
~Id (Number of levels: 5934) 
              Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)     2.48      0.05     2.38     2.58 1.01
              Bulk_ESS Tail_ESS
sd(Intercept)      870     2060

Population-Level Effects: 
                           Estimate Est.Error l-95% CI
Intercept[1]                  -3.06      0.06    -3.18
Intercept[2]                  -0.02      0.05    -0.11
Intercept[3]                   2.65      0.06     2.53
Intercept[4]                   5.32      0.09     5.14
Covid_TimelinePreCOVID         0.23      0.04     0.15
Covid_TimelineJanFeb           0.27      0.11     0.05
Covid_TimelineEarlyMarch       0.19      0.12    -0.04
Covid_TimelineLockdown        -0.38      0.15    -0.68
Covid_TimelinePostLockdown    -0.06      0.10    -0.25
                           u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept[1]                  -2.95 1.00     2158     2852
Intercept[2]                   0.07 1.00     2688     3297
Intercept[3]                   2.76 1.00     2192     3020
Intercept[4]                   5.49 1.00     2001     2816
Covid_TimelinePreCOVID         0.32 1.00     7122     3181
Covid_TimelineJanFeb           0.49 1.00     4779     3284
Covid_TimelineEarlyMarch       0.43 1.00     4527     3187
Covid_TimelineLockdown        -0.08 1.00     4456     3136
Covid_TimelinePostLockdown     0.13 1.00     4723     3491

Family Specific Parameters: 
     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
disc     1.00      0.00     1.00     1.00 1.00     4000
     Tail_ESS
disc     4000

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<p>We graph the results</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span>
    <span class='va'>m1_l</span>,
   <span class='co'># spaghetti = TRUE,</span>
  <span class='co'>#  nsamples = 100,</span>
    categorical <span class='op'>=</span> <span class='cn'>T</span>,
    prob <span class='op'>=</span> <span class='fl'>0.89</span>,
    re_formula <span class='op'>=</span> <span class='cn'>NA</span>,
  <span class='op'>)</span>,
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
                    width <span class='op'>=</span> <span class='fl'>.02</span><span class='op'>)</span>
<span class='op'>)</span> <span class='co'>#  note this command controls which facet</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-23-1.png" width="1152" /></p>
</div>
<h2 id="multiple-response-models">Multiple response models</h2>
<h3 id="model-equation-imagining-a-random-intercept-multiple-response-model">Model equation (imagining a random intercept multiple response model)</h3>
<p><span class="math display">\[ g(y^n_{ij}) \sim N(\mu_{ij}^n, \sigma^n)\\
\mu_{ij}^n = \boldsymbol{\alpha^n} + \beta^n x_{i}\\
 \boldsymbol{\alpha} = \alpha_o + \alpha_g\\
 \alpha^n_o \sim N(3.5,10)\\
 \alpha^n_g \sim N(0,\sigma_g^n)\\
 \sigma_g^n \sim exp(1)\\
 \sigma^{n_1} \sim exp(1)\\
 \sigma^{n_2}\sim exp(1) \\
\sigma\sim exp(1) \\
\begin{bmatrix}
\sigma^{n_1} \\
\sigma^{n_2} 
\end{bmatrix}
\sim 
\boldsymbol{R} \begin{pmatrix}
1 &amp;  \sigma^{n_1}\sigma^{n_2} \rho    \\
\sigma^{n_1}\sigma^{n_2}\rho   &amp;  1
\end{pmatrix}\\
\boldsymbol{R}\sim \text{LKJcorr}(2)
\]</span></p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Create smaller data frame</span>
<span class='va'>snzl</span> <span class='op'>&lt;-</span> <span class='va'>nzl</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Wave</span> <span class='op'>==</span> <span class='fl'>2019</span><span class='op'>)</span> <span class='co'># Only one wave</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>nm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>snzl</span><span class='op'>$</span><span class='va'>Id</span>, size <span class='op'>=</span> <span class='fl'>300</span><span class='op'>)</span> <span class='co'># randomly select a smaller sample of individuals. </span>

<span class='co'># create the data frame</span>
<span class='va'>sub_nzl</span><span class='op'>&lt;-</span> <span class='va'>snzl</span><span class='op'>%&gt;%</span>
 <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Id</span> <span class='op'>%in%</span> <span class='va'>nm</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>f_mv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mvbind.html'>mvbind</a></span><span class='op'>(</span><span class='va'>Warm.Immigrants</span>, <span class='va'>Warm.Muslims</span><span class='op'>)</span> <span class='op'>~</span>  <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>Hours.News</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>sub_nzl</span>,
  file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"multivariate_warmth"</span><span class='op'>)</span>, 
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>f_mv</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: Warm.Immigrants ~ log(Hours.News + 1) 
         Warm.Muslims ~ log(Hours.News + 1) 
   Data: sub_nzl (Number of observations: 293) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup samples = 4000

Population-Level Effects: 
                               Estimate Est.Error l-95% CI
WarmImmigrants_Intercept           4.54      0.16     4.23
WarmMuslims_Intercept              4.30      0.18     3.95
WarmImmigrants_logHours.NewsP1     0.08      0.10    -0.11
WarmMuslims_logHours.NewsP1        0.03      0.12    -0.20
                               u-95% CI Rhat Bulk_ESS
WarmImmigrants_Intercept           4.84 1.00     3094
WarmMuslims_Intercept              4.66 1.00     3101
WarmImmigrants_logHours.NewsP1     0.28 1.00     3046
WarmMuslims_logHours.NewsP1        0.26 1.00     3046
                               Tail_ESS
WarmImmigrants_Intercept           2693
WarmMuslims_Intercept              2861
WarmImmigrants_logHours.NewsP1     2395
WarmMuslims_logHours.NewsP1        2622

Family Specific Parameters: 
                     Estimate Est.Error l-95% CI u-95% CI
sigma_WarmImmigrants     1.24      0.05     1.14     1.34
sigma_WarmMuslims        1.46      0.06     1.35     1.58
                     Rhat Bulk_ESS Tail_ESS
sigma_WarmImmigrants 1.00     2980     2955
sigma_WarmMuslims    1.00     3086     2924

Residual Correlations: 
                                   Estimate Est.Error
rescor(WarmImmigrants,WarmMuslims)     0.77      0.02
                                   l-95% CI u-95% CI Rhat
rescor(WarmImmigrants,WarmMuslims)     0.72     0.81 1.00
                                   Bulk_ESS Tail_ESS
rescor(WarmImmigrants,WarmMuslims)     3547     2954

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<p>Coefficient plot</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/mcmc_plot.brmsfit.html'>mcmc_plot</a></span><span class='op'>(</span><span class='va'>f_mv</span>, 
               type <span class='op'>=</span> <span class='st'>"areas"</span>,
               prob <span class='op'>=</span> <span class='fl'>.89</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-26-1.png" width="1152" /></p>
</div>
<h2 id="mediation">Mediation</h2>
<ul>
<li>Manipulate X, measure M and Y</li>
<li>Regress M on X; Y on X and M</li>
</ul>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>bmlm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/bmlm/man/mlm_path_plot.html'>mlm_path_plot</a></span><span class='op'>(</span>xlab <span class='op'>=</span> <span class='st'>"Condition\n(X)"</span>,
              mlab <span class='op'>=</span> <span class='st'>"Mediator\n(M)"</span>,
              ylab <span class='op'>=</span> <span class='st'>"Distress\n(Y)"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-27-1.png" width="1152" /></p>
</div>
<h2 id="assumptions">Assumptions</h2>
<ul>
<li>Y does not affect M</li>
<li>No 3rd variable on M to Y relationship</li>
<li>M is measured without error</li>
<li>Y and M residuals are not correlated <span class="citation" data-cites="vuorre2020multilevel">(<a href="#ref-vuorre2020multilevel" role="doc-biblioref"><strong>vuorre2020multilevel?</strong></a>)</span></li>
</ul>
<h2 id="set-up">Set up</h2>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>path_m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span>
  <span class='va'>mF</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>c</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='va'>path_y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span>
  <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>mF_w</span> <span class='op'>+</span> <span class='va'>mF_b</span> <span class='op'>+</span>
               <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>c</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='va'>path_m</span> <span class='op'>+</span> <span class='va'>path_y</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula-helpers.html'>set_rescor</a></span><span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>datF</span>,
  file <span class='op'>=</span> <span class='fu'>here</span><span class='op'>(</span><span class='st'>"models/mediation-k6-covid-fatigue"</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="model-form">Model form</h2>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span><span class='va'>nzl</span><span class='op'>$</span><span class='va'>Covid_Timeline</span>
<span class='va'>mF</span> <span class='op'>&lt;-</span><span class='va'>nzl</span><span class='op'>$</span><span class='va'>HLTH.Fatigue_int</span>
<span class='va'>y</span><span class='op'>&lt;-</span> <span class='va'>nzl</span><span class='op'>$</span><span class='va'>KESSLER6sum</span>
<span class='va'>id</span> <span class='op'>&lt;-</span><span class='va'>nzl</span><span class='op'>$</span><span class='va'>Id</span>
<span class='va'>datF</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>mF</span>, <span class='va'>y</span>,<span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>path_m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span>
  <span class='va'>mF</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>c</span> <span class='op'>|</span>  <span class='va'>id</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='va'>path_y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span>
  <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>mF</span> <span class='op'>+</span>  <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>c</span> <span class='op'>|</span>  <span class='va'>id</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='va'>f1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='va'>path_m</span> <span class='op'>+</span> <span class='va'>path_y</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula-helpers.html'>set_rescor</a></span><span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>datF</span>,
  file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models/mediation-k6-covid-fatigue"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>f1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: mF ~ x + (1 | id) 
         y ~ x + mF + (1 | c | id) 
   Data: datF (Number of observations: 11735) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup samples = 4000

Group-Level Effects: 
~id (Number of levels: 5933) 
                 Estimate Est.Error l-95% CI u-95% CI Rhat
sd(mF_Intercept)     0.81      0.01     0.79     0.83 1.00
sd(y_Intercept)      2.52      0.03     2.46     2.59 1.01
                 Bulk_ESS Tail_ESS
sd(mF_Intercept)     1271     2049
sd(y_Intercept)      1000     1890

Population-Level Effects: 
                 Estimate Est.Error l-95% CI u-95% CI Rhat
mF_Intercept         2.58      0.01     2.55     2.60 1.01
y_Intercept          0.69      0.09     0.52     0.87 1.00
mF_xPreCOVID         0.08      0.01     0.05     0.11 1.00
mF_xJanFeb           0.09      0.04     0.02     0.17 1.00
mF_xEarlyMarch       0.06      0.04    -0.02     0.14 1.00
mF_xLockdown        -0.12      0.05    -0.22    -0.02 1.00
mF_xPostLockdown    -0.02      0.03    -0.08     0.04 1.00
y_xPreCOVID         -0.04      0.05    -0.13     0.05 1.00
y_xJanFeb           -0.19      0.12    -0.43     0.05 1.00
y_xEarlyMarch        0.23      0.12    -0.01     0.48 1.00
y_xLockdown          0.55      0.16     0.24     0.88 1.00
y_xPostLockdown      0.15      0.10    -0.04     0.34 1.00
y_mF                 1.71      0.03     1.65     1.77 1.00
                 Bulk_ESS Tail_ESS
mF_Intercept         1654     2355
y_Intercept          1638     2484
mF_xPreCOVID         5789     3093
mF_xJanFeb           3596     3181
mF_xEarlyMarch       3688     2978
mF_xLockdown         3466     2915
mF_xPostLockdown     3998     3049
y_xPreCOVID          4813     3216
y_xJanFeb            3616     3138
y_xEarlyMarch        3418     3080
y_xLockdown          3601     3083
y_xPostLockdown      3569     3198
y_mF                 1662     2226

Family Specific Parameters: 
         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sigma_mF     0.67      0.01     0.66     0.68 1.00     1521
sigma_y      2.10      0.02     2.06     2.14 1.00     1612
         Tail_ESS
sigma_mF     2310
sigma_y      2807

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>post1F</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/posterior_samples.brmsfit.html'>posterior_samples</a></span><span class='op'>(</span><span class='va'>f1</span><span class='op'>)</span>
<span class='va'>post_marF</span> <span class='op'>&lt;-</span> <span class='va'>post1F</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>transmute</span><span class='op'>(</span>
    a <span class='op'>=</span> <span class='va'>b_mF_xLockdown</span>,
    b <span class='op'>=</span> <span class='va'>b_y_mF</span>,
    cp <span class='op'>=</span> <span class='va'>b_y_xLockdown</span>,
    me <span class='op'>=</span> <span class='va'>a</span> <span class='op'>*</span> <span class='va'>b</span>,
    c <span class='op'>=</span> <span class='va'>cp</span> <span class='op'>+</span> <span class='va'>me</span><span class='co'>#,</span>
   <span class='co'># pme = me / c</span>
  <span class='op'>)</span>
<span class='co'># posterior_summary(post_marF)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-intervals.html'>mcmc_intervals</a></span><span class='op'>(</span><span class='va'>post_marF</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-32-1.png" width="1152" /></p>
</div>
<h2 id="hypothesis">Hypothesis</h2>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>h1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
  a <span class='op'>=</span> <span class='st'>"mF_xLockdown  = 0"</span>,
  b <span class='op'>=</span> <span class='st'>"y_mF = 0"</span>,
  cp <span class='op'>=</span> <span class='st'>"y_xLockdown = 0"</span>,
  me <span class='op'>=</span> <span class='st'>"mF_xLockdown * y_xLockdown = 0"</span>,
  c <span class='op'>=</span> <span class='st'>"mF_xLockdown * y_mF + y_xLockdown = 0"</span>
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/hypothesis.brmsfit.html'>hypothesis</a></span><span class='op'>(</span><span class='va'>f1</span>, <span class='va'>h1</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-33-1.png" width="1152" /></p>
</div>
<h2 id="bonus-latent-profile-analysis">Bonus: Latent Profile Analysis</h2>
<h2 id="latent-profile-analysis">Latent Profile Analysis</h2>
<p>Distinct profiles or clusters tbc</p>
<!-- # nzf<-nz %>% -->
<!-- #   select( FeelHopeless,  -->
<!-- #           FeelDepressed, -->
<!-- #           FeelRestless,  -->
<!-- #           EverythingIsEffort, -->
<!-- #           FeelWorthless,  -->
<!-- #           FeelNervous) %>% -->
<!-- #   mutate_if(., is.factor, ~ as.numeric(as.integer(.x))) -->
<!-- # convert to standard deviation units -->
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://data-edu.github.io/tidyLPA/'>tidyLPA</a></span><span class='op'>)</span>


<span class='va'>out</span><span class='op'>&lt;-</span><span class='va'>nzl</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Hours.Internet</span>, 
          <span class='va'>Hours.Exercise</span>,
          <span class='va'>Hours.Work</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>scale</span><span class='op'>)</span>

<span class='va'>out</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://data-edu.github.io/tidyLPA/reference/single_imputation.html'>single_imputation</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tidyLPA</span><span class='fu'>::</span><span class='fu'><a href='https://data-edu.github.io/tidyLPA/reference/estimate_profiles.html'>estimate_profiles</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://data-edu.github.io/tidyLPA/reference/plot_profiles.html'>plot_profiles</a></span><span class='op'>(</span>add_line <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_9_files/figure-html5/unnamed-chunk-34-1.png" width="1152" /></p>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-gelman2020" class="csl-entry" role="doc-biblioentry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
