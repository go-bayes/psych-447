---
title: "Probability and Bayesian inference"
description: |
  "With an excursion into the whens and when nots of mediation"
author:
  - name: Joseph Bulbulia
    url: https://josephbulbulia.netlify.app
    affiliation: Victoria University of Wellington
    affiliation_url: https://www.wgtn.ac.nz
    orcid_id: 0000-0002-5861-2056
date: 2021-MAY-25
output:
  distill::distill_article:
  self_contained: false
toc: true
---


```{r figopen, echo=F}
knitr::include_graphics("op.png")
```


## Probability

We have been working with probability throughout this course.


Suppose there is a test that is 99% accurate at detecting COVID if you have it.

Very rarely it throws up a false positive,say one in a thousand.

You just tested positve. What is the probability that you have COVID? Our intuition is that we probably have COVID. However, let's assume COVID is rare. Currently in NZ, there are about 50 cases, so 1 in 100,000. The background rate matters.

Bayes rule says

$$ Pr(COVID|Positive) = \frac{Pr(Positive|COVID)\times Pr (COVID}{Pr(Positive)}
$$

We plug in the numbers:

Pr_Positive_COVID \<- 0.99 Pr_Positive_Healthy \<- 0.01 Pr_COVID \<- 0.00001

# Calculate the background probability of testing positive

Pr_Positive \<- Pr_Positive_COVID \* Pr_COVID + Pr_Positive_Healthy \* ( 1 - Pr_COVID )



# Now calculated your probability of testing positive

Pr_COVID_Positive \<- Pr_Positive_COVID \* Pr_COVID / Pr_Positive Pr_COVID_Positive

## Uncertainty 

$$
y_i \sim Normal ( \mu_i, \sigma)\\
\mu_i \sim \alpha + \beta x_i \\
\alpha \sim Normal(0,\sigma_{\alpha}) \\
\sigma_{\alpha} \sim Normal(0,1) \\
\beta \sim Normal(0,10) \\
\sigma \sim Exponentional (1) \\
x_i \sim Normal (0, 1)
$$

## Future Horizons



