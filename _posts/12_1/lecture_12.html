<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Missing data, measurement error, and course wrap-up</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-05-25"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-05-25"/>
  <meta name="article:author" content="Johannes Karl"/>
  <meta name="article:author" content="Joseph Bulbulia"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Missing data, measurement error, and course wrap-up"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Missing data, measurement error, and course wrap-up"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Statistical rethinking: A bayesian course with examples in r and stan;citation_publication_date=2020;citation_publisher=CRC press;citation_author=Richard McElreath"/>
  <meta name="citation_reference" content="citation_title=Amelia II: A program for missing data;citation_publication_date=2011;citation_volume=45;citation_author=James Honaker;citation_author=Gary King;citation_author=Matthew Blackwell"/>
  <meta name="citation_reference" content="citation_title=What is the difference between missing completely at random and missing at random?;citation_publication_date=2014;citation_volume=43;citation_doi=10.1093/ije/dyu080;citation_issn=0300-5771, 1464-3685;citation_author=Krishnan Bhaskaran;citation_author=Liam Smeeth"/>
  <meta name="citation_reference" content="citation_title=A unified approach to measurement error and missing data: Overview and applications;citation_publication_date=2017;citation_volume=46;citation_author=Matthew Blackwell;citation_author=James Honaker;citation_author=Gary King"/>
  <meta name="citation_reference" content="citation_title=Data analysis using regression and multilevel/hierarchical models;citation_publication_date=2006;citation_publisher=Cambridge university press;citation_author=Andrew Gelman;citation_author=Jennifer Hill"/>
  <meta name="citation_reference" content="citation_title=Thanks coefficient alpha, we’ll take it from here.;citation_publication_date=2018;citation_volume=23;citation_doi=10.1037/met0000144;citation_issn=1939-1463;citation_author=Daniel McNeish"/>
  <meta name="citation_reference" content="citation_title=Thanks Coefficient Alpha, We Still Need You!;citation_publication_date=2017;citation_publisher=SAGE PublicationsSage CA: Los Angeles, CA;citation_doi=10.1177/0013164417725127;citation_issn=0013-1644;citation_author=Tenko Raykov;citation_author=George A. Marcoulides"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Missing data, measurement error, and course wrap-up"]},{"type":"NULL"},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Johannes Karl"]},{"type":"character","attributes":{},"value":["https://johannes-karl.com"]},{"type":"character","attributes":{},"value":["Victoria University of Wellington"]},{"type":"character","attributes":{},"value":["https://www.wgtn.ac.nz"]},{"type":"character","attributes":{},"value":["0000-0001-5166-0728"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Joseph Bulbulia"]},{"type":"character","attributes":{},"value":["https://josephbulbulia.netlify.app"]},{"type":"character","attributes":{},"value":["Victoria University of Wellington"]},{"type":"character","attributes":{},"value":["https://www.wgtn.ac.nz"]},{"type":"character","attributes":{},"value":["0000-0002-5861-2056"]}]}]},{"type":"character","attributes":{},"value":["2021-MAY-25"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","code_folding","highlight"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["kate"]}]}]},{"type":"character","attributes":{},"value":["bib.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bib.bib","latent.png","lecture_12_files/anchor-4.2.2/anchor.min.js","lecture_12_files/bowser-1.9.3/bowser.min.js","lecture_12_files/distill-2.2.21/template.v2.js","lecture_12_files/figure-html5/adjust_blad_rror-1.png","lecture_12_files/figure-html5/adjust_meas_error-1.png","lecture_12_files/figure-html5/amelia_trace_3-1.png","lecture_12_files/figure-html5/amelia_trace2-1.png","lecture_12_files/figure-html5/bootega-1.png","lecture_12_files/figure-html5/bot_est-1.png","lecture_12_files/figure-html5/comparison_graph-1.png","lecture_12_files/figure-html5/dag-1.png","lecture_12_files/figure-html5/graph_impute-1.png","lecture_12_files/figure-html5/loop_lmer_function-1.png","lecture_12_files/figure-html5/measurement_error_confound-1.png","lecture_12_files/figure-html5/measurement_error_longitudinal_confound-1.png","lecture_12_files/figure-html5/mi_vismiss-1.png","lecture_12_files/figure-html5/omega-1.png","lecture_12_files/figure-html5/table_impute-1.png","lecture_12_files/figure-html5/unnamed-chunk-1-1.png","lecture_12_files/figure-html5/unnamed-chunk-11-1.png","lecture_12_files/figure-html5/unnamed-chunk-2-1.png","lecture_12_files/figure-html5/unnamed-chunk-3-1.png","lecture_12_files/figure-html5/unnamed-chunk-4-1.png","lecture_12_files/figure-html5/unnamed-chunk-5-1.png","lecture_12_files/figure-html5/unnamed-chunk-7-1.png","lecture_12_files/figure-html5/unnamed-chunk-8-1.png","lecture_12_files/figure-html5/unnamed-chunk-9-1.png","lecture_12_files/header-attrs-2.8.1/header-attrs.js","lecture_12_files/jquery-1.11.3/jquery.min.js","lecture_12_files/popper-2.6.0/popper.min.js","lecture_12_files/table1-1.0/table1_defaults.css","lecture_12_files/tippy-6.2.7/tippy-bundle.umd.min.js","lecture_12_files/tippy-6.2.7/tippy-light-border.css","lecture_12_files/tippy-6.2.7/tippy.css","lecture_12_files/tippy-6.2.7/tippy.umd.min.js","lecture_12_files/webcomponents-2.0.0/webcomponents.js","network.phg.png","network.png","RE__Lecture_12,_my_part/bib.bib","RE__Lecture_12,_my_part/latent.png","RE__Lecture_12,_my_part/lecture_12.Rmd","RE__Lecture_12,_my_part/op.png","RE__Lecture_12,_my_part 2/bib.bib","RE__Lecture_12,_my_part 2/latent.png","RE__Lecture_12,_my_part 2/lecture_12.Rmd","RE__Lecture_12,_my_part 2/op.png","RE__Lecture_12,_my_part.zip"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="lecture_12_files/header-attrs-2.8.1/header-attrs.js"></script>
  <link href="lecture_12_files/table1-1.0/table1_defaults.css" rel="stylesheet" />
  <script src="lecture_12_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="lecture_12_files/popper-2.6.0/popper.min.js"></script>
  <link href="lecture_12_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="lecture_12_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="lecture_12_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="lecture_12_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="lecture_12_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="lecture_12_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="lecture_12_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Missing data, measurement error, and course wrap-up","authors":[{"author":"Johannes Karl","authorURL":"https://johannes-karl.com","affiliation":"Victoria University of Wellington","affiliationURL":"https://www.wgtn.ac.nz","orcidID":"0000-0001-5166-0728"},{"author":"Joseph Bulbulia","authorURL":"https://josephbulbulia.netlify.app","affiliation":"Victoria University of Wellington","affiliationURL":"https://www.wgtn.ac.nz","orcidID":"0000-0002-5861-2056"}],"publishedDate":"2021-05-25T00:00:00.000+00:00","citationText":"Karl & Bulbulia, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Missing data, measurement error, and course wrap-up</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  Johannes Karl <a href="https://johannes-karl.com" class="uri">https://johannes-karl.com</a> (Victoria University of Wellington)<a href="https://www.wgtn.ac.nz" class="uri">https://www.wgtn.ac.nz</a>
  
,   Joseph Bulbulia <a href="https://josephbulbulia.netlify.app" class="uri">https://josephbulbulia.netlify.app</a> (Victoria University of Wellington)<a href="https://www.wgtn.ac.nz" class="uri">https://www.wgtn.ac.nz</a>
  
<br/>2021-MAY-25
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#some-thoughts-on-measurement">Some thoughts on measurement</a></li>
<li><a href="#what-is-reliability">What is reliability</a>
<ul>
<li><a href="#some-alternatives-to-the-latent-variable-perspective">Some alternatives to the latent variable perspective</a></li>
<li><a href="#measurement-and-validity">Measurement and validity</a>
<ul>
<li><a href="#validity-measurement-error-and-causal-confounding.">Validity, measurement error, and causal confounding.</a></li>
</ul></li>
<li><a href="#missing-data-is-a-form-of-measurement-error">Missing data is a form of measurement error</a></li>
<li><a href="#multiple-imputation-as-a-way-of-handling-missing-data.">Multiple-Imputation as a way of handling Missing Data.</a>
<ul>
<li><a href="#methods-for-multiple-imputation">Methods for Multiple-Imputation:</a></li>
<li><a href="#visualising-missingness">Visualising missingness</a></li>
<li><a href="#compare-multiple-imputation-results-with-row-wise-deleted-results">Compare multiple imputation results with row-wise deleted results</a></li>
</ul></li>
<li><a href="#faq-for-multiple-imputation">FAQ for Multiple Imputation</a></li>
<li><a href="#course-wrap-up-21-skills-youve-acquired">Course wrap up: 21 skills you’ve acquired</a></li>
</ul></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body-outset">

</div>
<div class="layout-chunk" data-layout="l-body-outset">

</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="network.png" width="450" /></p>
</div>
<h2 id="some-thoughts-on-measurement">Some thoughts on measurement</h2>
<p>Psychology is dominated by the latent variable perspective. Most constructs we are interested in cannot be directly measured, but rather have to be inferred from a range of indicators (For an example see Figure <a href="#fig:latent">1</a>).</p>

<div class="layout-chunk" data-layout="l-body-outset">
<div class="figure"><span id="fig:latent"></span>
<img src="latent.png" alt="Standard latent variable model." width="248" />
<p class="caption">
Figure 1: Standard latent variable model.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='va'>bfi</span> <span class='op'>&lt;-</span> <span class='fu'>psych</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/psych/man/bfi.html'>bfi</a></span>
<span class='va'>reverse_bfi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A1"</span>, <span class='st'>"C4"</span>, <span class='st'>"C5"</span>, <span class='st'>"E1"</span>, <span class='st'>"E2"</span>, <span class='st'>"O2"</span>, <span class='st'>"O5"</span><span class='op'>)</span>
<span class='va'>bfi</span><span class='op'>[</span><span class='va'>reverse_bfi</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>bfi</span><span class='op'>[</span><span class='va'>reverse_bfi</span><span class='op'>]</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>car</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/car/man/recode.html'>recode</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"1 = 6; 2 = 5; 3 = 4; 4 = 3; 5 = 2; 6 = 1"</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="what-is-reliability">What is reliability</h1>
<p>Many students might learn what reliability is, but once they reach research praxis they often have forgotten the details and what remains is the <span class="math inline">\(\alpha &gt; .70\)</span> rule. To address this issue first, this rule was not suggested by Cronbach. The cut-off was suggested by Nunnally <span class="citation" data-cites="Nunnally1994">(<a href="#ref-Nunnally1994" role="doc-biblioref">1994</a>)</span>. Let’s see what the original source says:</p>
<blockquote>
<p>“A satisfactory level of reliability depends on how a measure is being used. In the early stages of predictive or construct validation research, time and energy can be saved using instruments that have only modest reliability, e.g., .70. If significant correlations are found, corrections for attenuation will estimate how much the correlations will increase when reliabilities of measures are increased. If these corrected values look promising, it will be worth the time and effort to increase the number of items and reduce much beyond .80 in basic research is often wasteful of time and money. Measurement error attenuates correlations very little at that level. Strenuous and unnecessary efforts at standardization in addition to increasing the number of items might be required to obtain a reliability of, say, .90. In contrast to the standards used to compare groups, a reliability of .80 may not be nearly high enough in making decisions about individuals. Group research is often concerned with the size of correlations and with mean differences among experimental treatments, for which a reliability of .80 is adequate. However, a great deal hinges on the exact test scores when decisions are made about individuals. If, for example, children with IQs below 70 are to be placed in special classes, it may make a great deal of difference whether a child has an IQ of 65 or 75 on a particular test. When selection standards are quite rigorous, decisions depend on very small score differences, and so it is difficult to accept any measurement error. We have noted that the standard error of measurement is almost one-third as large as the overall standard deviation of test scores even when the reliability is .90. If important decisions are made with respect to specific test scores, a reliability of .90 is the bare minimum, and a reliability of .95 should be considered the desirable standard. However, never switch to a less valid measure simply because it is more reliable.” (pp.264)</p>
</blockquote>
<p>To boil down what Nunnally said; reliability can never replace validity, the reliability your measure should achieve is dependent on the context of application. The commonly applied rule of .70 is fitting for some contexts. Specifically contexts where one wants to save time and effort. Lance, Butts, and Michels <span class="citation" data-cites="Lance2006">(<a href="#ref-Lance2006" role="doc-biblioref">2006</a>)</span> make the important point that this is not a context that applies in most published papers. In most contexts we would want <span class="math inline">\(\alpha\)</span> to be over .80 and over .90 | .95 if we make judgments about individuals based on this test, such as personality questionnaires used for hiring.</p>
<p>In the discussion on the applicability of <span class="math inline">\(\alpha\)</span> Nunnally makes statements such as:</p>
<blockquote>
<p>“Coefficient a usually provides a good estimate of reliability because sampling of content is usually the major source of measurement error for static constructs and also because it is sensitive to the”sampling" of situational factors as well as item content." (p.252)</p>
</blockquote>
<p>But what is the “usual” case which Nunnally assumes. We could assume that it is the case in which the underlying assumption of <span class="math inline">\(\alpha\)</span> are met. Let’s have a look at these assumptions to better appreciate Nunnally’s usual case. I am paraphrasing in this section from the excellent article by McNeish <span class="citation" data-cites="McNeish2018">(<a href="#ref-McNeish2018" role="doc-biblioref">2018</a>)</span> and I highly recommend reading it for a more detailed discussion.</p>
<ol type="1">
<li>The scale is uni-dimensional.</li>
<li>Scale items are on a continuous scale and normally distributed.</li>
<li>The scale adheres to tau equivalence.</li>
<li>The errors of the items do not covary.</li>
</ol>
<p>Let’s look at the reliability of our Extraversion scale</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'>psych</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/psych/man/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>bfi</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"E"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Reliability analysis   
Call: psych::alpha(x = bfi[paste0(&quot;E&quot;, 1:5)])

  raw_alpha std.alpha G6(smc) average_r S/N   ase mean  sd
      0.76      0.76    0.73      0.39 3.2 0.007  4.1 1.1
 median_r
     0.38

 lower alpha upper     95% confidence boundaries
0.75 0.76 0.78 

 Reliability if an item is dropped:
   raw_alpha std.alpha G6(smc) average_r S/N alpha se
E1      0.73      0.73    0.67      0.40 2.6   0.0084
E2      0.69      0.69    0.63      0.36 2.3   0.0095
E3      0.73      0.73    0.67      0.40 2.7   0.0082
E4      0.70      0.70    0.65      0.37 2.4   0.0091
E5      0.74      0.74    0.69      0.42 2.9   0.0078
    var.r med.r
E1 0.0044  0.38
E2 0.0028  0.35
E3 0.0071  0.40
E4 0.0033  0.38
E5 0.0043  0.42

 Item statistics 
      n raw.r std.r r.cor r.drop mean  sd
E1 2777  0.72  0.70  0.59   0.52  4.0 1.6
E2 2784  0.78  0.76  0.69   0.61  3.9 1.6
E3 2775  0.68  0.70  0.58   0.50  4.0 1.4
E4 2791  0.75  0.75  0.66   0.58  4.4 1.5
E5 2779  0.64  0.66  0.52   0.45  4.4 1.3

Non missing response frequency for each item
      1    2    3    4    5    6 miss
E1 0.09 0.13 0.16 0.15 0.23 0.24 0.01
E2 0.09 0.14 0.22 0.12 0.24 0.19 0.01
E3 0.05 0.11 0.15 0.30 0.27 0.13 0.01
E4 0.05 0.09 0.10 0.16 0.34 0.26 0.00
E5 0.03 0.08 0.10 0.22 0.34 0.22 0.01</code></pre>
</div>
<p>Looks all good, but when we look at the assumptions of <span class="math inline">\(\alpha\)</span> this looks less good. Some items e.g. E2 show very high loadings and E5 shows a substantially lower loading.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>psych</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/psych/man/fa.html'>fa</a></span><span class='op'>(</span><span class='va'>bfi</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"E"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span>, nfactors <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Factor Analysis using method =  minres
Call: psych::fa(r = bfi[paste0(&quot;E&quot;, 1:5)], nfactors = 1)
Standardized loadings (pattern matrix) based upon correlation matrix
    MR1   h2   u2 com
E1 0.60 0.36 0.64   1
E2 0.72 0.52 0.48   1
E3 0.59 0.34 0.66   1
E4 0.69 0.47 0.53   1
E5 0.52 0.28 0.72   1

                MR1
SS loadings    1.98
Proportion Var 0.40

Mean item complexity =  1
Test of the hypothesis that 1 factor is sufficient.

The degrees of freedom for the null model are  10  and the objective function was  1.11 with Chi Square of  3112.54
The degrees of freedom for the model are 5  and the objective function was  0.03 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.05 

The harmonic number of observations is  2767 with the empirical chi square  67.5  with prob &lt;  3.4e-13 
The total number of observations was  2800  with Likelihood Chi Square =  86.38  with prob &lt;  3.9e-17 

Tucker Lewis Index of factoring reliability =  0.948
RMSEA index =  0.076  and the 90 % confidence intervals are  0.063 0.091
BIC =  46.7
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1
Correlation of (regression) scores with factors   0.88
Multiple R square of scores with factors          0.78
Minimum correlation of possible factor scores     0.55</code></pre>
</div>
<p>So what are the alternatives to alpha. First I do not think that we need to replace alpha for now Raykov and Marcoulides <span class="citation" data-cites="Raykov2017">(<a href="#ref-Raykov2017" role="doc-biblioref">2017</a>)</span> make some interesting points on its contiued usage. So instead of replacing it, we could try supplementing it. Alternatives suggested by McNeish <span class="citation" data-cites="McNeish2018">(<a href="#ref-McNeish2018" role="doc-biblioref">2018</a>)</span> are omega total, and GLB. So how would we compute those reliabilities. We have a number of options from different packages, such as the <em>psych</em> package.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='va'>psy_omega</span> <span class='op'>&lt;-</span> <span class='fu'>psych</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/psych/man/omega.html'>omega</a></span><span class='op'>(</span><span class='va'>bfi</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"E"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span>, nfactors <span class='op'>=</span> <span class='fl'>3</span>, poly <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
</code></pre>
</div>
<img src="lecture_12_files/figure-html5/omega-1.png" width="1152" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>psy_omega</span>
</code></pre>
</div>
<pre><code>Omega 
Call: omegah(m = m, nfactors = nfactors, fm = fm, key = key, flip = flip, 
    digits = digits, title = title, sl = sl, labels = labels, 
    plot = plot, n.obs = n.obs, rotate = rotate, Phi = Phi, option = option, 
    covar = covar)
Alpha:                 0.76 
G.6:                   0.73 
Omega Hierarchical:    0.66 
Omega H asymptotic:    0.83 
Omega Total            0.79 

Schmid Leiman Factor loadings greater than  0.2 
      g  F1*  F2*   F3*   h2   u2   p2
E1 0.49 0.36            0.37 0.63 0.65
E2 0.59 0.50            0.60 0.40 0.57
E3 0.66                 0.47 0.53 0.92
E4 0.58 0.38       0.22 0.53 0.47 0.64
E5 0.59                 0.40 0.60 0.87

With eigenvalues of:
   g  F1*  F2*  F3* 
1.70 0.53 0.04 0.11 

general/max  3.22   max/min =   13.29
mean percent general =  0.73    with sd =  0.15 and cv of  0.21 
Explained Common Variance of the general factor =  0.72 

The degrees of freedom are -2  and the fit is  0 
The number of observations was  2800  with Chi Square =  0  with prob &lt;  NA
The root mean square of the residuals is  0 
The df corrected root mean square of the residuals is  NA

Compare this with the adequacy of just a general factor and no group factors
The degrees of freedom for just the general factor are 5  and the fit is  0.11 
The number of observations was  2800  with Chi Square =  312.5  with prob &lt;  2.1e-65
The root mean square of the residuals is  0.09 
The df corrected root mean square of the residuals is  0.13 

RMSEA index =  0.148  and the 10 % confidence intervals are  0.135 0.162
BIC =  272.81 

Measures of factor score adequacy             
                                                 g   F1*
Correlation of scores with factors            0.83  0.61
Multiple R square of scores with factors      0.68  0.38
Minimum correlation of factor score estimates 0.37 -0.25
                                                F2*   F3*
Correlation of scores with factors             0.20  0.41
Multiple R square of scores with factors       0.04  0.17
Minimum correlation of factor score estimates -0.92 -0.66

 Total, General and Subset omega for each subset
                                                 g  F1*
Omega total for total scores and subscales    0.79 0.74
Omega general for total scores and subscales  0.66 0.47
Omega group for total scores and subscales    0.13 0.27
                                               F2*  F3*
Omega total for total scores and subscales    0.45 0.38
Omega general for total scores and subscales  0.43 0.35
Omega group for total scores and subscales    0.02 0.03</code></pre>
</div>
<p>I personally prefer the <em>ufs</em> package, which containts the niffty scaleStructure function. Importantly, there is a wide range of packages and a substantial number of papers that advance research in this <a href="https://journals.sagepub.com/doi/full/10.1177/2515245920951747">area</a>.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'>ufs</span><span class='fu'>::</span><span class='fu'><a href='https://r-packages.gitlab.io/ufs/reference/scaleStructure.html'>scaleStructure</a></span><span class='op'>(</span><span class='va'>bfi</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"E"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Information about this analysis:

                 Dataframe: bfi[paste0(&quot;E&quot;, 1:5)]
                     Items: all
              Observations: 2713
     Positive correlations: 10 out of 10 (100%)

Estimates assuming interval level:

             Omega (total): 0.8
      Omega (hierarchical): 0.65
   Revelle&#39;s omega (total): 0.8
Greatest Lower Bound (GLB): 0.8
             Coefficient H: 0.78
         Coefficient alpha: 0.76

(Estimates assuming ordinal level not computed, as the polychoric correlation matrix has missing values.)

Note: the normal point estimate and confidence interval for omega are based on the procedure suggested by Dunn, Baguley &amp; Brunsden (2013) using the MBESS function ci.reliability, whereas the psych package point estimate was suggested in Revelle &amp; Zinbarg (2008). See the help (&#39;?scaleStructure&#39;) for more information.</code></pre>
</div>
<h2 id="some-alternatives-to-the-latent-variable-perspective">Some alternatives to the latent variable perspective</h2>
<p>In recent years network statistics have found increased use in psychology as conceptual alternatives to the latent variable model (even thought they are mathematical equivalents). In the network approach we assume that communities of items arise due to their interaction and not due to an underlying latent variable. The network approach commonly uses regularized partial correlations between variables to model the network. What this means is that first all variables are correlated while controling for all other variables in the dataset. Subsequently, we use a mathematical approach aimed at iteratively shrinking correlations that are close to 0 to exactely 0, reducing the complexity of the structure.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>net_mdl</span> <span class='op'>&lt;-</span> <span class='fu'>bootnet</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/bootnet/man/estimateNetwork.html'>estimateNetwork</a></span><span class='op'>(</span><span class='fu'>select</span><span class='op'>(</span><span class='va'>bfi</span>, <span class='op'>-</span><span class='va'>age</span>, <span class='op'>-</span><span class='va'>education</span>, <span class='op'>-</span><span class='va'>gender</span><span class='op'>)</span>, <span class='st'>"EBICglasso"</span><span class='op'>)</span>
<span class='fu'>qgraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/qgraph/man/qgraph.html'>qgraph</a></span><span class='op'>(</span><span class='va'>net_mdl</span><span class='op'>$</span><span class='va'>graph</span>, layout <span class='op'>=</span> <span class='st'>"spring"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/bot_est-1.png" width="1152" /></p>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ega_out</span> <span class='op'>&lt;-</span>
  <span class='fu'>EGAnet</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/EGAnet/man/bootEGA.html'>bootEGA</a></span><span class='op'>(</span>
    <span class='fu'>select</span><span class='op'>(</span><span class='va'>bfi</span>, <span class='op'>-</span><span class='va'>age</span>, <span class='op'>-</span><span class='va'>education</span>, <span class='op'>-</span><span class='va'>gender</span><span class='op'>)</span>,
    plot.typicalStructure <span class='op'>=</span> <span class='cn'>T</span>,
    iter <span class='op'>=</span> <span class='fl'>1000</span>
  <span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/bootega-1.png" width="1152" /></p>
</div>
<h2 id="measurement-and-validity">Measurement and validity</h2>
<p>Do your measures describe facts about how people are? This is a mission critical question. Yet there has been very little attention.</p>
<p>We find this advice from Jessica Flake is helpful: <a href="https://www.youtube.com/watch?v=Cq6n7AS_r8w" class="uri">https://www.youtube.com/watch?v=Cq6n7AS_r8w</a></p>
<p>To summarise:</p>
<p>Include measurement in your research plan &amp; pre-register that plan. Ask yourself:</p>
<ol type="1">
<li>What is your construct? (What are you trying to measure?)</li>
<li>Why and how did you select measures?</li>
</ol>
<ul>
<li>Jingle fallacy: two different contructs are the same if they have different names.</li>
<li>Jangle fallacy: two identical constructs are different because they have different names.</li>
</ul>
<ol start="3" type="1">
<li>How do you use and operationalise your construct?</li>
<li>How do you quantify your measure?</li>
<li>Did you modify your measure, if so, why? Report…</li>
<li>Justify all measure modifications…</li>
</ol>
<p>Points developed in this paper: <a href="https://psyarxiv.com/c45t9/" class="uri">https://psyarxiv.com/c45t9/</a></p>
<p>See also the work of Eiko Fried: <a href="https://eiko-fried.com/" class="uri">https://eiko-fried.com/</a></p>
<h3 id="validity-measurement-error-and-causal-confounding.">Validity, measurement error, and causal confounding.</h3>
<h4 id="measurement-error-and-recall-bias">Measurement error and recall bias:</h4>
<blockquote>
<p>Measurement error is the degree to which we mismeasure a variable, which can lead to bias in a number of ways. If the error is dependent on the exposure or the outcome, (e.g. we measure the exposure with less accuracy for a group without a disease than with it), it is called differential measurement error. If the error has nothing to do with the exposure or outcome, it’s called non-differential measurement error. Under most conditions, non-differential error will bias the estimate of effect towards the null. In this way, it’s at least predictable, but for small effects or inadequately powered studies, it can make a true effect disappear. If there is error in both the exposure and outcome, the errors themselves can also be associated, opening a back-door path between the exposure and outcome. - Malcolm Barrett: <a href="https://ggdag.malco.io/articles/bias-structures.html" class="uri">https://ggdag.malco.io/articles/bias-structures.html</a></p>
</blockquote>
<p>Barrett’s recall of vitimans example: Does taking vitamins in childhood protect against bladder cancer? If people who have bladder cancer are more likely to recall vitam taking, then this can support the inference that vitams cause bladder cancer even if the opposite is true:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/malcolmbarrett/ggdag'>ggdag</a></span><span class='op'>)</span>
<span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tribble.html'>tribble</a></span><span class='op'>(</span>
  <span class='op'>~</span><span class='va'>name</span>,            <span class='op'>~</span><span class='va'>x</span>,  <span class='op'>~</span><span class='va'>y</span>,
  <span class='st'>"bladder_cancer"</span>,    <span class='fl'>1</span>,   <span class='fl'>0</span>,
  <span class='st'>"vitamins"</span>,          <span class='fl'>0</span>,   <span class='fl'>0</span>,
  <span class='st'>"diagnosed_bc"</span>,      <span class='fl'>1</span>,   <span class='fl'>1</span>,
  <span class='st'>"recalled_vits"</span>,     <span class='fl'>0</span>,   <span class='fl'>1</span>,
  <span class='st'>"bc_error"</span>,          <span class='fl'>1</span>,   <span class='fl'>2</span>,
  <span class='st'>"vits_error"</span>,        <span class='fl'>0</span>,   <span class='fl'>2</span>,
<span class='op'>)</span>


<span class='va'>bladder_dag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/dagify.html'>dagify</a></span><span class='op'>(</span>
  <span class='va'>diagnosed_bc</span> <span class='op'>~</span> <span class='va'>bc_error</span> <span class='op'>+</span> <span class='va'>bladder_cancer</span>,
  <span class='va'>recalled_vits</span> <span class='op'>~</span> <span class='va'>vitamins</span> <span class='op'>+</span> <span class='va'>vits_error</span>,
  <span class='va'>vits_error</span> <span class='op'>~</span> <span class='va'>bladder_cancer</span>,
  exposure <span class='op'>=</span> <span class='st'>"recalled_vits"</span>,
  outcome <span class='op'>=</span> <span class='st'>"bladder_cancer"</span>,
  latent <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"bc_error"</span>,<span class='st'>"vits_error"</span><span class='op'>)</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    bladder_cancer <span class='op'>=</span> <span class='st'>"Bladder Cancer"</span>,
    vitamins <span class='op'>=</span> <span class='st'>"Childhood Vitamin \nIntake"</span>,
    diagnosed_bc <span class='op'>=</span> <span class='st'>"Diagnosed \nBladder Cancer"</span>,
    recalled_vits <span class='op'>=</span> <span class='st'>"Memory of \nTaking Vitamins"</span>,
    bc_error <span class='op'>=</span> <span class='st'>"Measurement Error, \nDiagnosis"</span>,
    vits_error <span class='op'>=</span> <span class='st'>"Measurement Error, \nVitamins"</span>
  <span class='op'>)</span>,
  coords <span class='op'>=</span> <span class='va'>coords</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/ggdag.html'>ggdag</a></span><span class='op'>(</span><span class='va'>bladder_dag</span>, text <span class='op'>=</span> <span class='cn'>FALSE</span>, use_labels <span class='op'>=</span> <span class='st'>"label"</span>, node_size <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/theme_dag_blank.html'>theme_dag_blank</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_12_files/figure-html5/measurement_error_confound-1.png" width="1152" /></p>
</div>
<p>In this DAG, we can obtain an unbiased estimate when we do not adjust for baseline CES-D scores:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/adjustment_sets.html'>ggdag_adjustment_set</a></span><span class='op'>(</span><span class='va'>bladder_dag</span>,
                     text <span class='op'>=</span> <span class='cn'>FALSE</span>, use_labels <span class='op'>=</span> <span class='st'>"label"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/theme_dag_blank.html'>theme_dag_blank</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/adjust_blad_rror-1.png" width="1152" /></p>
</div>
<h4 id="measurement-error-in-panel-studies">Measurement error in panel studies</h4>
<p>The Centers for Epidemiological Studies–Depression (CES-D) scale assess depression, but the scale is known to have measurement error.</p>
<p>Question. Does completing Psych 477 affect change in depression changes after the course is finished. Assume no relationship. Nevertheless, conditioning on the baseline measure of CES-D will create bias in our model that arises from from measurement error.</p>
<p>Here is Barrett’s example:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># set coordinates</span>
<span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tribble.html'>tribble</a></span><span class='op'>(</span>
  <span class='op'>~</span><span class='va'>name</span>,              <span class='op'>~</span><span class='va'>x</span>,  <span class='op'>~</span><span class='va'>y</span>,
  <span class='st'>"honors"</span>,            <span class='fl'>1</span>,   <span class='fl'>3</span>,
  <span class='st'>"depression"</span>,        <span class='fl'>2</span>,   <span class='fl'>3</span>,
  <span class='st'>"cesd"</span>,              <span class='fl'>2</span>,   <span class='fl'>2</span>,
  <span class='st'>"baseline_error"</span>,    <span class='fl'>2</span>,   <span class='fl'>1</span>,
  <span class='st'>"depression_change"</span>, <span class='fl'>3</span>,   <span class='fl'>3</span>,
  <span class='st'>"cesd_change"</span>,       <span class='fl'>3</span>,   <span class='fl'>2</span>,
  <span class='st'>"followup_error"</span>,    <span class='fl'>3</span>,   <span class='fl'>1</span>
<span class='op'>)</span>

<span class='va'>cesd_dag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/dagify.html'>dagify</a></span><span class='op'>(</span>
  <span class='va'>depression</span> <span class='op'>~</span> <span class='va'>honors</span>,
  <span class='va'>cesd</span> <span class='op'>~</span> <span class='va'>depression</span> <span class='op'>+</span> <span class='va'>baseline_error</span>,
  <span class='va'>cesd_change</span> <span class='op'>~</span> <span class='va'>depression_change</span> <span class='op'>+</span> <span class='va'>followup_error</span> <span class='op'>+</span> <span class='va'>baseline_error</span>,
  outcome <span class='op'>=</span> <span class='st'>"depression_change"</span>,
  exposure  <span class='op'>=</span> <span class='st'>"honors"</span>,
  latent <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"followup_error"</span>,<span class='st'>"baseline_error"</span><span class='op'>)</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    honors <span class='op'>=</span> <span class='st'>"447 Completion"</span>,
    depression <span class='op'>=</span> <span class='st'>"Depression"</span>,
    cesd <span class='op'>=</span> <span class='st'>"CES-D"</span>,
    cesd_change <span class='op'>=</span> <span class='st'>"Change CES-D"</span>,
    depression_change <span class='op'>=</span> <span class='st'>"Change in \nDepression"</span>,
    baseline_error <span class='op'>=</span> <span class='st'>"Measurement Error, \nBaseline"</span>,
    followup_error <span class='op'>=</span> <span class='st'>"Measurement Error, \nFollow-up"</span>
  <span class='op'>)</span>,
  coords <span class='op'>=</span> <span class='va'>coords</span>
<span class='op'>)</span><span class='co'># %&gt;%</span>
 <span class='co'># control_for(c("baseline_error","followup_error"))</span>

<span class='va'>cesd_dag</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/d_relationship.html'>ggdag_dconnected</a></span><span class='op'>(</span>
    from <span class='op'>=</span> <span class='st'>"honors"</span>,
    to <span class='op'>=</span> <span class='st'>"cesd_change"</span>,
    controlling_for <span class='op'>=</span> <span class='st'>"cesd"</span>,
    text <span class='op'>=</span> <span class='cn'>FALSE</span>,
    use_labels <span class='op'>=</span> <span class='st'>"label"</span>,
    collider_lines <span class='op'>=</span> <span class='cn'>FALSE</span>
  <span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/theme_dag_blank.html'>theme_dag_blank</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="lecture_12_files/figure-html5/measurement_error_longitudinal_confound-1.png" width="1152" /></p>
</div>
<p>The DAG reveals we can obtain an unbiased estimate when we do not adjust for baseline CES-D scores:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/adjustment_sets.html'>ggdag_adjustment_set</a></span><span class='op'>(</span><span class='va'>cesd_dag</span>,
                     text <span class='op'>=</span> <span class='cn'>FALSE</span>, use_labels <span class='op'>=</span> <span class='st'>"label"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/theme_dag_blank.html'>theme_dag_blank</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/adjust_meas_error-1.png" width="1152" /></p>
</div>
<p>Of course the DAG might not be correct. Depressed people might be drawn to psych 447.</p>
<h2 id="missing-data-is-a-form-of-measurement-error">Missing data is a form of measurement error</h2>
<p>Missing data is an extreme form of measurement error.See: <span class="citation" data-cites="mcelreath2020Reading">(<a href="#ref-mcelreath2020Reading" role="doc-biblioref"><strong>mcelreath2020Reading?</strong></a>)</span></p>
<h2 id="multiple-imputation-as-a-way-of-handling-missing-data.">Multiple-Imputation as a way of handling Missing Data.</h2>
<h3 id="methods-for-multiple-imputation">Methods for Multiple-Imputation:</h3>
<p><span class="citation" data-cites="honaker2011"><a href="#ref-honaker2011" role="doc-biblioref">Honaker, King, and Blackwell</a> (<a href="#ref-honaker2011" role="doc-biblioref">2011</a>)</span></p>
<p><span class="citation" data-cites="bhaskaran2014"><a href="#ref-bhaskaran2014" role="doc-biblioref">Bhaskaran and Smeeth</a> (<a href="#ref-bhaskaran2014" role="doc-biblioref">2014</a>)</span></p>
<p><span class="citation" data-cites="blackwell2017"><a href="#ref-blackwell2017" role="doc-biblioref">Blackwell, Honaker, and King</a> (<a href="#ref-blackwell2017" role="doc-biblioref">2017</a>)</span></p>
<p><span class="citation" data-cites="mcelreath2020"><a href="#ref-mcelreath2020" role="doc-biblioref">McElreath</a> (<a href="#ref-mcelreath2020" role="doc-biblioref">2020</a>)</span></p>
<p><a href="https://gking.harvard.edu/category/research-interests/methods/missing-data" class="uri">https://gking.harvard.edu/category/research-interests/methods/missing-data</a></p>
<p>Missing data poses a problem. Missingness biases inference. However, missingness need not be intractable. We can use regression to predict missing values when the missing data are random <em>conditional on known features of the data,</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Where MAR assumptions are satisfied we predict the missing observations using regression. Because regression is uncertain, we must generate multiple datasets with observations. This process of generating multiple datasets is called <em>multiple imputation.</em> Before proceeding with an explanation of the mechanics of multiple imputation, we take a moment to recollect two fundamental principles of data science that we have been discussing throughout this course:</p>
<ol type="1">
<li><p>The practice of statistical inference is educated guesswork. We never observe population parameters, we only observe samples. We assume that our samples are drawn randomly from an unobserved population. We we move from measured features of our sample to unmeasured features of a population we are projecting with uncertainty. Multiply imputing missing data is no different. multiple imputation is continuous with a data-scientist’s larger mission of guessing wisely[^1]: For a explanation, see: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4121561/#:~:text=&#39;Missing%20completely%20at%20random&#39;%20means,missing%20and%20observed%20blood%20pressures.">here</a></p></li>
<li><p>Regression is a tool for prediction and regression is also a tool for causal inference. How we go about using regression differs depending on weather we want to predict or whether we want to explain (i.e. casual inference). When we regress to predict, it is generally useful to include all relevant covariates in our dataset that might be related to the outcome and that are not co-linear with other indicators in our dataset.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p></li>
</ol>
<p><strong>Prediction</strong>: we have discussed strategies for assessing improvements in model fit for prediction using criteria such as the BIC criterion, the WAIC criterion, and LOO.</p>
<p>Gelman and Hill offer the following advice about inclusion of variables when using regression to predict <span class="citation" data-cites="gelman2006">(<a href="#ref-gelman2006" role="doc-biblioref">Gelman and Hill 2006, 69</a>)</span>:</p>
<blockquote>
<p>Our general principles for building regression models for prediction are as follows:</p>
</blockquote>
<blockquote>
<ol type="1">
<li>Include all input variables that, for substantive reasons, might be expected to be important in predicting the outcome.</li>
</ol>
</blockquote>
<blockquote>
<ol start="2" type="1">
<li>It is not always necessary to include these inputs as separate predictors—for example, sometimes several inputs can be averaged or summed to create a “total score” that can be used as a single predictor in the model.</li>
</ol>
</blockquote>
<blockquote>
<ol start="3" type="1">
<li>For inputs that have large effects, consider including their interactions as well.</li>
</ol>
</blockquote>
<blockquote>
<ol start="4" type="1">
<li>We suggest the following strategy for decisions regarding whether to exclude a variable from a prediction model based on expected sign and statistical significance (typically measured at the 5% level; that is, a coefficient is “statistically significant” if its estimate is more than 2 standard errors from zero):</li>
</ol>
<!-- -->
<ol type="a">
<li>If a predictor is not statistically significant and has the expected sign, it is generally fine to keep it in. It may not help predictions dramatically but is also probably not hurting them.</li>
<li>If a predictor is not statistically significant and does not have the expected sign (for example, incumbency having a negative effect on vote share), consider removing it from the model (that is, setting its coefficient to zero).</li>
<li>If a predictor is statistically significant and does not have the expected sign, then think hard if it makes sense. (For example, perhaps this is a country such as India in which incumbents are generally unpopular; see Linden, 2006.) Try to gather data on potential lurking variables and include them in the analysis.</li>
<li>If a predictor is statistically significant and has the expected sign, then by all means keep it in the model. These strategies do not completely solve our problems but they help keep us from making mistakes such as discarding important information. They are predicated on having thought hard about these relationships before fitting the model. It’s always easier to justify a coefficient’s sign after the fact than to think hard ahead of time about what we expect. On the other hand, an explanation that is determined after running the model can still be valid. We should be able to adjust our theories in light of new information <span class="citation" data-cites="gelman2006">(<a href="#ref-gelman2006" role="doc-biblioref">Gelman and Hill 2006, 69</a>)</span>.</li>
</ol>
</blockquote>
<p><strong>Causal inference</strong>: do not include all predictors that might be associated with the outcome. Doing so is an invitation to confounding causal inference. To obtain an unbaised estimate of an exposure’s causal effect on the outcome(s) of interest we must close all backdoor paths from a predictor to an outcome and we must avoid conditioning on any colliders. As Richard McElreath writes <span class="citation" data-cites="mcelreath2020">(<a href="#ref-mcelreath2020" role="doc-biblioref">McElreath 2020, 46</a>)</span></p>
<blockquote>
<p>But the approach which dominates in many parts of biology and the social sciences is instead CAUSAL SALAD.36 Causal salad means tossing various “control” variables into a statistical model, observing changes in estimates, and then telling a story about causation. Causal salad seems founded on the notion that only omitted variables can mislead us about causation. But included variables can just as easily confound us. When tossing a causal salad, a model that makes good predictions may still mislead about causation. If we use the model to plan an intervention, it will get everything wrong <span class="citation" data-cites="mcelreath2020">(<a href="#ref-mcelreath2020" role="doc-biblioref">McElreath 2020, 46</a>)</span>.</p>
</blockquote>
<p>To help assist us with the problems of unbiased causal inference we have discussed the utility of building causal DAGs, noting that inference is always conditional on the DAG that we have drawn. Frequently, the data under-determine the DAG. There are many DAGs consistent with our observations. Regression is a powerful tool for reliable causal inference but it is not sufficient for reliable inference.</p>
<p>So which approach to regression should we use for multiple imputation. The answer is that we should use the predictive approach. When we are imputing we are are <em>predicting</em> features of a population. We shoudl therefore follow the Gelman and Hill’s advice to stratifying across all indicators that might improve predictive accuracy.</p>
<h3 id="visualising-missingness">Visualising missingness</h3>
<p>When you are examining your data, make sure to assessing missing responses. A handy tool for assessing missingess is a missingness graph.</p>
<p>Let’s consider subsample of the <code>nz-jitter</code> longitudinal dataset that has responded to multiple waves. Today we will ask whether employment insecurity is causally related to charitable donations. To predict missingness we should probably include other indicators besides those that I have included here, but these indicators will be sufficient for our purposes.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>nz12</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span>
    <span class='va'>Id</span>,
    <span class='va'>CharityDonate</span>,
    <span class='va'>Emp.JobSecure</span>,
    <span class='va'>Household.INC</span>,
    <span class='va'>Hours.Work</span>,
    <span class='va'>Male</span>,
    <span class='va'>Employed</span>,
    <span class='va'>Pol.Orient</span>,
    <span class='va'>Relid</span>,
    <span class='va'>Wave</span>,
    <span class='va'>yearS</span>,
    <span class='va'>KESSLER6sum</span>,
    <span class='va'>Partner</span>,
    <span class='va'>Age</span>,
    <span class='va'>yearS</span>
  <span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Partner <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Partner</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># always inspect your data frame</span>
<span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 4,140
Columns: 14
$ Id            &lt;fct&gt; 15, 15, 15, 15, 15, 15, 15, 15, 15, …
$ CharityDonate &lt;dbl&gt; 20, 0, 5, 10, 70, 0, 170, 160, 80, 1…
$ Emp.JobSecure &lt;dbl&gt; 4, 6, 6, NA, 7, 5, NA, 7, NA, 7, NA,…
$ Household.INC &lt;dbl&gt; 80000, 70000, 56000, 65000, 85000, 8…
$ Hours.Work    &lt;dbl&gt; NA, NA, 0, 0, 15, 25, 0, 18, 0, 14, …
$ Male          &lt;fct&gt; Male, Male, Male, Male, Male, Male, …
$ Employed      &lt;dbl&gt; 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, …
$ Pol.Orient    &lt;dbl&gt; 3, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 4, …
$ Relid         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, …
$ Wave          &lt;fct&gt; 2010, 2011, 2012, 2013, 2014, 2015, …
$ yearS         &lt;dbl&gt; 27, 347, 834, 1200, 1608, 2037, 2336…
$ KESSLER6sum   &lt;int&gt; 4, 4, 4, 4, 3, 4, 5, 4, 3, 5, 1, 2, …
$ Partner       &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ Age           &lt;dbl&gt; 38.82820, 39.70431, 41.03765, 42.036…</code></pre>
</div>
<p>How many individuals?</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nz12</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Wave</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarise</span><span class='op'>(</span>Unique_Id <span class='op'>=</span> <span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>Id</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 10 x 2
   Wave  Unique_Id
   &lt;fct&gt;     &lt;int&gt;
 1 2010        414
 2 2011        414
 3 2012        414
 4 2013        414
 5 2014        414
 6 2015        414
 7 2016        414
 8 2017        414
 9 2018        414
10 2019        414</code></pre>
</div>
<p>We can visualise the data, using the <code>naniar</code> package:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/njtierney/naniar'>naniar</a></span><span class='op'>)</span>
<span class='fu'><a href='http://visdat.njtierney.com//reference/vis_miss.html'>vis_miss</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/mi_vismiss-1.png" width="1152" /></p>
</div>
<p>We can see substantial missingness for <code>Emp.JobSecure</code>.</p>
<p>Let’s explore this:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span><span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>Wave</span>, <span class='va'>Emp.JobSecure</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Wave</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>tally</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Emp.JobSecure</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 10 x 2
   Wave      n
   &lt;fct&gt; &lt;int&gt;
 1 2010     89
 2 2011    106
 3 2012    118
 4 2013    117
 5 2014    129
 6 2015    133
 7 2016    414
 8 2017    167
 9 2018    172
10 2019    183</code></pre>
</div>
<p>Lot’s of missingness in <code>Emp.JobSecure</code> and the question was not included in 2016</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>table1</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/table1/man/table1.html'>table1</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>Wave</span><span class='op'>|</span><span class='va'>Emp.JobSecure</span>, data <span class='op'>=</span> <span class='va'>df</span>, overall <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>1<br><span class='stratn'>(N=90)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>2<br><span class='stratn'>(N=96)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>3<br><span class='stratn'>(N=139)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>4<br><span class='stratn'>(N=268)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>5<br><span class='stratn'>(N=403)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>6<br><span class='stratn'>(N=731)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>7<br><span class='stratn'>(N=785)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>Wave</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>2010</td>
<td>12 (13.3%)</td>
<td>12 (12.5%)</td>
<td>18 (12.9%)</td>
<td>31 (11.6%)</td>
<td>68 (16.9%)</td>
<td>90 (12.3%)</td>
<td>94 (12.0%)</td>
</tr>
<tr>
<td class='rowlabel'>2011</td>
<td>16 (17.8%)</td>
<td>14 (14.6%)</td>
<td>15 (10.8%)</td>
<td>45 (16.8%)</td>
<td>43 (10.7%)</td>
<td>84 (11.5%)</td>
<td>91 (11.6%)</td>
</tr>
<tr>
<td class='rowlabel'>2012</td>
<td>11 (12.2%)</td>
<td>10 (10.4%)</td>
<td>17 (12.2%)</td>
<td>41 (15.3%)</td>
<td>43 (10.7%)</td>
<td>86 (11.8%)</td>
<td>88 (11.2%)</td>
</tr>
<tr>
<td class='rowlabel'>2013</td>
<td>11 (12.2%)</td>
<td>11 (11.5%)</td>
<td>17 (12.2%)</td>
<td>35 (13.1%)</td>
<td>44 (10.9%)</td>
<td>90 (12.3%)</td>
<td>89 (11.3%)</td>
</tr>
<tr>
<td class='rowlabel'>2014</td>
<td>10 (11.1%)</td>
<td>10 (10.4%)</td>
<td>16 (11.5%)</td>
<td>28 (10.4%)</td>
<td>40 (9.9%)</td>
<td>91 (12.4%)</td>
<td>90 (11.5%)</td>
</tr>
<tr>
<td class='rowlabel'>2015</td>
<td>5 (5.6%)</td>
<td>10 (10.4%)</td>
<td>18 (12.9%)</td>
<td>27 (10.1%)</td>
<td>46 (11.4%)</td>
<td>78 (10.7%)</td>
<td>97 (12.4%)</td>
</tr>
<tr>
<td class='rowlabel'>2016</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr>
<td class='rowlabel'>2017</td>
<td>7 (7.8%)</td>
<td>9 (9.4%)</td>
<td>12 (8.6%)</td>
<td>21 (7.8%)</td>
<td>46 (11.4%)</td>
<td>71 (9.7%)</td>
<td>81 (10.3%)</td>
</tr>
<tr>
<td class='rowlabel'>2018</td>
<td>8 (8.9%)</td>
<td>12 (12.5%)</td>
<td>13 (9.4%)</td>
<td>23 (8.6%)</td>
<td>35 (8.7%)</td>
<td>73 (10.0%)</td>
<td>78 (9.9%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>2019</td>
<td class='lastrow'>10 (11.1%)</td>
<td class='lastrow'>8 (8.3%)</td>
<td class='lastrow'>13 (9.4%)</td>
<td class='lastrow'>17 (6.3%)</td>
<td class='lastrow'>38 (9.4%)</td>
<td class='lastrow'>68 (9.3%)</td>
<td class='lastrow'>77 (9.8%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There are various methods for multiple imputation. First, let’s look at the Amelia package</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://gking.harvard.edu/amelia'>Amelia</a></span><span class='op'>)</span>
<span class='co'># set seed</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>

<span class='co'># we need to pass a data frame to Amelia</span>
<span class='va'>prep</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='co'># tibble won't run in amelia !!</span>


<span class='co'># this is the key code</span>
<span class='va'>prep2</span> <span class='op'>&lt;-</span> <span class='fu'>Amelia</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Amelia/man/amelia.html'>amelia</a></span><span class='op'>(</span>
  <span class='va'>prep</span>,
  <span class='co'>#dataset to impute</span>
  m <span class='op'>=</span> <span class='fl'>10</span>,
  <span class='co'># number of imputations</span>
  cs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Id"</span><span class='op'>)</span>,
  <span class='co'># the cross sectional variable</span>
  ts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"yearS"</span><span class='op'>)</span>,
  <span class='co'># Time series, allowing polynomials</span>
  <span class='co'>#ords =  none in this dataset, but use this command for ordinal data</span>
  <span class='co'>#logs = ,  # big numbers better to use the natural log</span>
  sqrt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"KESSLER6sum"</span>, <span class='st'>"CharityDonate"</span><span class='op'>)</span>,
  <span class='co'># skewed positive data such as K6</span>
  noms <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Male"</span>,  <span class='co'># nominal vars</span>
           <span class='st'>"Employed"</span>,
           <span class='st'>"Partner"</span><span class='op'>)</span>,
  idvars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Wave"</span><span class='op'>)</span>,
  <span class='co'># not imputing outcomes</span>
  polytime <span class='op'>=</span> <span class='fl'>3</span>
<span class='op'>)</span> <span class='co'>#https://stackoverflow.com/questions/56218702/missing-data-warning-r</span>
</code></pre>
</div>
<pre><code>-- Imputation 1 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76

-- Imputation 2 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59

-- Imputation 3 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80
 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100
 101 102 103 104 105

-- Imputation 4 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80
 81 82 83 84 85 86 87 88 89

-- Imputation 5 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52

-- Imputation 6 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68

-- Imputation 7 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71

-- Imputation 8 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71

-- Imputation 9 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19

-- Imputation 10 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">

<span class='co'># Impute again but do not impute the outcome</span>


<span class='co'># this is the key code</span>
<span class='va'>prep2.1</span> <span class='op'>&lt;-</span> <span class='fu'>Amelia</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Amelia/man/amelia.html'>amelia</a></span><span class='op'>(</span>
  <span class='va'>prep</span>,
  <span class='co'>#dataset to impute</span>
  m <span class='op'>=</span> <span class='fl'>10</span>,
  <span class='co'># number of imputations</span>
  cs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Id"</span><span class='op'>)</span>,
  <span class='co'># the cross sectional variable</span>
  ts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"yearS"</span><span class='op'>)</span>,
  <span class='co'># Time series, allowing polynomials</span>
  <span class='co'>#ords =  none in this dataset, but use this command for ordinal data</span>
  <span class='co'>#logs = ,  # big numbers better to use the natural log</span>
  sqrt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"KESSLER6sum"</span><span class='op'>)</span>,
  <span class='co'># skewed positive data such as K6</span>
  noms <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Male"</span>,  <span class='co'># nominal vars</span>
           <span class='st'>"Employed"</span>,
           <span class='st'>"Partner"</span><span class='op'>)</span>,
  idvars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Wave"</span>,<span class='st'>"CharityDonate"</span><span class='op'>)</span>, <span class='co'># We do not impute the outcome this time</span>
  <span class='co'># not imputing outcomes</span>
  polytime <span class='op'>=</span> <span class='fl'>3</span>
<span class='op'>)</span> <span class='co'>#https://stackoverflow.com/questions/56218702/missing-data-warning-r</span>
</code></pre>
</div>
<pre><code>-- Imputation 1 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80
 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95

-- Imputation 2 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22

-- Imputation 3 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46

-- Imputation 4 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77

-- Imputation 5 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71

-- Imputation 6 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78

-- Imputation 7 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74

-- Imputation 8 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80
 81 82 83 84

-- Imputation 9 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78

-- Imputation 10 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53</code></pre>
</div>
<p>We can center and scale our variables using the following code head(df)</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='co'># prepare data with imputed outcome</span>
<span class='va'>prep3</span> <span class='op'>&lt;-</span> <span class='fu'>Amelia</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Amelia/man/transform.amelia.html'>transform.amelia</a></span><span class='op'>(</span>
  <span class='va'>prep2</span>,
  Id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Id</span><span class='op'>)</span>,
  <span class='co'># redundant</span>
  Age.10yrs <span class='op'>=</span> <span class='op'>(</span><span class='va'>Age</span> <span class='op'>/</span> <span class='fl'>10</span><span class='op'>)</span>,
  years_s <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>yearS</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  years <span class='op'>=</span> <span class='va'>yearS</span>,
  KESSLER6sum_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>KESSLER6sum</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>,
  Employed <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Employed</span><span class='op'>)</span>,
  Relid <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Relid</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  Male <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Male</span><span class='op'>)</span>,
  Emp.JobSecure_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Emp.JobSecure</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
  CharityDonate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>CharityDonate</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># center an d scale age</span>
<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>Amelia</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Amelia/man/transform.amelia.html'>transform.amelia</a></span><span class='op'>(</span><span class='va'>prep3</span>, Age_in_Decades_C <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Age.10yrs</span>,scale <span class='op'>=</span><span class='cn'>FALSE</span>, center<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>prep3.1</span> <span class='op'>&lt;-</span> <span class='fu'>Amelia</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Amelia/man/transform.amelia.html'>transform.amelia</a></span><span class='op'>(</span>
  <span class='va'>prep2.1</span>,
  Id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Id</span><span class='op'>)</span>,
  <span class='co'># redundant</span>
  Age.10yrs <span class='op'>=</span> <span class='op'>(</span><span class='va'>Age</span> <span class='op'>/</span> <span class='fl'>10</span><span class='op'>)</span>,
  years_s <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>yearS</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  years <span class='op'>=</span> <span class='va'>yearS</span>,
  KESSLER6sum_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>KESSLER6sum</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>,
  Employed <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Employed</span><span class='op'>)</span>,
  Relid <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Relid</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  Male <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Male</span><span class='op'>)</span>,
  Emp.JobSecure_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Emp.JobSecure</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
  CharityDonate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>CharityDonate</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># center an d scale age</span>
<span class='va'>out.1</span> <span class='op'>&lt;-</span> <span class='fu'>Amelia</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Amelia/man/transform.amelia.html'>transform.amelia</a></span><span class='op'>(</span><span class='va'>prep3.1</span>, Age_in_Decades_C <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Age.10yrs</span>,scale <span class='op'>=</span><span class='cn'>FALSE</span>, center<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We can use trace plots to examine how Amelia imputed and with how much uncertainty:</p>
<p>Here are the imputations for Job Security (a random selection)</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='fu'>Amelia</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Amelia/man/tscsPlot.html'>tscsPlot</a></span><span class='op'>(</span>
  <span class='va'>prep2</span>,
  cs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"15"</span>, <span class='st'>"19"</span>, <span class='st'>"20"</span>, <span class='st'>"39"</span>, <span class='st'>"549"</span>, <span class='st'>"861"</span>,<span class='st'>"1037"</span>,<span class='st'>"1078"</span>,<span class='st'>"1253"</span><span class='op'>)</span>,
  main <span class='op'>=</span> <span class='st'>"Imputation of Job security"</span>,
  var <span class='op'>=</span> <span class='st'>"Emp.JobSecure"</span>,
  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>30</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/amelia_trace_3-1.png" width="1152" /></p>
</div>
<p>Here are the imputations for Charity (another random selection). Note that there is a fair amount of uncertainty here:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>Amelia</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Amelia/man/tscsPlot.html'>tscsPlot</a></span><span class='op'>(</span>
  <span class='va'>prep2</span>,
  cs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"394"</span>, <span class='st'>"1039"</span>, <span class='st'>"1082"</span>,  <span class='st'>"1149"</span>, <span class='st'>"1238"</span> , <span class='st'>"1253"</span>, <span class='st'>"1229"</span>,<span class='st'>"15"</span>, <span class='st'>"19"</span>, <span class='st'>"20"</span>,<span class='st'>"1037"</span>,<span class='st'>"1078"</span><span class='op'>)</span>,
  main <span class='op'>=</span> <span class='st'>"Impuatation of Charity"</span>,
  var <span class='op'>=</span> <span class='st'>"CharityDonate"</span>,
  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10000</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/amelia_trace2-1.png" width="1152" /></p>
</div>
<p>Which variables do we need to include to estimate the causal effect of job security on charity?</p>
<p>Write your dag!</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/malcolmbarrett/ggdag'>ggdag</a></span><span class='op'>)</span>
<span class='va'>dg</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/dagify.html'>dagify</a></span><span class='op'>(</span>
    <span class='va'>charity</span> <span class='op'>~</span> <span class='va'>jobsecure</span> <span class='op'>+</span> <span class='va'>employed</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>male</span> <span class='op'>+</span> <span class='va'>relid</span> <span class='op'>+</span> <span class='va'>years</span> <span class='op'>+</span> <span class='va'>polconserve</span>,
    <span class='va'>jobsecure</span> <span class='op'>~</span> <span class='va'>employed</span> <span class='op'>+</span> <span class='va'>distress</span> <span class='op'>+</span> <span class='va'>male</span> <span class='op'>+</span> <span class='va'>years</span> <span class='op'>+</span> <span class='va'>age</span>,
    <span class='va'>distress</span> <span class='op'>~</span> <span class='va'>male</span>  <span class='op'>+</span> <span class='va'>employed</span> <span class='op'>+</span> <span class='va'>years</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>partner</span>,
    <span class='va'>relid</span> <span class='op'>~</span> <span class='va'>male</span> <span class='op'>+</span> <span class='va'>years</span>,
    <span class='va'>age</span> <span class='op'>~</span> <span class='va'>years</span>,
    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
      <span class='st'>"charity"</span> <span class='op'>=</span> <span class='st'>"charity"</span>,
      <span class='st'>"jobsecure"</span> <span class='op'>=</span> <span class='st'>"job security"</span>,
      <span class='st'>"employed"</span> <span class='op'>=</span> <span class='st'>"employed"</span>,
      <span class='st'>"polconserve"</span>  <span class='op'>=</span> <span class='st'>"political conservative"</span>,
      <span class='st'>"partner"</span> <span class='op'>=</span> <span class='st'>"partner"</span>,
      <span class='st'>"age"</span> <span class='op'>=</span> <span class='st'>"age"</span>,
      <span class='st'>"male"</span> <span class='op'>=</span> <span class='st'>"male"</span>,
      <span class='st'>"relid"</span> <span class='op'>=</span> <span class='st'>"religious identity"</span>,
      <span class='st'>"years"</span> <span class='op'>=</span> <span class='st'>"years"</span>
    <span class='op'>)</span>,
    exposure <span class='op'>=</span> <span class='st'>"jobsecure"</span>,
    outcome <span class='op'>=</span> <span class='st'>"charity"</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/tidy_dagitty.html'>tidy_dagitty</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>"nicely"</span><span class='op'>)</span>

<span class='fu'>ggdag</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/adjustment_sets.html'>ggdag_adjustment_set</a></span><span class='op'>(</span><span class='va'>dg</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggdag/man/theme_dag_blank.html'>theme_dag_blank</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/dag-1.png" width="1152" /></p>
</div>
<p>To obtain an unbiased estimate of jobsecurity on charity we must condition on employed, male, age, and years.</p>
<p>We can write the model using the <code>lme4</code> package, which is fast. I wrote a little function, recall that we have 8 data sets</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># first write out the model equation</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/lme4/lme4/'>lme4</a></span><span class='op'>)</span>
<span class='va'>mod_eq</span> <span class='op'>&lt;-</span>  <span class='st'>'CharityDonate  ~  Emp.JobSecure_S  + Employed + Age_in_Decades_C +  Male  +  years_s +  (1|Id)'</span> 

<span class='co'># run models iterating over imputed data</span>
<span class='va'>loop_glmer_model</span> <span class='op'>&lt;-</span>
  <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='co'># x is the mod equation, y is the data</span>
    <span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
    <span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
    <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>m</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>mod</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/glmer.html'>glmer</a></span><span class='op'>(</span><span class='va'>x</span>, data <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>imputations</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>, family <span class='op'>=</span> <span class='st'>"poisson"</span><span class='op'>)</span>
    <span class='op'>}</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
  <span class='op'>}</span>

<span class='va'>m_list</span> <span class='op'>&lt;-</span> <span class='fu'>loop_glmer_model</span><span class='op'>(</span><span class='va'>mod_eq</span>, <span class='va'>out</span><span class='op'>)</span>

<span class='co'># try with out the outcome imputed</span>

<span class='va'>m_list1</span> <span class='op'>&lt;-</span> <span class='fu'>loop_glmer_model</span><span class='op'>(</span><span class='va'>mod_eq</span>, <span class='va'>out.1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Here is a function for obtaining the results:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># table of effects</span>
<span class='va'>loop_lmer_model_tab</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>mp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>model_parameters</span><span class='op'>)</span>
  <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/pool_parameters.html'>pool_parameters</a></span><span class='op'>(</span><span class='va'>mp</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># create table</span>
<span class='va'>tab_impute</span> <span class='op'>&lt;-</span> <span class='fu'>loop_lmer_model_tab</span><span class='op'>(</span><span class='va'>m_list</span><span class='op'>)</span>
<span class='va'>tab_impute</span>
</code></pre>
</div>
<pre><code># Fixed Effects

Parameter         | Coefficient |   SE |         95% CI | Statistic |      p
----------------------------------------------------------------------------
(Intercept)       |        6.34 | 0.59 | [ 5.18,  7.50] |     10.72 | &lt; .001
Emp.JobSecure_S   |        0.01 | 0.03 | [-0.05,  0.07] |      0.41 | 0.678 
Employed [1]      |        0.15 | 0.02 | [ 0.10,  0.20] |      5.95 | &lt; .001
Age_in_Decades_C  |       -4.79 | 1.29 | [-7.31, -2.26] |     -3.72 | &lt; .001
Male [Not_Male]   |       -1.48 | 0.80 | [-3.04,  0.08] |     -1.86 | 0.063 
years_s           |        1.38 | 0.38 | [ 0.63,  2.12] |      3.63 | &lt; .001
SD (Intercept)    |        6.79 |      |                |           |       
SD (Observations) |        1.00 |      |                |           |       </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='co'># create graph</span>
<span class='va'>plot_impute</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tab_impute</span><span class='op'>)</span>
<span class='va'>plot_impute</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/table_impute-1.png" width="1152" /></p>
</div>
<p>We can plot the predictions:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/ggeffects/'>ggeffects</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yutannihilation/gghighlight/'>gghighlight</a></span><span class='op'>)</span> <span class='co'># not used here, useful for interactions </span>
<span class='va'>graph_predictions_imputed</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># x = model objects</span>
  <span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
  <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>m</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>out</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span>
      <span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>, terms <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Emp.JobSecure_S"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>plots</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>m</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>plots</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span>
      <span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>, facets <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='co'># + scale_y_continuous(limits=c(6.35,6.85) )</span>
  <span class='op'>}</span>
  <span class='va'>plots</span><span class='op'>[[</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span>
    <span class='fu'>gghighlight</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/gghighlight/man/gghighlight.html'>gghighlight</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>ggtitle</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># graph</span>
<span class='fu'>graph_predictions_imputed</span><span class='op'>(</span><span class='va'>m_list</span>,<span class='st'>"Prediction of jobsecurity on charity (not reliable"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/graph_impute-1.png" width="1152" /></p>
</div>
<p>What if we do not impute the outcome? Does that make a difference? Not much:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>loop_lmer_model_tab</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>mp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>model_parameters</span><span class='op'>)</span>
  <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/pool_parameters.html'>pool_parameters</a></span><span class='op'>(</span><span class='va'>mp</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># create table</span>
<span class='va'>tab_impute1</span> <span class='op'>&lt;-</span> <span class='fu'>loop_lmer_model_tab</span><span class='op'>(</span><span class='va'>m_list1</span><span class='op'>)</span>
<span class='va'>tab_impute1</span>
</code></pre>
</div>
<pre><code># Fixed Effects

Parameter         | Coefficient |   SE |         95% CI | Statistic |      p
----------------------------------------------------------------------------
(Intercept)       |        6.04 | 0.47 | [ 5.12,  6.97] |     12.84 | &lt; .001
Emp.JobSecure_S   |        0.02 | 0.04 | [-0.06,  0.10] |      0.48 | 0.629 
Employed [1]      |        0.11 | 0.03 | [ 0.06,  0.17] |      3.86 | &lt; .001
Age_in_Decades_C  |       -4.58 | 0.38 | [-5.34, -3.83] |    -11.92 | &lt; .001
Male [Not_Male]   |       -1.50 | 0.59 | [-2.65, -0.35] |     -2.55 | 0.011 
years_s           |        1.29 | 0.11 | [ 1.08,  1.50] |     12.10 | &lt; .001
SD (Intercept)    |        6.65 |      |                |           |       
SD (Observations) |        1.00 |      |                |           |       </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='co'># create graph</span>
<span class='va'>plot_impute1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>tab_impute1</span><span class='op'>)</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>

<span class='va'>plot_impute</span> <span class='op'>/</span> <span class='va'>plot_impute1</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"(a) Multiply imputed outcome vs (b) No-multiple imputation for the outcome"</span>, tag_levels <span class='op'>=</span> <span class='st'>"a"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/loop_lmer_function-1.png" width="1152" /></p>
</div>
<p>If you want a LaTeX table, you can use this code:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://hughjonesd.github.io/huxtable/'>huxtable</a></span><span class='op'>)</span>

<span class='fu'>huxtable</span><span class='fu'>::</span><span class='fu'><a href='https://hughjonesd.github.io/huxtable/reference/as_huxtable.html'>as_hux</a></span><span class='op'>(</span> <span class='va'>your_model_here</span> <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='st'>"Parameter"</span>, <span class='st'>"Coefficient"</span>, <span class='st'>"CI_low"</span>, <span class='st'>"CI_high"</span>, <span class='st'>"p"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://hughjonesd.github.io/huxtable/reference/number_format.html'>set_number_format</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://hughjonesd.github.io/huxtable/reference/padding.html'>set_left_padding</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://hughjonesd.github.io/huxtable/reference/bold.html'>set_bold</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>everywhere</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://hughjonesd.github.io/huxtable/reference/quick-output.html'>quick_latex</a></span><span class='op'>(</span><span class='op'>)</span>

</code></pre>
</div>
</div>
<h3 id="compare-multiple-imputation-results-with-row-wise-deleted-results">Compare multiple imputation results with row-wise deleted results</h3>
<p>When you run a regression with missing data, R automatically deletes the missing cases.</p>
<p>Let’s look at the results from the row-wise deleted data:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># prepare data as we did for the imputed dataset</span>

<span class='va'>df2</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    Age.10yrs <span class='op'>=</span> <span class='op'>(</span><span class='va'>Age</span> <span class='op'>/</span> <span class='fl'>10</span><span class='op'>)</span>,
    Age_in_Decades_C <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Age.10yrs</span>, scale <span class='op'>=</span> <span class='cn'>FALSE</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    years_s <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>yearS</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    years <span class='op'>=</span> <span class='va'>yearS</span>,
    KESSLER6sum_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>KESSLER6sum</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    Employed <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Employed</span><span class='op'>)</span>,
    Relid <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Relid</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    Male <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Male</span><span class='op'>)</span>,
    Emp.JobSecure_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Emp.JobSecure</span>, center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># run the row-wise deletion model</span>
<span class='va'>m_no_impute</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/glmer.html'>glmer</a></span><span class='op'>(</span><span class='va'>mod_eq</span>, data <span class='op'>=</span> <span class='va'>df2</span>, family <span class='op'>=</span> <span class='st'>"poisson"</span><span class='op'>)</span>

<span class='co'># create table</span>
<span class='va'>tab_no</span> <span class='op'>&lt;-</span>
  <span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>m_no_impute</span>, effects <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"all"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>tab_no</span>
</code></pre>
</div>
<pre><code># Fixed Effects

Parameter        |  Log-Mean |       SE |         95% CI |      z |      p
--------------------------------------------------------------------------
(Intercept)      |      5.26 |     0.08 | [ 5.09,  5.42] |  62.00 | &lt; .001
Emp.JobSecure_S  | -5.65e-03 | 5.87e-04 | [-0.01,  0.00] |  -9.61 | &lt; .001
Employed [1]     |      0.19 | 6.46e-03 | [ 0.18,  0.20] |  29.18 | &lt; .001
Age_in_Decades_C |     -0.89 |     0.04 | [-0.96, -0.81] | -21.86 | &lt; .001
Male [Not_Male]  |     -0.64 |     0.11 | [-0.86, -0.43] |  -5.79 | &lt; .001
years_s          |      0.18 |     0.01 | [ 0.16,  0.21] |  15.41 | &lt; .001

# Random Effects

Parameter          | Coefficient
--------------------------------
SD (Intercept: Id) |        1.00
SD (Residual)      |        1.00</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='co'># create graph</span>
<span class='va'>plot_no</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>tab_no</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>

<span class='co'># compare models graphically</span>
<span class='va'>plot_impute</span> <span class='op'>/</span> <span class='va'>plot_no</span> <span class='op'>+</span>
  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Comparison of regressions using (a) multiple-imputed  and (b) row-wise deleted datasets"</span>, tag_levels <span class='op'>=</span> <span class='st'>'a'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_12_files/figure-html5/comparison_graph-1.png" width="1152" /></p>
</div>
<p>When we compare the graphs, we see that the multiply imputed datasets shrink estimates towards zero.</p>
<p>Multiple imputation is sometimes avoided because people don’t like to “invent” data. However, creating multiply imputed datasets and integrating over their uncertainty during model tends to increase uncertainty in a model. That’s generally a good thing when we want to predict features of the population.</p>
<p>However it would be a mistake to think that multiple imputation is sufficient. Missingness might not have been completely at random conditional on variables in your model. In this case, your multiple imputation cannot help your dataset to avoid bias.</p>
<h2 id="faq-for-multiple-imputation">FAQ for Multiple Imputation</h2>
<p>Q: Is multiple imputation inventing data? MI is educated guesswork about the population from which your data are drawn. It is no different from ordinary statistical inference.</p>
<p>Q: Do I need to multiple-impute missing values? A: If your data satisfies the assumptions of MAR, you should multiply impute missing values. However, in many cases it makes no practical difference. Whether MI makes a difference is something you can’t know in advance of trying, so to be safe, you should use MI.</p>
<p>Q: How many missing datasets should I impute? A: The documentation to Amelia suggests n = 5 datasets is sufficient. Here we used 10.</p>
<p>Q: How do I handle time series data? A: Here we have used the <code>cs</code> and <code>ts</code> commands in the <code>Amelia</code> package</p>
<p>Q: Can I use multiple imputation with Bayesian estimation packages. A: Yes, see me.</p>
<p>Q: Where can I go for help? A: See the resources provided at the introduction to this section.</p>
<h2 id="course-wrap-up-21-skills-youve-acquired">Course wrap up: 21 skills you’ve acquired</h2>
<p>You’ve come very far in only twelve weeks. Among other things, you have acquired the following skills:</p>
<ol type="1">
<li>You can use Rstudio, GitHub, and R-markdown to do data-science.</li>
<li>You can get your data-into shape through data-wrangling in R.</li>
<li>You can create publication-ready descriptive graphs and tables for your samples.</li>
<li>You can do the same for your regression models.</li>
<li>You can search for anomalies in your samples and in your regression outputs.</li>
<li>You can compare model fits.</li>
<li>You can select family distributions that are appropriate for your data.</li>
<li>You can model ordinal predictors and ordinal outcomes.</li>
<li>You can model outcomes that have an abundance of zeros 10 You an write non-linear models.</li>
<li>You can simulate data.</li>
<li>You can perform ANOVA, ANOVCA, and MANOVA in a regression setting.</li>
<li>You can perform model checks.</li>
<li>You can write multilevel models and interpret them.</li>
<li>You understand meta-analysis as a form of multi-level modelling.</li>
<li>You understand the difference between regression for prediction and regression for inference.</li>
<li>You understand how to reduce the dimensions of your data.</li>
<li>You understand how to check for confounding by writing a DAG.</li>
<li>You can create a distill website for free on GitHub.</li>
<li>You’ve learned about measurement reliability and measurement validity, and you understand how to reduce highly dimensional data.</li>
<li>You can multiply impute datasets to handle missing data, and you understand why this is a good thing.</li>
<li>Most of all we hope you’ve learned how to continue learning: this is the most important skill for data science.</li>
</ol>
<!-- ### Appendix 1: Imputation using BRMS -->
<!-- ### Multiple imputation in BRMS (warning: these models take 10x longer) -->
<!-- ```{r prepare_bayesian_dataset} -->
<!-- # prepare data -->
<!-- # you must create a list of the imputed datasets, like so: -->
<!-- brmdat <- list( -->
<!--   out$imputations$imp1, -->
<!--   out$imputations$imp2, -->
<!--   out$imputations$imp3, -->
<!--   out$imputations$imp4, -->
<!--   out$imputations$imp5, -->
<!--   out$imputations$imp6, -->
<!--   out$imputations$imp7, -->
<!--   out$imputations$imp8, -->
<!--   out$imputations$imp9, -->
<!--   out$imputations$imp10 -->
<!-- ) -->
<!-- brmdat1 <- list( -->
<!--   out.1$imputations$imp1, -->
<!--   out.1$imputations$imp2, -->
<!--   out.1$imputations$imp3, -->
<!--   out.1$imputations$imp4, -->
<!--   out.1$imputations$imp5, -->
<!--   out.1$imputations$imp6, -->
<!--   out.1$imputations$imp7, -->
<!--   out.1$imputations$imp8, -->
<!--   out.1$imputations$imp9, -->
<!--   out.1$imputations$imp10 -->
<!-- ) -->
<!-- ``` -->
<!-- We write the model as follows: -->
<!-- ```{r Bayesian_impuation_model} -->
<!-- # model equation -->
<!-- # note the `bf` command -->
<!-- bf_mod_eq <- bf(mod_eq) -->
<!-- # we use the `brm_multiple` syntax and feed in the brmdat -->
<!-- fit_imp1 <- -->
<!--   brm_multiple( -->
<!--     bf_mod_eq, -->
<!--     data = brmdat, -->
<!--     family = "poisson", -->
<!--     file = here::here("models", "bayes-imp-1") -->
<!--   ) -->
<!-- # table -->
<!-- summary(fit_imp1) -->
<!-- plot(fit_imp1)  # VERY POOR MIXING -->
<!-- ``` -->
<!-- Mixing is a problem, indeed I don't think I have ever run a model that has mixed worse than this one.  -->
<!-- We see the trouble in the coefficient plots: -->
<!-- ```{r bayes-1-plot} -->
<!-- #plot posteriors -->
<!-- plot_bayes_1 <- brms::mcmc_plot(fit_imp1, -->
<!--                                 type = "areas", -->
<!--                                 prob = .89) -->
<!-- plot_bayes_1 + -->
<!--   plot_impute + -->
<!--   plot_annotation(title = "Comparison of regressions using  (a) Bayesian Imputationand and (b) Lmer models", -->
<!--                   tag_levels = 'a') -->
<!-- ``` -->
<!-- We can model missing-ness in BRMS in one step (for continuous missing variables). Let's try that next: -->
<!-- ```{r one-step-brms-impute-22} -->
<!-- # Emp.JobSecure_S  + Employed + Age_in_Decades_C +  Male  +  years_s -->
<!-- #Note that BRMS can only impute continuous data. That's not a problem. Your factors are converted to integars anyway. -->
<!-- df3 <- df2%>% -->
<!--   dplyr::mutate(Employed = as.numeric(as.character(Employed)), -->
<!--          Male = as.numeric((Male))-1) # male as zero or 1 -->
<!-- glimpse(df3) -->
<!-- df3%>% -->
<!--   dplyr::count(CharityDonate ==0) -->
<!-- ## Write the model, note the `mi`s: each `mi` needs to appear as the outcome of a model.  -->
<!-- ## note that for simplicity, these models claim that mi is random conditional on year and individual. We might obtain better predictions of missingness by including more information.  -->
<!-- # Note that brms can only take identity link functions when handling missing data. The "lognormal" is better than the normal because the variances are estimated using a log link.  -->
<!-- bform <-  -->
<!--   bf(CharityDonate + 1 | mi() ~ mi(Emp.JobSecure_S) + mi(Employed) + mi(Age_in_Decades_C)  + mi(Male)  + (1 + years_s | Id), family = "lognormal") + -->
<!--   bf(Emp.JobSecure_S | mi() ~ mi(Employed) + mi(Age_in_Decades_C)  + mi(Male)  + (1 + years_s| Id)) + -->
<!--   bf(Employed | mi() ~ (1 + years_s| Id)) + -->
<!--   bf(Age_in_Decades_C | mi() ~  (1 + years_s| Id))+ -->
<!--   bf(Male | mi() ~ (1 + years_s | Id)) + -->
<!--   set_rescor(FALSE) -->
<!-- ## fit the model  -->
<!-- fit_imp2 <- brm(bform,  -->
<!--                 data = df3,  -->
<!--                 file = here::here("models", "bayes-imp-2")) -->
<!-- summary(fit_imp2) -->
<!-- ``` -->
<!-- Again, the model is a all over the place: -->
<!-- ```{r} -->
<!-- plot(fit_imp2) -->
<!-- ``` -->
<!-- Mixing was a problem. Minimally we'd need to include more variables. However there might be deeper problems with the data, or our approach.  Analysis is iterative. We need to return to the data and scrutinise it more carefully.  -->
<!-- ```{r one-step-brms-impute} -->
<!-- plot_bayes_2 <- brms::mcmc_plot(fit_imp2, -->
<!--                                 type = "areas", -->
<!--                                 prob = .89) -->
<!-- plot_bayes_2 -->
<!-- # again we run into trouble.  -->
<!-- plot(fit_imp2) -->
<!-- ``` -->
<!-- ## Try without imputing outcome and allow for overdispersion -->
<!-- ```{r} -->
<!-- fit_imp3 <- -->
<!--   brm_multiple( -->
<!--     bf_mod_eq, -->
<!--     data = brmdat1, -->
<!--     family = "zero_inflated_negbinomial", -->
<!--     file = here::here("models", "bayes-imp-3") -->
<!--   ) -->
<!-- # table -->
<!-- summary(fit_imp3) -->
<!-- plot(fit_imp3)   -->
<!-- ``` -->
<!-- ### Appendix 2. Probability -->
<!-- We have been working with probability throughout this course. -->
<!-- Suppose there is a test that is 99% accurate at detecting COVID if you have it. -->
<!-- Very rarely it throws up a false positive,say one in a thousand. -->
<!-- You just tested positive. What is the probability that you have COVID? Our intuition is that we probably have COVID. However, let's assume COVID is rare. Currently in NZ, there are about 50 cases, so 1 in 100,000. The background rate matters. -->
<!-- Bayes rule says -->
<!-- $$ Pr(COVID|Positive) = \frac{Pr(Positive|COVID)\times Pr (COVID}{Pr(Positive)} -->
<!-- $$ -->
<!-- We plug in the numbers: -->
<!-- ```{r} -->
<!-- Pr_Positive_COVID <- 0.99 -->
<!-- Pr_Positive_Healthy <- 0.01 -->
<!-- Pr_COVID <- 0.00001 -->
<!-- # Calculate the background probability of testing positive -->
<!-- Pr_Positive <- Pr_Positive_COVID * Pr_COVID + Pr_Positive_Healthy * ( 1 - Pr_COVID ) -->
<!-- # Now calculated your probability of testing positive -->
<!-- Pr_COVID_Positive <- Pr_Positive_COVID * Pr_COVID / (Pr_Positive ) -->
<!-- Pr_COVID_Positive # 1 in 1000 -->
<!-- ``` -->
<!-- library(tidyverse) -->
<!-- # column of n randomly sampled responses -->
<!-- likert_col <- function(n = 10) { -->
<!--   sample(7, size = 10, replace = TRUE) -->
<!-- } -->
<!-- # toy data -->
<!-- dat <- tibble( -->
<!--   cat_1 = likert_col(), -->
<!--   cat_2 = likert_col(), -->
<!--   cat_3 = likert_col(), -->
<!--   dog_1 = likert_col(), -->
<!--   dog_2 = likert_col() -->
<!-- ) -->
<!-- dat %>% transmute(cat = rowSums(across(starts_with("cat"))), dog = rowSums(across(starts_with("dog")))) -->
<div class="sourceCode" id="cb13"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-bhaskaran2014" class="csl-entry" role="doc-biblioentry">
Bhaskaran, Krishnan, and Liam Smeeth. 2014. <span>“What Is the Difference Between Missing Completely at Random and Missing at Random?”</span> <em>International Journal of Epidemiology</em> 43 (4): 1336–39. <a href="https://doi.org/10.1093/ije/dyu080">https://doi.org/10.1093/ije/dyu080</a>.
</div>
<div id="ref-blackwell2017" class="csl-entry" role="doc-biblioentry">
Blackwell, Matthew, James Honaker, and Gary King. 2017. <span>“A Unified Approach to Measurement Error and Missing Data: Overview and Applications.”</span> <em>Sociological Methods and Research</em> 46 (3): 303–41. <a href="http://journals.sagepub.com/doi/full/10.1177/0049124115585360">http://journals.sagepub.com/doi/full/10.1177/0049124115585360</a>.
</div>
<div id="ref-gelman2006" class="csl-entry" role="doc-biblioentry">
Gelman, Andrew, and Jennifer Hill. 2006. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Cambridge university press.
</div>
<div id="ref-honaker2011" class="csl-entry" role="doc-biblioentry">
Honaker, James, Gary King, and Matthew Blackwell. 2011. <span>“Amelia II: A Program for Missing Data.”</span> <em>Journal of Statistical Software</em> 45 (7): 1–47. <a href="http://www.jstatsoft.org/v45/i07/">http://www.jstatsoft.org/v45/i07/</a>.
</div>
<div id="ref-Lance2006" class="csl-entry" role="doc-biblioentry">
Lance, C. E., Marcus M. Butts, and Lawrence C. Michels. 2006. <span>“<span class="nocase">The Sources of Four Commonly Reported Cutoff Criteria: What Did They Really Say?</span>”</span> <em>Organizational Research Methods</em> 9 (2): 202–20. <a href="https://doi.org/10.1177/1094428105284919">https://doi.org/10.1177/1094428105284919</a>.
</div>
<div id="ref-mcelreath2020" class="csl-entry" role="doc-biblioentry">
McElreath, Richard. 2020. <em>Statistical Rethinking: A Bayesian Course with Examples in r and Stan</em>. CRC press.
</div>
<div id="ref-McNeish2018" class="csl-entry" role="doc-biblioentry">
McNeish, Daniel. 2018. <span>“<span class="nocase">Thanks coefficient alpha, we’ll take it from here.</span>”</span> <em>Psychological Methods</em> 23 (3): 412–33. <a href="https://doi.org/10.1037/met0000144">https://doi.org/10.1037/met0000144</a>.
</div>
<div id="ref-Nunnally1994" class="csl-entry" role="doc-biblioentry">
Nunnally, J. C., and I. H. Bernstein. 1994. <span>“<span class="nocase">The Assessment of Reliability.</span>”</span> In <em>Psychometric Theory</em>, 3rd ed., 248–92.
</div>
<div id="ref-Raykov2017" class="csl-entry" role="doc-biblioentry">
Raykov, Tenko, and George A. Marcoulides. 2017. <span>“<span>Thanks Coefficient Alpha, We Still Need You!</span>”</span> <em>Educational and Psychological Measurement</em>, August, 001316441772512. <a href="https://doi.org/10.1177/0013164417725127">https://doi.org/10.1177/0013164417725127</a>.
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Statisticians call the assumption of of conditional randomness in missingness: “MAR: Missing at Random.” The language is admittedly confusing – what statisticians mean is “missing conditional on known predictors.”<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Although it generally does no harm to include collinear indicators if our task is prediction<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
