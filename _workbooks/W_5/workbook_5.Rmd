---
title: "Week 5 workbook"
description: |
author:
  - name: Joseph Bulbulia
    url: https://josephbulbulia.netlify.app
    affiliation: Victoria University of Wellington
    affiliation_url: https://www.wgtn.ac.nz
    orcid_id: 0000-0002-5861-2056
  - name: Johannes Karl 
    url: https://johannes-karl.com
    affiliation: Victoria University of Wellington
    affiliation_url: https://www.wgtn.ac.nz
    orcid_id: 0000-0001-5166-0728
output:
  distill::distill_article:
    self_contained: false
    toc: true
    highlight: tango
---

## Setup

### Libraries
```{r}
library(tidyverse)
library(patchwork)
library(lubridate)
library(kableExtra)
library(gtsummary)
```

### Import `nz` data

```{r}
# read data
nz_0 <- readr::read_csv2(url("https://raw.githubusercontent.com/go-bayes/psych-447/main/data/nz/nz.csv"))

# to relevel kessler 6 variables
f<-c("None Of The Time","A Little Of The Time","Some Of The Time",  "Most Of The Time", "All Of The Time")

# get data into shape
nz <- nz_0 %>%
  dplyr::mutate_if(is.character, factor) %>%
  select(
    -c(
      SWB.Kessler01,
      SWB.Kessler02,
      SWB.Kessler03,
      SWB.Kessler04,
      SWB.Kessler05,
      SWB.Kessler06
    )
  ) %>%
  dplyr::mutate(Wave = as.factor(Wave)) %>%
  mutate(FeelHopeless = forcats::fct_relevel(FeelHopeless, f)) %>%
  mutate(FeelDepressed = forcats::fct_relevel(FeelDepressed, f)) %>%
  mutate(FeelRestless = forcats::fct_relevel(FeelRestless, f)) %>%
  mutate(EverythingIsEffort = forcats::fct_relevel(EverythingIsEffort, f)) %>%
  mutate(FeelWorthless = forcats::fct_relevel(FeelWorthless, f)) %>%
  mutate(FeelNervous = forcats::fct_relevel(FeelNervous, f)) %>%
  dplyr::mutate(Wave = as.factor(Wave)) %>%
  dplyr::mutate(male_id = as.factor(Male)) %>%
  dplyr::mutate(date = make_date(year = 2009, month = 6, day = 30) + TSCORE)

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
nz$ma
```


### Import `Pearson and Lee` mother's and daughters data

```{r}
md_df <- data.frame(read.table(url("https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt"), header=TRUE))
# Center mother's height for later example
md_df <- md_df %>%
  dplyr::mutate(mother_height_c = as.numeric(scale(mother_height, center = TRUE, scale = FALSE)))
dplyr::glimpse(md_df)

# In 1903, Pearson and Lee collected 5,524 observations from mother/daughter height pairs. See lecture 5 for details
```

### Note

**For all exercises below, use only the 2019 wave of the `nz` dataset.**


## Q1. Create a descriptive table and a descriptive graph for the `HLTH.Weight` and `HLTH.Height` variables in the `nz` dataset

Select `HLTH.Weight`, `HLTH.Height` from the nz dataset. 

Filter only the 2019 wave.

Create a descriptive table and graph these two variables

Annotate your workflow (at each step, describe what you are doing and why).


## Q2. Write up a sample summary of the `HLTH.Weight` and `HLTH.Height` variables in the `nz` dataset in APA style. 

Using the analysis in Q1, describe Height and Weight in the `nz` dataset

Write brief APA methods summary for these two variables. 

Note: *if useful, use the 'male_id' variable to clarify interesting or puzzling features of the `HLTH.Weight` and `HLTH.Height` responses.

[NZAVS data dictionary](https://www.dropbox.com/s/e7krce01taya8a1/Copy%20of%20NZAVS-Technical-Documents-e02-Data-Dictionary.xlsx?dl=0)


## Q3. Regression height ~ weight and report results

Using the `nz` dataset, write a regression model for height as predicted by weight. 

Create a table for your results. 

Create a graphs/graphs to clarify the results of your regression model. 

Briefly report your results. 


## Q4. Regress height ~ male_id and report results


Using the `nz` dataset, write a regression model for height as predicted by `male_id` 

Create a table for your results. 

Create a graphs/graphs to clarify the results of your regression model. 

Briefly report your results. 


## Q5. Regression to predict

Using the regression coefficients from the Pearson and Lee 1903 dataset

Predict the heights of daughters of women in the `nz` dataset. 


## Q6. Bonus, not marked

On average, how much taller or shorter are women in New Zealand as sampled in 2019 `nz` dataset compared with women in 1903 as sampled in the Pearson and Lee dataset. 

Clarify your inference.

