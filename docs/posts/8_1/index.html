<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>Psych 447: Modelling binary, count data, and ordinal data</title>


<link rel="canonical" href="https://vuw-psych-447.netlify.app/posts/8_1/"/>
<link rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-04-27"/>
<meta property="article:created" itemprop="dateCreated" content="2021-04-27"/>
<meta name="article:author" content="Joseph Bulbulia"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Psych 447: Modelling binary, count data, and ordinal data"/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="https://vuw-psych-447.netlify.app/posts/8_1/"/>
<meta property="og:image" content="https://vuw-psych-447.netlify.app/posts/8_1/op.png"/>
<meta property="og:image:width" content="1000"/>
<meta property="og:image:height" content="1000"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Psych 447"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Psych 447: Modelling binary, count data, and ordinal data"/>
<meta property="twitter:url" content="https://vuw-psych-447.netlify.app/posts/8_1/"/>
<meta property="twitter:image" content="https://vuw-psych-447.netlify.app/posts/8_1/op.png"/>
<meta property="twitter:image:width" content="1000"/>
<meta property="twitter:image:height" content="1000"/>
<meta property="twitter:site" content="@go_bayes"/>
<meta property="twitter:creator" content="@go_bayes"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Psych 447: Modelling binary, count data, and ordinal data"/>
<meta name="citation_fulltext_html_url" content="https://vuw-psych-447.netlify.app/posts/8_1/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2021/04/27"/>
<meta name="citation_publication_date" content="2021/04/27"/>
<meta name="citation_author" content="Joseph Bulbulia"/>
<meta name="citation_author_institution" content="Victoria University of Wellington"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_publication_date=2020;citation_publisher=Zenodo;citation_doi=10.5281/zenodo.4080013;citation_author=A. Solomon Kurz"/>
  <meta name="citation_reference" content="citation_title=Regression and other stories;citation_publication_date=2020;citation_publisher=Cambridge University Press;citation_author=Andrew Gelman;citation_author=Jennifer Hill;citation_author=Aki Vehtari"/>
  <meta name="citation_reference" content="citation_title=Ordinal regression models in psychology: A tutorial;citation_publication_date=2019;citation_publisher=SAGE;citation_volume=2;citation_author=Paul-Christian BÃ¼rkner;citation_author=Matti Vuorre"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","output","bibliography","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY-NC-SA"]},{"type":"character","attributes":{},"value":["Modelling binary, count data, and ordinal data"]},{"type":"NULL"},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Joseph Bulbulia"]},{"type":"character","attributes":{},"value":["https://josephbulbulia.netlify.app"]},{"type":"character","attributes":{},"value":["Victoria University of Wellington"]},{"type":"character","attributes":{},"value":["https://www.wgtn.ac.nz"]},{"type":"character","attributes":{},"value":["0000-0002-5861-2056"]}]}]},{"type":"character","attributes":{},"value":["2021-APRIL-27"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["bib.bib"]},{"type":"character","attributes":{},"value":["https://vuw-psych-447.netlify.app/posts/8_1/"]},{"type":"character","attributes":{},"value":["https://vuw-psych-447.netlify.app/posts/8_1/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bib.bib","lecture_8_files/anchor-4.2.2/anchor.min.js","lecture_8_files/bowser-1.9.3/bowser.min.js","lecture_8_files/distill-2.2.21/template.v2.js","lecture_8_files/figure-html5/unnamed-chunk-1-1.png","lecture_8_files/figure-html5/unnamed-chunk-10-1.png","lecture_8_files/figure-html5/unnamed-chunk-12-1.png","lecture_8_files/figure-html5/unnamed-chunk-13-1.png","lecture_8_files/figure-html5/unnamed-chunk-14-1.png","lecture_8_files/figure-html5/unnamed-chunk-15-1.png","lecture_8_files/figure-html5/unnamed-chunk-17-1.png","lecture_8_files/figure-html5/unnamed-chunk-18-1.png","lecture_8_files/figure-html5/unnamed-chunk-19-1.png","lecture_8_files/figure-html5/unnamed-chunk-2-1.png","lecture_8_files/figure-html5/unnamed-chunk-20-1.png","lecture_8_files/figure-html5/unnamed-chunk-21-1.png","lecture_8_files/figure-html5/unnamed-chunk-22-1.png","lecture_8_files/figure-html5/unnamed-chunk-23-1.png","lecture_8_files/figure-html5/unnamed-chunk-24-1.png","lecture_8_files/figure-html5/unnamed-chunk-25-1.png","lecture_8_files/figure-html5/unnamed-chunk-26-1.png","lecture_8_files/figure-html5/unnamed-chunk-27-1.png","lecture_8_files/figure-html5/unnamed-chunk-28-1.png","lecture_8_files/figure-html5/unnamed-chunk-29-1.png","lecture_8_files/figure-html5/unnamed-chunk-30-1.png","lecture_8_files/figure-html5/unnamed-chunk-32-1.png","lecture_8_files/figure-html5/unnamed-chunk-33-1.png","lecture_8_files/figure-html5/unnamed-chunk-34-1.png","lecture_8_files/figure-html5/unnamed-chunk-35-1.png","lecture_8_files/figure-html5/unnamed-chunk-36-1.png","lecture_8_files/figure-html5/unnamed-chunk-37-1.png","lecture_8_files/figure-html5/unnamed-chunk-38-1.png","lecture_8_files/figure-html5/unnamed-chunk-39-1.png","lecture_8_files/figure-html5/unnamed-chunk-40-1.png","lecture_8_files/figure-html5/unnamed-chunk-41-1.png","lecture_8_files/figure-html5/unnamed-chunk-42-1.png","lecture_8_files/figure-html5/unnamed-chunk-43-1.png","lecture_8_files/figure-html5/unnamed-chunk-44-1.png","lecture_8_files/figure-html5/unnamed-chunk-45-1.png","lecture_8_files/figure-html5/unnamed-chunk-46-1.png","lecture_8_files/figure-html5/unnamed-chunk-47-1.png","lecture_8_files/figure-html5/unnamed-chunk-48-1.png","lecture_8_files/figure-html5/unnamed-chunk-49-1.png","lecture_8_files/figure-html5/unnamed-chunk-50-1.png","lecture_8_files/figure-html5/unnamed-chunk-51-1.png","lecture_8_files/figure-html5/unnamed-chunk-53-1.png","lecture_8_files/figure-html5/unnamed-chunk-54-1.png","lecture_8_files/figure-html5/unnamed-chunk-55-1.png","lecture_8_files/figure-html5/unnamed-chunk-57-1.png","lecture_8_files/figure-html5/unnamed-chunk-57-2.png","lecture_8_files/figure-html5/unnamed-chunk-57-3.png","lecture_8_files/figure-html5/unnamed-chunk-58-1.png","lecture_8_files/figure-html5/unnamed-chunk-58-2.png","lecture_8_files/figure-html5/unnamed-chunk-58-3.png","lecture_8_files/figure-html5/unnamed-chunk-59-1.png","lecture_8_files/figure-html5/unnamed-chunk-59-2.png","lecture_8_files/figure-html5/unnamed-chunk-59-3.png","lecture_8_files/figure-html5/unnamed-chunk-62-1.png","lecture_8_files/figure-html5/unnamed-chunk-62-2.png","lecture_8_files/figure-html5/unnamed-chunk-62-3.png","lecture_8_files/figure-html5/unnamed-chunk-63-1.png","lecture_8_files/figure-html5/unnamed-chunk-63-2.png","lecture_8_files/figure-html5/unnamed-chunk-63-3.png","lecture_8_files/figure-html5/unnamed-chunk-66-1.png","lecture_8_files/figure-html5/unnamed-chunk-67-1.png","lecture_8_files/figure-html5/unnamed-chunk-68-1.png","lecture_8_files/figure-html5/unnamed-chunk-68-2.png","lecture_8_files/figure-html5/unnamed-chunk-68-3.png","lecture_8_files/figure-html5/unnamed-chunk-69-1.png","lecture_8_files/figure-html5/unnamed-chunk-69-2.png","lecture_8_files/figure-html5/unnamed-chunk-69-3.png","lecture_8_files/figure-html5/unnamed-chunk-70-1.png","lecture_8_files/figure-html5/unnamed-chunk-70-2.png","lecture_8_files/figure-html5/unnamed-chunk-70-3.png","lecture_8_files/figure-html5/unnamed-chunk-71-1.png","lecture_8_files/figure-html5/unnamed-chunk-72-1.png","lecture_8_files/figure-html5/unnamed-chunk-73-1.png","lecture_8_files/figure-html5/unnamed-chunk-73-2.png","lecture_8_files/figure-html5/unnamed-chunk-73-3.png","lecture_8_files/figure-html5/unnamed-chunk-74-1.png","lecture_8_files/figure-html5/unnamed-chunk-74-2.png","lecture_8_files/figure-html5/unnamed-chunk-74-3.png","lecture_8_files/figure-html5/unnamed-chunk-75-1.png","lecture_8_files/figure-html5/unnamed-chunk-77-1.png","lecture_8_files/figure-html5/unnamed-chunk-78-1.png","lecture_8_files/figure-html5/unnamed-chunk-79-1.png","lecture_8_files/figure-html5/unnamed-chunk-9-1.png","lecture_8_files/header-attrs-2.7.1/header-attrs.js","lecture_8_files/header-attrs-2.7.8/header-attrs.js","lecture_8_files/jquery-1.11.3/jquery.min.js","lecture_8_files/popper-2.6.0/popper.min.js","lecture_8_files/tippy-6.2.7/tippy-bundle.umd.min.js","lecture_8_files/tippy-6.2.7/tippy-light-border.css","lecture_8_files/tippy-6.2.7/tippy.css","lecture_8_files/tippy-6.2.7/tippy.umd.min.js","lecture_8_files/webcomponents-2.0.0/webcomponents.js","op.png","op2.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css2?family=Fira+Code&family=Roboto&display=swap');

html {
  /*-- Main font sizes --*/
  /*  --title-size:      32px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "Roboto", sans-serif;
  --mono-font:       "Fira Code", monospace;
  --body-font:       "Roboto", sans-serif;
  --navbar-font:     "Roboto", sans-serif;  /* websites + blogs only */
}

code {
  font-family: var(--mono-font);
  font-size: 14px;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.7.8/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=G-GQF269N0S4"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-GQF269N0S4');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Modelling binary, count data, and ordinal data","authors":[{"author":"Joseph Bulbulia","authorURL":"https://josephbulbulia.netlify.app","affiliation":"Victoria University of Wellington","affiliationURL":"https://www.wgtn.ac.nz","orcidID":"0000-0002-5861-2056"}],"publishedDate":"2021-04-27T00:00:00.000+00:00","citationText":"Bulbulia, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Psych 447</a>
<a href="../../about.html">About</a>
<a href="../../index.html">Lecture Topics</a>
<a href="../../assessments.html">Assessments</a>
<a href="../../index_workbooks.html">Workbooks</a>
</div>
<div class="nav-right">
<a href="https://go-bayes.github.io/psych-447/" aria-label="Link to source">
<i class="fa fa-code" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Modelling binary, count data, and ordinal data</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  Joseph Bulbulia <a href="https://josephbulbulia.netlify.app" class="uri">https://josephbulbulia.netlify.app</a> (Victoria University of Wellington)<a href="https://www.wgtn.ac.nz" class="uri">https://www.wgtn.ac.nz</a>
  
<br/>2021-APRIL-27
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#objectives">Objectives</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#link-function">Link function</a></li>
<li><a href="#logistic-regression">Logistic regression</a>
<ul>
<li><a href="#logistic-regression-with-a-single-co-variate.">Logistic regression with a single co-variate.</a></li>
<li><a href="#logistic-regression-with-a-single-co-variate.-1">Logistic regression with a single co-variate.</a></li>
<li><a href="#logistic-regression-model-with-a-categorical-covariate">Logistic regression model with a categorical covariate</a></li>
<li><a href="#notes">Notes</a></li>
</ul></li>
<li><a href="#count-reponses">Count reponses</a></li>
<li><a href="#check-the-models">Check the models</a>
<ul>
<li><a href="#over-dispersion">Over-dispersion</a></li>
<li><a href="#zero-inflated-poisson-regression">Zero-inflated poisson regression</a>
<ul>
<li><a href="#predicting-zeros">Predicting zeros</a></li>
</ul></li>
<li><a href="#ordinal-outcomes">Ordinal outcomes</a></li>
<li><a href="#ordinal-predictors-monotonic-effects">Ordinal predictors (Monotonic effects)</a></li>
<li><a href="#bonus-latent-profile-analysis">Bonus: Latent Profile Analysis</a></li>
<li><a href="#latent-profile-analysis">Latent Profile Analysis</a></li>
<li><a href="#acknowledgments-and-references">Acknowledgments and References</a></li>
</ul></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>### Libraries</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='http://tidyverse.tidyverse.org'>"tidyverse"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://patchwork.data-imaginist.com'>"patchwork"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://lubridate.tidyverse.org'>"lubridate"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='http://haozhu233.github.io/kableExtra/'>"kableExtra"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/ddsjoberg/gtsummary'>"gtsummary"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://lubridate.tidyverse.org'>"lubridate"</a></span><span class='op'>)</span>
<span class='fu'>devtools</span><span class='fu'>::</span><span class='fu'><a href='https://devtools.r-lib.org//reference/remote-reexports.html'>install_github</a></span><span class='op'>(</span><span class='st'>"data-edu/tidyLPA"</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://data-edu.github.io/tidyLPA/'>tidyLPA</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"tidyLPA"</span><span class='op'>)</span>
<span class='op'>}</span>


<span class='co'># installed from previous lectures</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/datalorax/equatiomatic'>"equatiomatic"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='http://tidyverse.tidyverse.org'>"tidyverse"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/malcolmbarrett/ggdag'>"ggdag"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/paul-buerkner/brms'>"brms"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://mc-stan.org/rstan'>"rstan"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://mc-stan.org/rstanarm/'>"rstanarm"</a></span><span class='op'>)</span>
<span class='co'># library("tidybayes")</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://mc-stan.org/bayesplot/'>"bayesplot"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/easystats/easystats'>"easystats"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='http://haozhu233.github.io/kableExtra/'>"kableExtra"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://broom.tidymodels.org/'>"broom"</a></span><span class='op'>)</span>
<span class='co'># rstan options</span>
<span class='fu'><a href='https://mc-stan.org/rstan/reference/rstan_options.html'>rstan_options</a></span><span class='op'>(</span>auto_write<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>mc.cores<span class='op'>=</span><span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span> <span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>theme_set</span><span class='op'>(</span><span class='fu'>theme_classic</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="op.png" width="500" /></p>
</div>
<h2 id="objectives">Objectives</h2>
<ol type="1">
<li>Understand why a linear model is a special case of a âgeneralised linear model.â</li>
<li>Understand how to write and interpret three families of generalised linear models:</li>
</ol>
<ul>
<li>logistic regression models, which apply to <em>binary</em> responses;</li>
<li>Poisson regression models, which apply to <em>rates</em>;</li>
<li>Zero-inflated poisson models, in which rates data contain an over-abundance of zeros. Here, we will also discuss over-dispersed poisson models.</li>
<li>Ordinal regression model, which apply to data with multi-nomial outcomes, for example survey responses (e.g.Â âlittle,â ânone,â âmoreâ). Here we will also discuss monotonic predictors.</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Recall that a regression model combines data from a sample with the tools of probability theory to infer features of some unobserved population. We have discussing how the mechanics of moving from a sample to a population carries uncertainty. In a nutshell, regression is guesswork. Our task is to not to remove uncertainty but rather to quantify it. Our regression workflow is built on two imperatives: (1) to clarify our assumptions; (2) to clarify our decisions.</p>
<p>It is fortunate that we live in an ordered universe. Although at the level of particle physics, the universe might be random, at the scale of âmedium-sized dry goodsâ<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, the world is ordered.</p>
<p>So far, our models have assumed that response data in our models are sampling from a normal distribution. There are two parameters that we need to estimate for a normal distribution, the mean, and the variance. The linear regression model is a special case of the generalised linear regression model, in which responses may sample from distributions other than the normal distribution.</p>
<h2 id="link-function">Link function</h2>
<p>We can write our linear model in a different format, which makes its assumptions explicit (recall that we want to clarify our assumptions)"</p>
<p><span class="math display">\[
y_i \sim Normal ( \mu_i, \sigma)\\
\mu_i \sim \alpha + \beta x_i \\
\alpha \sim Normal(0,\sigma_{\alpha}) \\
\sigma_{\alpha} \sim Normal(0,1) \\
\beta \sim Normal(0,10) \\
\sigma \sim Exponentional (1) \\
x_i \sim Normal (0, 1)
\]</span></p>
<p>The previous examples describes a regression model that assumes we are sampling from a normal distribution. There is no link function required to transform the expectation for the model estimates. When we are not sampling from a normal we require a link function</p>
<h2 id="logistic-regression">Logistic regression</h2>
<h3 id="logistic-regression-with-a-single-co-variate.">Logistic regression with a single co-variate.</h3>
<p>First letâs graph the home ownership</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>HomeOwner</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-1-1.png" width="1152" /></p>
</div>
<p>From the graph, we can see response distribution is fully bimodal (excluding the NAs).</p>
<p>The model requires a binomial link function:</p>
<p><span class="math display">\[Home \sim Binomial (Ownership, Pr)\]</span></p>
<p>The binomial link function does two things:</p>
<ul>
<li>first, it maps the range <span class="math inline">\((0, 1)\)</span> to <span class="math inline">\(-(\infty, -\infty)\)</span>.</li>
<li>second, it maps these values back to the unit range (see: <span class="citation" data-cites="gelman2020"><a href="#ref-gelman2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-gelman2020" role="doc-biblioref">2020</a>)</span> )</li>
</ul>
<p>The logistic function satisfies the first task:</p>
<p><span class="math inline">\(logit(x) = log\frac{x}{(1-x)}\)</span></p>
<p>and the inverse logit function does 2:</p>
<p><span class="math inline">\(logit^-1(x) = log\frac{e^x}{(1-e^x)}\)</span></p>
<p>In R these functions are written:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>logit</span> <span class='op'>&lt;-</span> <span class='va'>qlogis</span> 
<span class='va'>invlogit</span> <span class='op'>&lt;-</span> <span class='va'>plogis</span>
</code></pre>
</div>
</div>
<p>For logistic regression, the functions are employed as follow:</p>
<p><span class="math display">\[
\Pr(y_i = 1) = p_i \\
logit(p_i) = \alpha + \beta x_i \\
\Pr(y_i = 1) = logit^{-1}(\alpha + \beta x_i)
\]</span></p>
<p>We can write a generalised linear model that predict home ownership as follows:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>home</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>HomeOwner</span> <span class='op'>~</span> <span class='fl'>1</span>, data <span class='op'>=</span> <span class='va'>nz</span>, 
            family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><span class="math display">\[
\log\left[ \frac { P( \operatorname{HomeOwner} = \operatorname{1} ) }{ 1 - P( \operatorname{HomeOwner} = \operatorname{1} ) } \right] = \alpha
\]</span></p>
<p>Which gives us the following result</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>home</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter   | Log-Odds |   SE |       95% CI |     z |      p
-------------------------------------------------------------
(Intercept) |     1.46 | 0.05 | [1.36, 1.55] | 30.38 | &lt; .001</code></pre>
</div>
<p>Or plugging this into the equation:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># this is how to quickly generate the equation</span>
<span class='fu'>equatiomatic</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/equatiomatic/man/extract_eq.html'>extract_eq</a></span><span class='op'>(</span><span class='va'>home</span>,  use_coefs <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><span class="math display">\[
\log\left[ \frac { \widehat{P( \operatorname{HomeOwner} = \operatorname{1} )} }{ 1 - \widehat{P( \operatorname{HomeOwner} = \operatorname{1} )} } \right] = 1.46
\]</span></p>
</div>
<p>How do we interpret this result?</p>
<p>We may use the <code>plogis</code> function to obtain the probability</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>home</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.811068</code></pre>
</div>
<h4 id="interpretation-of-the-result">Interpretation of the result</h4>
<p>The probability of an NZAVS participant owning their own home is pr = 81.</p>
<h3 id="logistic-regression-with-a-single-co-variate.-1">Logistic regression with a single co-variate.</h3>
<p>Letâs predict home ownership by income.</p>
<h4 id="workflow-center-and-scale-predictors">Workflow: center and scale predictors</h4>
<p>First center/scale our predictor:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># center and scale household income </span>
<span class='va'>nz</span><span class='op'>$</span><span class='va'>Household.INC_s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>Household.INC</span><span class='op'>)</span>

<span class='va'>nz</span><span class='op'>[</span><span class='st'>'Household.INC_s'</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>Household.INC</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># how much is a standard deviation -- which will represent a 1 unit change for the regression coefficient? </span>
<span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span> <span class='va'>nz</span><span class='op'>$</span><span class='va'>Household.INC</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span> <span class='op'>)</span> <span class='co'># 95,090</span>
</code></pre>
</div>
<pre><code>[1] 95090.79</code></pre>
</div>
<p>What is the mean household income in 2018?</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span> <span class='va'>nz</span><span class='op'>$</span><span class='va'>Household.INC</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span> <span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 112877.1</code></pre>
</div>
<h4 id="model-syntax">Model syntax</h4>
<p>We write the model as follows</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>home2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>HomeOwner</span> <span class='op'>~</span> <span class='va'>Household.INC_s</span>, data <span class='op'>=</span> <span class='va'>nz</span>, 
            family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Results:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rs2</span><span class='op'>&lt;-</span><span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>home2</span><span class='op'>)</span>
<span class='va'>rs2</span>
</code></pre>
</div>
<pre><code>Parameter       | Log-Odds |   SE |       95% CI |     z |      p
-----------------------------------------------------------------
(Intercept)     |     1.58 | 0.05 | [1.48, 1.69] | 29.37 | &lt; .001
Household.INC_s |     0.72 | 0.08 | [0.57, 0.89] |  8.86 | &lt; .001</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rs2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-10-1.png" width="1152" /></p>
</div>
<p>Which we can write:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># this is how to quickly generate the equation</span>
<span class='fu'>equatiomatic</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/equatiomatic/man/extract_eq.html'>extract_eq</a></span><span class='op'>(</span><span class='va'>home2</span>,  use_coefs <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><span class="math display">\[
\log\left[ \frac { \widehat{P( \operatorname{HomeOwner} = \operatorname{1} )} }{ 1 - \widehat{P( \operatorname{HomeOwner} = \operatorname{1} )} } \right] = 1.58 + 0.72(\operatorname{Household.INC\_s})
\]</span></p>
</div>
<p>How do we interpret this model?</p>
<p>Letâs use the report package</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>report</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/report/reference/report.html'>report</a></span><span class='op'>(</span><span class='va'>home2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>We fitted a logistic model (estimated using ML) to predict HomeOwner with Household.INC_s (formula: HomeOwner ~ Household.INC_s). The model&#39;s explanatory power is weak (Tjur&#39;s R2 = 0.04). The model&#39;s intercept, corresponding to Household.INC_s = 0, is at 1.58 (95% CI [1.48, 1.69], p &lt; .001). Within this model:

  - The effect of Household.INC_s is significantly positive (beta = 0.72, 95% CI [0.57, 0.89], p &lt; .001; Std. beta = 0.73, 95% CI [0.57, 0.89])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
<p>Thereâs lots of mention of p-values and power claims in the automated report, but what do these words practically mean?</p>
<h4 id="workflow-graph-your-results">Workflow: graph your results</h4>
<p>We are cultivating a habit of graphing our results. Letâs put this habit to virtuous use.</p>
<p>Hereâs a shortcut for obtaining a quick, investigative plot:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>Household.INC_s</span>, <span class='va'>nz</span><span class='op'>$</span><span class='va'>HomeOwner</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/graphics/curve.html'>curve</a></span><span class='op'>(</span><span class='fu'><a href='https://mc-stan.org/rstanarm/reference/logit.html'>invlogit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>home2</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>home2</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='va'>x</span><span class='op'>)</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-13-1.png" width="1152" /></p>
</div>
<p>The slightly longer syntax for a ggeffects graph is:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>home2</span>, terms <span class='op'>=</span> <span class='st'>"Household.INC_s"</span><span class='op'>)</span>, add.data <span class='op'>=</span> <span class='cn'>TRUE</span>, alpha <span class='op'>=</span><span class='fl'>.1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-14-1.png" width="1152" /></p>
</div>
<p>And here we find a curious feature of our data. Income is diffuse. We have someone that makes over 25 standard deviations more than the average income.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>Household.INC</span>, breaks <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-15-1.png" width="1152" /></p>
</div>
<p>Although we graph home ownership, we forgot to graph Household income.</p>
<p><strong>Before launching into a model, your workflow should include graphing your predictors as well as your responses</strong></p>
<p>The range of incomes is: 0, 2.5^{6}.</p>
<p>Note that we also have 8 who report making less than 10000,</p>
<h4 id="sensitivity-of-the-data-to-outliers">Sensitivity of the data to outliers?</h4>
<p>Letâs re-run the model while eliminating the extremely rich, and restrict focus to 98% of the data. This restriction would appear to be justified. It would not be surprising if very rich people were to own their own homes.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Select 98 % of the range</span>
<span class='va'>nz2</span> <span class='op'>&lt;-</span>  <span class='va'>nz</span><span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Household.INC_s</span> <span class='op'>&lt;</span> <span class='fl'>4</span><span class='op'>)</span>
<span class='co'>##</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>nz2</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.979438</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>home2.1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>HomeOwner</span> <span class='op'>~</span> <span class='va'>Household.INC_s</span>, data <span class='op'>=</span> <span class='va'>nz2</span>, 
            family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
<span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>home2.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter       | Log-Odds |   SE |       95% CI |     z |      p
-----------------------------------------------------------------
(Intercept)     |     1.60 | 0.05 | [1.50, 1.71] | 29.21 | &lt; .001
Household.INC_s |     0.78 | 0.08 | [0.62, 0.95] |  9.27 | &lt; .001</code></pre>
</div>
<p>Note that we need a sensible range. The lowest value is <strong>not</strong> 4 SD from the mean</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>nz2</span><span class='op'>$</span><span class='va'>Household.INC_s</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-18-1.png" width="1152" /></p>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>nz2</span><span class='op'>$</span><span class='va'>Household.INC_s</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -1.187046  3.755599</code></pre>
</div>
<p>Does this matter? Not necessarily. Linear regression does not require that the predictors sample from a normal distribution. This should be obvious, as we have used categorical predictors (e.g.Â Male/Not_Male). However it is worth explicitly stating. I have heard people who should know better express confusion on this point. Of course, that there are no parametric assumptions for your predictor variables does not let you off the hook. In this case, the extreme values might be distorting our inference.</p>
<p>Letâs write a model with the diminished dataset.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#range(nz$Household.INC_s, na.rm = T)</span>

<span class='va'>mp2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>home2</span>,
                                 terms <span class='op'>=</span> <span class='st'>"Household.INC_s[all]"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mp2.1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>home2.1</span>,
                                   terms <span class='op'>=</span> <span class='st'>"Household.INC_s[all]"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='va'>mp2</span> <span class='op'>+</span> <span class='va'>mp2.1</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Comparison of logistic regression models with tranformations"</span>,
                              tag_levels <span class='op'>=</span> <span class='st'>'a'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>guides <span class='op'>=</span> <span class='st'>'collect'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-20-1.png" width="1152" /></p>
</div>
<p>Note the trick I used here.</p>
<p><code>scale_x_continuous(limits = c(-1.2, 4))</code></p>
<p>Allowed me to constrain both graphs to the same x-axis scale. If I left this out the graphs would have looked like this:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#range(nz$Household.INC_s, na.rm = T)</span>

<span class='va'>mp2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>home2</span>,
                                 terms <span class='op'>=</span> <span class='st'>"Household.INC_s[all]"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> 
<span class='va'>mp2.1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>home2.1</span>,
                                   terms <span class='op'>=</span> <span class='st'>"Household.INC_s[all]"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_y_continuous</span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> 

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='va'>mp2</span> <span class='op'>+</span> <span class='va'>mp2.1</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Comparison of logistic regression models with tranformations"</span>,
                              tag_levels <span class='op'>=</span> <span class='st'>'a'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>guides <span class='op'>=</span> <span class='st'>'collect'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-21-1.png" width="1152" /></p>
</div>
<p>The models really are the practically identical, however figure plots all the data, however the outlier creates a visual impression of difference.</p>
<p>Lesson:<br />
<br />
<strong>Take care in the x and y axis scales that you loose when displaying your data and your results</strong><br />
</p>
<p>Else:</p>
<p>You can perform further checks using the following code, however, it should be apparent from the preceding graph that the models two models do not vary.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>check1</span> <span class='op'>&lt;-</span> <span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/check_model.html'>check_model</a></span><span class='op'>(</span><span class='va'>home2</span><span class='op'>)</span>
<span class='va'>check1</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>check2</span> <span class='op'>&lt;-</span> <span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/check_model.html'>check_model</a></span><span class='op'>(</span><span class='va'>home2.1</span><span class='op'>)</span>
<span class='va'>check2</span>
</code></pre>
</div>
</div>
<h3 id="logistic-regression-model-with-a-categorical-covariate">Logistic regression model with a categorical covariate</h3>
<p>Letâs use the <code>GenCohort</code> variable.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mg1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>HomeOwner</span> <span class='op'>~</span> <span class='va'>GenCohort</span>, data <span class='op'>=</span> <span class='va'>nz</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
<span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>mg1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter                               | Log-Odds |   SE |         95% CI |      z |      p
--------------------------------------------------------------------------------------------
(Intercept)                             |     2.13 | 0.10 | [ 1.94,  2.34] |  20.68 | &lt; .001
GenCohortGen_Silent *  born&lt; 1946       |     0.26 | 0.28 | [-0.26,  0.85] |   0.94 | 0.347 
GenCohortGenX *  born &gt;=1961 &amp; b.&lt; 1980 |    -0.62 | 0.13 | [-0.87, -0.38] |  -4.90 | &lt; .001
GenCohortGenY *  born &gt;=1980 &amp; b.&lt; 1996 |    -1.87 | 0.14 | [-2.15, -1.59] | -13.00 | &lt; .001
GenCohortGenZ *  born &gt;= 1996           |    -4.91 | 1.04 | [-7.80, -3.30] |  -4.74 | &lt; .001</code></pre>
</div>
<p>What does this mean? Letâs graph the results</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p_mg1</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>mg1</span>, terms <span class='op'>=</span> <span class='st'>"GenCohort[all]"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>p_mg1</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-25-1.png" width="1152" /></p>
</div>
<p>Lets stratify by income</p>
<p>Household.INC_s</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mg2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>HomeOwner</span> <span class='op'>~</span> <span class='va'>GenCohort</span> <span class='op'>+</span> <span class='va'>Household.INC_s</span>, data <span class='op'>=</span> <span class='va'>nz</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
<span class='fu'>parameters</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/parameters/reference/model_parameters.html'>model_parameters</a></span><span class='op'>(</span><span class='va'>mg2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter                               | Log-Odds |   SE |         95% CI |      z |      p
--------------------------------------------------------------------------------------------
(Intercept)                             |     2.60 | 0.12 | [ 2.37,  2.84] |  21.79 | &lt; .001
GenCohortGen_Silent *  born&lt; 1946       |     0.70 | 0.30 | [ 0.15,  1.33] |   2.35 | 0.019 
GenCohortGenX *  born &gt;=1961 &amp; b.&lt; 1980 |    -0.99 | 0.14 | [-1.26, -0.73] |  -7.31 | &lt; .001
GenCohortGenY *  born &gt;=1980 &amp; b.&lt; 1996 |    -2.40 | 0.16 | [-2.71, -2.09] | -14.94 | &lt; .001
GenCohortGenZ *  born &gt;= 1996           |    -4.99 | 1.06 | [-7.91, -3.32] |  -4.72 | &lt; .001
Household.INC_s                         |     1.19 | 0.10 | [ 0.99,  1.39] |  11.62 | &lt; .001</code></pre>
</div>
<p>We really donât see income making a difference to home ownership for boomers. A little sepearation happens among those in Gen X.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p_mg2</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>mg2</span>, terms <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GenCohort[all]"</span>, <span class='st'>"Household.INC_s[c(-1,0,3)]"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>p_mg2</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-27-1.png" width="1152" /></p>
</div>
<h3 id="notes">Notes</h3>
<ul>
<li><p>Additive indicators on the logit scale are <em>non-linear</em> on the data scale. We see this in the previous graph. Thereâs a curve. This is typical of generalised linear models.</p></li>
<li><p>do not interpret the signs of the coefficients. For example, <code>plogis(-3)</code> is 0.0474259, which is a positive probability.</p></li>
<li><p>here are is no error term (<span class="math inline">\(\sigma^2\)</span>) in logistic regression. We only estimate the mean. The variances cannot be estimated:</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sjPlot</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/tab_model.html'>tab_model</a></span><span class='op'>(</span><span class='va'>home2</span><span class='op'>)</span>
</code></pre>
</div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
HomeOwner
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
4.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
4.39Â âÂ 5.43
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Household.INC_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.76Â âÂ 2.43
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
2798
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup> Tjur
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.036
</td>
</tr>
</table>
</div>
<ul>
<li>we can add points to our graph like this:</li>
</ul>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>home2</span>, 
                     terms <span class='op'>=</span> <span class='st'>"Household.INC_s[all]"</span><span class='op'>)</span>, add.data <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span>limits<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-29-1.png" width="1152" /></p>
</div>
<p>Or to limit our points to the meaningful range:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>home2</span>, 
                     terms <span class='op'>=</span> <span class='st'>"Household.INC_s[all]"</span><span class='op'>)</span>, add.data <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_continuous</span><span class='op'>(</span>limits<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-30-1.png" width="1152" /></p>
</div>
<ul>
<li>center (and where it eases interpretation, also scale) your predictor variables.</li>
</ul>
<p>Uncertainty arises because we only have 17 people in this jittered nz dataset born after 1996:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>GenCohort</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Gen Boombers: born &gt;= 1946 &amp; b.&lt; 1961 
                                 1024 
               Gen_Silent: born&lt; 1946 
                                  208 
         GenX: born &gt;=1961 &amp; b.&lt; 1980 
                                 1253 
         GenY: born &gt;=1980 &amp; b.&lt; 1996 
                                  416 
                   GenZ: born &gt;= 1996 
                                   17 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>nz</span>, <span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>GenCohort</span>, <span class='va'>Household.INC</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_jitter</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-32-1.png" width="1152" /></p>
</div>
<p>Which model should we prefer?</p>
<p>The model <code>mg2</code> grealy improves on the BIC performance, indicating that we should prefer this model.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>per_home</span> <span class='op'>&lt;-</span><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/compare_performance.html'>compare_performance</a></span><span class='op'>(</span><span class='va'>home2</span>,<span class='va'>mg1</span>,<span class='va'>mg2</span><span class='op'>)</span>
<span class='va'>per_home</span>
</code></pre>
</div>
<pre><code># Comparison of Model Performance Indices

Name  | Model |      AIC |      BIC | Tjur&#39;s R2 |  RMSE | Sigma | Log_loss | Score_log |   PCP | Score_spherical
----------------------------------------------------------------------------------------------------------------
home2 |   glm | 2590.320 | 2602.193 |     0.036 | 0.381 | 0.962 |    0.462 |      -Inf | 0.708 |                
mg1   |   glm | 2516.922 | 2546.675 |     0.099 | 0.372 | 0.941 |    0.442 |      -Inf | 0.724 |       3.915e-04
mg2   |   glm | 2272.307 | 2307.927 |     0.168 | 0.354 | 0.900 |    0.404 |      -Inf | 0.748 |       5.159e-04</code></pre>
</div>
<p>Hereâs a graph:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>per_home</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-34-1.png" width="1152" /></p>
</div>
<p>Note that we do not include the model that used fewer cases because, from the vantage point of information theory, this would be comparing apples with organges.</p>
<p>We can use the performance package to check the accuracy of the our models</p>
<p>Compare:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance_accuracy</span><span class='op'>(</span><span class='va'>mg1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Accuracy of Model Predictions

Accuracy: 66.56%
      SE: 1.89%-points
  Method: Area under Curve</code></pre>
</div>
<p>With:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance_accuracy</span><span class='op'>(</span><span class='va'>mg2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Accuracy of Model Predictions

Accuracy: 76.84%
      SE: 4.40%-points
  Method: Area under Curve</code></pre>
</div>
<p>And this reveals little difference, indicating that with this many data, the outliers donât affect inference.</p>
<h2 id="count-reponses">Count reponses</h2>
<p>We use a poisson model cor count data.</p>
<p>Letâs simulate (Gelman and Hill:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>50</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='va'>a</span> <span class='op'>+</span> <span class='va'>b</span>  <span class='op'>*</span> <span class='va'>x</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>999</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span><span class='op'>(</span><span class='va'>n</span>,  <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># mean of poisson is equal to its variance</span>
<span class='va'>fake</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span>, y<span class='op'>=</span><span class='va'>y</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>fake</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-37-1.png" width="1152" /></p>
</div>
<p>Model</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pois1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>, data <span class='op'>=</span> <span class='va'>fake</span>, family <span class='op'>=</span> <span class='st'>"poisson"</span><span class='op'>)</span>
<span class='fu'>model_parameters</span><span class='op'>(</span><span class='va'>pois1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter   | Log-Mean |   SE |       95% CI |     z |      p
-------------------------------------------------------------
(Intercept) |     1.05 | 0.10 | [0.86, 1.23] | 10.99 | &lt; .001
x           |     2.01 | 0.06 | [1.89, 2.13] | 33.22 | &lt; .001</code></pre>
</div>
<p>Note that in a poisson model, it is the log of the expected values (not the log of the raw data) that the model estimates:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># this is how to quickly generate the equation</span>
<span class='fu'>equatiomatic</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/equatiomatic/man/extract_eq.html'>extract_eq</a></span><span class='op'>(</span><span class='va'>pois1</span>,  use_coefs <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><span class="math display">\[
\log ({ \widehat{E( \operatorname{y} )} })  = 1.05 + 2.01(\operatorname{x})
\]</span></p>
</div>
<p>We can put this on the data scale</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p_pois1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>pois1</span>, terms <span class='op'>=</span> <span class='st'>"x"</span><span class='op'>)</span>, add.data <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>p_pois1</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-40-1.png" width="1152" /></p>
</div>
<p>Letâs compare this to a model in which we assume a normal distribution</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pois2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>, data <span class='op'>=</span> <span class='va'>fake</span><span class='op'>)</span> <span class='co'># remove "family = `poisson`)</span>
<span class='fu'>model_parameters</span><span class='op'>(</span><span class='va'>pois2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter   | Coefficient |   SE |         95% CI | t(48) |      p
------------------------------------------------------------------
(Intercept) |       16.65 | 3.79 | [ 9.23, 24.07] |  4.40 | &lt; .001
x           |       25.80 | 3.35 | [19.24, 32.36] |  7.71 | &lt; .001</code></pre>
</div>
<p>Quick plot:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p_pois2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>pois2</span>, terms <span class='op'>=</span> <span class='st'>"x"</span><span class='op'>)</span>, add.data <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>p_pois2</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-42-1.png" width="1152" /></p>
</div>
<h1 id="check-the-models">Check the models</h1>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/check_model.html'>check_model</a></span><span class='op'>(</span><span class='va'>pois1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-43-1.png" width="1152" /></p>
</div>
<p>We can see the linearity assumption is violated:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/check_model.html'>check_model</a></span><span class='op'>(</span><span class='va'>pois2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-44-1.png" width="1152" /></p>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>splines</span><span class='op'>)</span>

<span class='va'>pois3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/splines/bs.html'>bs</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>fake</span><span class='op'>)</span> <span class='co'># remove "family = `poisson`)</span>
<span class='fu'>model_parameters</span><span class='op'>(</span><span class='va'>pois3</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter      | Coefficient |    SE |           95% CI |  t(46) |      p
-------------------------------------------------------------------------
(Intercept)    |      -10.12 |  4.58 | [-19.10,  -1.14] |  -2.21 | 0.032 
x [1st degree] |       57.10 | 12.26 | [ 33.08,  81.13] |   4.66 | &lt; .001
x [2nd degree] |      -78.86 |  6.43 | [-91.46, -66.26] | -12.27 | &lt; .001
x [3rd degree] |      136.67 |  6.02 | [124.86, 148.48] |  22.69 | &lt; .001</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p_pois3</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>pois3</span>, terms <span class='op'>=</span> <span class='st'>"x"</span><span class='op'>)</span>, add.data <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>p_pois3</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-46-1.png" width="1152" /></p>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='va'>p_pois1</span> <span class='op'>+</span> <span class='va'>p_pois2</span> <span class='op'>+</span> <span class='va'>p_pois3</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"comparison of three assumed distributions"</span>, tag_levels <span class='op'>=</span> <span class='st'>'a'</span>,
                                              subtitle <span class='op'>=</span> <span class='st'>"The Poisson model (a) fits \nThe gaussian model (b) underfitsthe \nThe spline model (c) overfits"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>guides <span class='op'>=</span> <span class='st'>"collect"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-47-1.png" width="1152" /></p>
</div>
<p>The poisson fits best: this is no surprise: we simulated poisson outcomes.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>per_pois</span> <span class='op'>&lt;-</span><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/compare_performance.html'>compare_performance</a></span><span class='op'>(</span><span class='va'>pois1</span>,<span class='va'>pois2</span>,<span class='va'>pois3</span><span class='op'>)</span>
<span class='va'>per_pois</span>
</code></pre>
</div>
<pre><code># Comparison of Model Performance Indices

Name  | Model |     AIC |     BIC |   RMSE |  Sigma |    R2 | Nagelkerke&#39;s R2 | Score_log | Score_spherical
-----------------------------------------------------------------------------------------------------------
pois1 |   glm | 219.043 | 222.867 |  4.118 |  0.819 |       |           1.000 |    -2.150 |           0.091
pois2 |   glm | 469.529 | 475.265 | 24.937 | 25.451 | 0.553 |                 |           |                
pois3 |   glm | 341.527 | 351.087 |  6.661 |  6.945 | 0.968 |                 |           |                </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>per_pois</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-48-1.png" width="1152" /></p>
</div>
<h2 id="over-dispersion">Over-dispersion</h2>
<p>The expected value of a poisson and the variance of poisson variable are the same: lamda. However often (typically) this assumption is violated, and the random variables in oneâs data set are over (and occassionally underdispersed)</p>
<p>To see this, a poisson with lamnda = 10</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='va'>a</span> <span class='op'>+</span> <span class='va'>b</span>  <span class='op'>*</span> <span class='va'>x</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>999</span><span class='op'>)</span>

<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/rnegbin.html'>rnegbin</a></span><span class='op'>(</span><span class='va'>n</span>,  mu <span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>, theta <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='co'># mean overdistribution parameter</span>
<span class='va'>fake2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span>, y<span class='op'>=</span><span class='va'>y</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>fake2</span><span class='op'>$</span><span class='va'>y</span>, breaks <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-49-1.png" width="1152" /></p>
</div>
<p>We fit a poisson model:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='va'>nb1</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>, family <span class='op'>=</span> <span class='va'>poisson</span>, <span class='va'>fake2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nb1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
glm(formula = y ~ x, family = poisson, data = fake2)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-12.1998   -1.5116   -0.4440    0.3219    9.9892  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.03522    0.08023   12.90   &lt;2e-16 ***
x            1.96100    0.05415   36.22   &lt;2e-16 ***
---
Signif. codes:  
0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4023.01  on 99  degrees of freedom
Residual deviance:  809.75  on 98  degrees of freedom
AIC: 1040

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/check_overdispersion.html'>check_overdispersion</a></span><span class='op'>(</span><span class='va'>nb1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Overdispersion test

       dispersion ratio =   7.561
  Pearson&#39;s Chi-Squared = 741.011
                p-value = &lt; 0.001</code></pre>
</div>
<p>Try a negative binomial model</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nb2</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/glm.nb.html'>glm.nb</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>,  data <span class='op'>=</span> <span class='va'>fake2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://mc-stan.org/rstanarm/reference/loo.stanreg.html'>compare_models</a></span><span class='op'>(</span><span class='va'>nb1</span>,<span class='va'>nb2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Parameter    |               nb1 |               nb2
----------------------------------------------------
(Intercept)  | 1.04 (0.88, 1.19) | 0.97 (0.70, 1.25)
x            | 1.96 (1.85, 2.07) | 1.99 (1.75, 2.24)
----------------------------------------------------
Observations |               100 |               100</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>nb1</span>,terms<span class='op'>=</span><span class='st'>"x"</span><span class='op'>)</span>, add.data <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-53-1.png" width="1152" /></p>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>nb2</span>,terms<span class='op'>=</span><span class='st'>"x"</span><span class='op'>)</span>, add.data <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-54-1.png" width="1152" /></p>
</div>
<h2 id="zero-inflated-poisson-regression">Zero-inflated poisson regression</h2>
<p>In the nz dataset, volunteering (hours of charity) look to be zero-inflated, and also over-dispersed.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>HoursCharity</span>, breaks <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-55-1.png" width="1152" /></p>
</div>
<p>We can quickly check the proportion of people who report zero volunteering:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>HoursCharity</span> <span class='op'>==</span><span class='fl'>0</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.6826594</code></pre>
</div>
<p>We can get a sense of over-dispersion by looking at the ration of the sample variation to the sample mean?</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>HoursCharity</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>HoursCharity</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span>
</code></pre>
</div>
<pre><code>[1] 1.680429</code></pre>
</div>
<p>Thereâs about 1.68 more dispersion that a poisson model would expect</p>
<p>Letâs use the performance package to formally check both zero-inflation and overdispersed</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>z1</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>HoursCharity</span> <span class='op'>~</span> <span class='fl'>1</span>, family <span class='op'>=</span> <span class='st'>"poisson"</span>, data <span class='op'>=</span> <span class='va'>nz</span><span class='op'>)</span>

<span class='fu'>check_zeroinflation</span><span class='op'>(</span><span class='va'>z1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Check for zero-inflation

   Observed zeros: 1992
  Predicted zeros: 536
            Ratio: 0.27</code></pre>
</div>
<p>Next check over-dispersion:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>check_overdispersion</span><span class='op'>(</span><span class='va'>z1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Overdispersion test

       dispersion ratio =    13.196
  Pearson&#39;s Chi-Squared = 37595.179
                p-value =   &lt; 0.001</code></pre>
</div>
<p>And indeed, we find both.</p>
<p>I use the <code>brms</code> package to estimate zero-inflated and/or negative binomial models</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/paul-buerkner/brms'>brms</a></span><span class='op'>)</span>

<span class='co'># Requires integer output </span>
<span class='va'>nz</span><span class='op'>$</span><span class='va'>HoursCharity</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>HoursCharity</span><span class='op'>)</span>

<span class='co'># </span>
<span class='va'>nz</span><span class='op'>[</span><span class='st'>'Household.INC_s'</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>Household.INC</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Scale religion variabile</span>
<span class='va'>nz</span><span class='op'>[</span><span class='st'>'Relid_s'</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>nz</span><span class='op'>$</span><span class='va'>Relid</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>b0</span><span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='va'>HoursCharity</span> <span class='op'>~</span> <span class='va'>Relid_s</span> <span class='op'>+</span> <span class='va'>Household.INC_s</span>, 
                family <span class='op'>=</span> <span class='st'>"zero_inflated_poisson"</span>,
                file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"zeroinflated_poisson_volunteer"</span><span class='op'>)</span>, 
               data <span class='op'>=</span> <span class='va'>nz</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>b0</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Family: zero_inflated_poisson 
  Links: mu = log; zi = identity 
Formula: HoursCharity ~ Relid_s + Household.INC_s 
   Data: nz (Number of observations: 2796) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup samples = 4000

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept           1.70      0.02     1.67     1.73 1.00
Relid_s             0.00      0.01    -0.02     0.03 1.00
Household.INC_s    -0.09      0.02    -0.12    -0.05 1.00
                Bulk_ESS Tail_ESS
Intercept           3785     3068
Relid_s             4501     3362
Household.INC_s     3704     3054

Family Specific Parameters: 
   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
zi     0.70      0.01     0.68     0.72 1.00     3849
   Tail_ESS
zi     2989

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<p>My preferred way of plotting</p>
<p>Predicted effects of religious identification on volunteering:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span>
    <span class='va'>b0</span>,
    spaghetti <span class='op'>=</span> <span class='cn'>TRUE</span>,
    nsamples <span class='op'>=</span> <span class='fl'>100</span>,
    select_points <span class='op'>=</span> <span class='fl'>0.1</span>
  <span class='op'>)</span>,
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ask <span class='op'>=</span> <span class='cn'>FALSE</span>,
  point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
                    width <span class='op'>=</span> <span class='fl'>.02</span><span class='op'>)</span>
<span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='co'>#  note this command controls which facet </span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-62-1.png" width="1152" /><img src="lecture_8_files/figure-html5/unnamed-chunk-62-2.png" width="1152" /><img src="lecture_8_files/figure-html5/unnamed-chunk-62-3.png" width="1152" /></p>
</div>
<p>Predicted effects of income:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span>
    <span class='va'>b0</span>,
    spaghetti <span class='op'>=</span> <span class='cn'>TRUE</span>,
    nsamples <span class='op'>=</span> <span class='fl'>100</span>,
    select_points <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ask <span class='op'>=</span> <span class='cn'>FALSE</span>,
  point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
                    width <span class='op'>=</span> <span class='fl'>.02</span><span class='op'>)</span>
<span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='co'># note this command controls which facet </span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-63-1.png" width="1152" /><img src="lecture_8_files/figure-html5/unnamed-chunk-63-2.png" width="1152" /><img src="lecture_8_files/figure-html5/unnamed-chunk-63-3.png" width="1152" /></p>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>b1</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='va'>HoursCharity</span> <span class='op'>~</span> <span class='va'>Relid_s</span> <span class='op'>+</span> <span class='va'>Household.INC_s</span>, 
                family <span class='op'>=</span> <span class='st'>"zero_inflated_negbinomial"</span>,
                file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"zeroinflated_neg_bin_volunteer"</span><span class='op'>)</span>,
                data <span class='op'>=</span> <span class='va'>nz</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>b1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Family: zero_inflated_negbinomial 
  Links: mu = log; shape = identity; zi = identity 
Formula: HoursCharity ~ Relid_s + Household.INC_s 
   Data: nz (Number of observations: 2796) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup samples = 4000

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept           0.89      0.17     0.52     1.17 1.00
Relid_s             0.21      0.06     0.11     0.33 1.00
Household.INC_s    -0.07      0.05    -0.16     0.03 1.00
                Bulk_ESS Tail_ESS
Intercept            949      885
Relid_s             1456     1698
Household.INC_s     2061     2040

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
shape     0.28      0.07     0.16     0.42 1.00      938
zi        0.35      0.11     0.07     0.50 1.00      939
      Tail_ESS
shape      914
zi         697

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<p>Compare fit. Here, negative numbers are worse.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>b0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/add_criterion.html'>add_criterion</a></span><span class='op'>(</span><span class='va'>b0</span>, <span class='st'>"loo"</span><span class='op'>)</span>
<span class='va'>b1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/add_criterion.html'>add_criterion</a></span><span class='op'>(</span><span class='va'>b1</span>, <span class='st'>"loo"</span><span class='op'>)</span>

<span class='va'>w</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/loo_compare.brmsfit.html'>loo_compare</a></span><span class='op'>(</span><span class='va'>b0</span>, <span class='va'>b1</span>, criterion <span class='op'>=</span> <span class='st'>"loo"</span><span class='op'>)</span>
<span class='va'>w</span>
</code></pre>
</div>
<pre><code>   elpd_diff se_diff
b1     0.0       0.0
b0 -1514.8     207.5</code></pre>
</div>
<p>Recall weâd been using and AIC/BIC convention to estimate improvements in goodness of fit.</p>
<p>We can translate the <code>loo_compare</code> output into a <code>waic</code> convention as:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>waic_diff <span class='op'>=</span> <span class='va'>w</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>*</span> <span class='op'>-</span><span class='fl'>2</span>,
      se        <span class='op'>=</span> <span class='va'>w</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   waic_diff       se
b1     0.000   0.0000
b0  3029.657 414.9648</code></pre>
</div>
<p>And we can see that the negative binomial model fits much better.</p>
<h3 id="predicting-zeros">Predicting zeros</h3>
<p>The estimates in the graphs above are only for the positive (non-zero components of the model). Letâs look at the results again:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>b1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Family: zero_inflated_negbinomial 
  Links: mu = log; shape = identity; zi = identity 
Formula: HoursCharity ~ Relid_s + Household.INC_s 
   Data: nz (Number of observations: 2796) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup samples = 4000

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept           0.89      0.17     0.52     1.17 1.00
Relid_s             0.21      0.06     0.11     0.33 1.00
Household.INC_s    -0.07      0.05    -0.16     0.03 1.00
                Bulk_ESS Tail_ESS
Intercept            949      885
Relid_s             1456     1698
Household.INC_s     2061     2040

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
shape     0.28      0.07     0.16     0.42 1.00      938
zi        0.35      0.11     0.07     0.50 1.00      939
      Tail_ESS
shape      914
zi         697

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<p>The probability of non-volunteering in the preferred model for people who are at the mean Religious Identification and mean Household income in this population is <code>plogis(.35)</code> or 0.5866176. More often than not, we should predict zeros in this population. What predicts the zero component of the model? We can use this syntax:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>b2</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>HoursCharity</span> <span class='op'>~</span> <span class='va'>Relid_s</span> <span class='op'>+</span> <span class='va'>Household.INC_s</span>, <span class='co'># note: use `bf` when you have more than one model, as we do here</span>
     <span class='va'>zi</span> <span class='op'>~</span> <span class='va'>Relid_s</span> <span class='op'>+</span> <span class='va'>Household.INC_s</span><span class='op'>)</span>,
  family <span class='op'>=</span> <span class='st'>"zero_inflated_negbinomial"</span>,
  file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"models"</span>, <span class='st'>"zeroinflated_nb_2_volunteer"</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>nz</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Letâs look at the results:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sjPlot</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/tab_model.html'>tab_model</a></span><span class='op'>(</span><span class='va'>b2</span><span class='op'>)</span>
</code></pre>
</div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
HoursCharity
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Incidence Rate Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI (95%)
</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">
Count Model
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.85Â âÂ 3.95
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Relid_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.94Â âÂ 1.11
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Household.INC_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.93
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.84Â âÂ 1.03
</td>
</tr>
<tr>
<td colspan="3" style="font-weight:bold; text-align:left; padding-top:.8em;">
Zero-Inflated Model
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.72Â âÂ 1.38
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Relid_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.42Â âÂ 0.61
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Household.INC_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.87Â âÂ 1.17
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="2">
2796
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup> Bayes
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">
0.015
</td>
</tr>
</table>
</div>
<p>We can plot the results using ggeffects::</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>ggeffects</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/ggeffects/reference/ggpredict.html'>ggpredict</a></span><span class='op'>(</span><span class='va'>b2</span>, terms <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Relid_s[meansd]"</span>,<span class='st'>"Household.INC_s[meansd]"</span><span class='op'>)</span><span class='op'>)</span>, 
   <span class='co'># add.data = TRUE,  # doesn't work</span>
   <span class='co'># dot.alpha = .2,  </span>
     facet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-71-1.png" width="1152" /></p>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sjPlot</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/tab_model.html'>tab_model</a></span><span class='op'>(</span><span class='va'>b2</span><span class='op'>)</span>
</code></pre>
</div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
HoursCharity
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Incidence Rate Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI (95%)
</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">
Count Model
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.85Â âÂ 3.95
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Relid_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.94Â âÂ 1.11
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Household.INC_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.93
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.84Â âÂ 1.03
</td>
</tr>
<tr>
<td colspan="3" style="font-weight:bold; text-align:left; padding-top:.8em;">
Zero-Inflated Model
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.72Â âÂ 1.38
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Relid_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.42Â âÂ 0.61
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Household.INC_s
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.87Â âÂ 1.17
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="2">
2796
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup> Bayes
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">
0.015
</td>
</tr>
</table>
</div>
<p>Or using my preferred method</p>
<p>Predicted effects of religious identification:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span>
    <span class='va'>b2</span>,
    spaghetti <span class='op'>=</span> <span class='cn'>TRUE</span>,
    nsamples <span class='op'>=</span> <span class='fl'>100</span>,
    select_points <span class='op'>=</span> <span class='fl'>0.1</span>
  <span class='op'>)</span>,
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ask <span class='op'>=</span> <span class='cn'>FALSE</span>,
 point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
                    width <span class='op'>=</span> <span class='fl'>.02</span><span class='op'>)</span>
<span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>  <span class='op'>+</span> <span class='co'># note this command controls which facet </span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>ylim</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-73-1.png" width="1152" /><img src="lecture_8_files/figure-html5/unnamed-chunk-73-2.png" width="1152" /><img src="lecture_8_files/figure-html5/unnamed-chunk-73-3.png" width="1152" /></p>
</div>
<p>Predicted effects of income:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/conditional_effects.brmsfit.html'>conditional_effects</a></span><span class='op'>(</span>
    <span class='va'>b2</span>,
    spaghetti <span class='op'>=</span> <span class='cn'>TRUE</span>,
    nsamples <span class='op'>=</span> <span class='fl'>100</span>,
    select_points <span class='op'>=</span> <span class='fl'>0.1</span> <span class='op'>)</span>,
  points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ask <span class='op'>=</span> <span class='cn'>FALSE</span>,
  point_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
                    width <span class='op'>=</span> <span class='fl'>.02</span><span class='op'>)</span> 
<span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='co'># note this command controls which facet </span>
 <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>ylim</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-74-1.png" width="1152" /><img src="lecture_8_files/figure-html5/unnamed-chunk-74-2.png" width="1152" /><img src="lecture_8_files/figure-html5/unnamed-chunk-74-3.png" width="1152" /></p>
</div>
<p>Note:</p>
<blockquote>
<p>Models of class brmsfit always condition on the zero-inflation component, if the model has such a component. Hence, there is no type = âzero_inflatedâ nor type = âzi_randomâ for brmsfit-models, because predictions are based on draws of the posterior distribution, which already account for the zero-inflation part of the model.</p>
</blockquote>
<p>See <a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">package description</a></p>
<p>Comparing models we find that adding the prdictors improves the model</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>b2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/add_criterion.html'>add_criterion</a></span><span class='op'>(</span><span class='va'>b2</span>, <span class='st'>"loo"</span><span class='op'>)</span>

<span class='va'>w</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/loo_compare.brmsfit.html'>loo_compare</a></span><span class='op'>(</span><span class='va'>b0</span>, <span class='va'>b1</span>, <span class='va'>b2</span>,  criterion <span class='op'>=</span> <span class='st'>"loo"</span><span class='op'>)</span>
<span class='va'>w</span>
</code></pre>
</div>
<pre><code>   elpd_diff se_diff
b2     0.0       0.0
b1   -50.0      10.1
b0 -1564.8     206.1</code></pre>
</div>
<p>Again we can use an -2 * loglik analogue</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">
<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>waic_diff <span class='op'>=</span> <span class='va'>w</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>*</span> <span class='op'>-</span><span class='fl'>2</span>,
      se        <span class='op'>=</span> <span class='va'>w</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   waic_diff        se
b2    0.0000   0.00000
b1  100.0416  20.14189
b0 3129.6983 412.13260</code></pre>
</div>
<p>Another way to see this is to look at the posterior predictive checks on the models</p>
<p>Zero-inflated poisson</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>b0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-77-1.png" width="1152" /></p>
</div>
<p>Zero-inflated negative binomial with no predictors for the zero-inflation part.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>b1</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-78-1.png" width="1152" /></p>
</div>
<p>Zero-inflated negative binomial + predictors for the zero-inflation part</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>b2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="lecture_8_files/figure-html5/unnamed-chunk-79-1.png" width="1152" /></p>
</div>
<h2 id="ordinal-outcomes">Ordinal outcomes</h2>
<h2 id="ordinal-predictors-monotonic-effects">Ordinal predictors (Monotonic effects)</h2>
<p> and Liddell and Kruschke  in advising the use of ordinal models for non-metric data such as the Kessler-6 items. Here we employ a categorical model in which the observed variable y has a probability of being equal to response option + 1 latent thresholds. An ordinal model assumes that an observed ordinal indicator measures a latent continuous variable . The Kessler-6 has five ordinal response options for indicating frequency of feeling distress during the past 30 days: âNone Of The Time,â âA Little Of The Time,â âSome Of The Time,â âMost Of The Time,â âAll Of The Timeâ hence six thresholds. The Kessler-6 distress indicators are: âFeeling Hopelessness;â âFeeling so Depressed Nothing Could Cheer You Up;â âFeeling Nervous or Fidgety;â âFeeling Everything is an Effort;â âFeeling Worthless;â âFeeling Nervous.â We simultaneously modelled each of these six outcomes within a single model. Below, the superscript <span class="math inline">\(k\)</span> is denotes the <span class="math inline">\(k = 1\dots6\)</span> Kessler-6 outcomes. Residuals for cumulative categorical models are not identified, so are fixed to 1. <span class="math inline">\(\alpha_{j0}^k\)</span> denotes the <span class="math inline">\(t = 1\dots 5\)</span> intercepts estimated for the ordinal model, which assumed a cumulative logit distribution for the outcome, and where the lowest response level is modelled as zero, hence four intercepts are estimated for each Kessler- 6 response indicator. <span class="math display">\[\mathbf{\beta}\]</span> denotes the individual-level predictors, in this case âEmploymentâ</p>
<p><span class="math display">\[\begin{align}
y^k \sim \text{Ordered}(\mu_t^k) \\
\text{CumLogit}(\mu_t^k) = \alpha_t^k +\beta^k \\
\alpha_t^k = \alpha_{t0}^k +\alpha^k_c \\
\alpha_{t0}^k \sim \text{StudentT}(3,0,10)\\
\alpha_c^k \sim \text{StudentT}^+(3,0,10)\\
\boldsymbol{\beta^k}\sim \text{Normal}(0,1) 
\end{align}\]</span></p>
<h2 id="bonus-latent-profile-analysis">Bonus: Latent Profile Analysis</h2>
<h2 id="latent-profile-analysis">Latent Profile Analysis</h2>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nzf</span><span class='op'>&lt;-</span><span class='va'>nz</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/lm.ridge.html'>select</a></span><span class='op'>(</span> <span class='va'>FeelHopeless</span>, 
          <span class='va'>FeelDepressed</span>,
          <span class='va'>FeelRestless</span>, 
          <span class='va'>EverythingIsEffort</span>,
          <span class='va'>FeelWorthless</span>, 
          <span class='va'>FeelNervous</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate_if</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>is.factor</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>out</span><span class='op'>&lt;-</span><span class='va'>nzf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span> <span class='va'>FeelHopeless</span>, 
          <span class='va'>FeelDepressed</span>,
          <span class='va'>FeelRestless</span>, 
          <span class='va'>EverythingIsEffort</span>,
          <span class='va'>FeelWorthless</span>, 
          <span class='va'>FeelNervous</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://data-edu.github.io/tidyLPA/reference/single_imputation.html'>single_imputation</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tidyLPA</span><span class='fu'>::</span><span class='fu'><a href='https://data-edu.github.io/tidyLPA/reference/estimate_profiles.html'>estimate_profiles</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>
<span class='va'>out</span><span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://data-edu.github.io/tidyLPA/reference/plot_profiles.html'>plot_profiles</a></span><span class='op'>(</span>add_line <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="acknowledgments-and-references">Acknowledgments and References</h2>
<p><span class="citation" data-cites="gelman2020"><a href="#ref-gelman2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-gelman2020" role="doc-biblioref">2020</a>)</span></p>
<p><span class="citation" data-cites="kurz2020"><a href="#ref-kurz2020" role="doc-biblioref">Kurz</a> (<a href="#ref-kurz2020" role="doc-biblioref">2020</a>)</span></p>
<p><span class="citation" data-cites="bÃ¼rkner2019"><a href="#ref-bÃ¼rkner2019" role="doc-biblioref">BÃ¼rkner and Vuorre</a> (<a href="#ref-bÃ¼rkner2019" role="doc-biblioref">2019</a>)</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-bÃ¼rkner2019" class="csl-entry" role="doc-biblioentry">
BÃ¼rkner, Paul-Christian, and Matti Vuorre. 2019. <span>âOrdinal Regression Models in Psychology: A Tutorial.â</span> <em>Advances in Methods and Practices in Psychological Science</em> 2 (1): 77â101.
</div>
<div id="ref-gelman2020" class="csl-entry" role="doc-biblioentry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
<div id="ref-kurz2020" class="csl-entry" role="doc-biblioentry">
Kurz, A. Solomon. 2020. Zenodo. <a href="https://doi.org/10.5281/zenodo.4080013">https://doi.org/10.5281/zenodo.4080013</a>.
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>This is a paraphrase of J L Austen, I think from <em>Sense and Sensibilia</em>; Iâll needd to look up the reference<a href="#fnref1" class="footnote-back" role="doc-backlink">â©ï¸</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://go-bayes.github.io/psych-447/">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>. Source code is available at <a href="https://go-bayes.github.io/psych-447/">https://go-bayes.github.io/psych-447/</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Bulbulia (2021, April 27). Psych 447: Modelling binary, count data, and ordinal data. Retrieved from https://vuw-psych-447.netlify.app/posts/8_1/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{bulbulia2021modelling,
  author = {Bulbulia, Joseph},
  title = {Psych 447: Modelling binary, count data, and ordinal data},
  url = {https://vuw-psych-447.netlify.app/posts/8_1/},
  year = {2021}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
